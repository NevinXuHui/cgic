FreeRDP 是一个 Remote Desktop Protocol（协议）的一个实现，可以在 Linux 下通过`xfreerdp`命令远程 Windows 电脑。就个人使用体验来说，`freerdp`优于`rdesktop`。

**`freerdp`安装**

```Plain Text
$ sudo apt install freerdp2-x11 

$ xfreerdp -version
This is FreeRDP version 2.0.0-dev (git n/a)


```

**连接 windows**
使用时指定 ip、用户名和密码即可。其中各参数定义如下：

```Plain Text
 /v:<server>[:port]     Server hostname
 /port:<number>         Server port
 /u:[<domain>\]<user> or <user>[@<domain>]  Username
 /p:<password>          Password
 /f                     Fullscreen mode


```

比如全屏显示远程电脑：

```Plain Text
$ xfreerdp /v:192.168.2.31 /u:zhangsan /p:123456 /f


```

比较重要的参数有：

```Plain Text
+fonts (default:off)    Enable smooth fonts (ClearType)
+aero (default:off)     Enable desktop composition
+window-drag (default:off)  Enable full window drag
+menu-anims (default:off)   Enable menu animations
+clipboard (default:off)    Redirect clipboard
/sound:[sys][dev][format][rate][channel][latency][quality]  Audio output (sound)
/audio-mode             Audio output mode
/network:[modem|broadband|broadband-low|broadband-high|wan|lan|auto]  Network connection type


```

例如开启 ClearType、window-drag 和 clipboard：

```Plain Text
$ xfreerdp /v:192.168.2.31 /u:zhangsan /p:123456 /f +fonts +window-drag +clipboard


```

启用音频输出：
audio-mode 的参数为： 0 - redirect；1 - leave on server (or laptop)； 2 - disable audio。当使用`/audio-mode:1`时，表示在远程电脑上输出音频，可以参考 [https://superuser.com/questions/1048829/how-to-keep-sound-on-remote-when-using-xfreerdp-remote-desktop-connection](https://links.jianshu.com/go?to=https%3A%2F%2Fsuperuser.com%2Fquestions%2F1048829%2Fhow-to-keep-sound-on-remote-when-using-xfreerdp-remote-desktop-connection)。

```Plain Text
$ xfreerdp /v:192.168.2.31 /u:zhangsan /p:123456 /f +fonts +window-drag +clipboard /audio-mode:0 /sound


```

实际使用时，由于局域网电脑是动态 ip，可以通过`nmblookup`命令根据主机名称获取远程电脑 ip，例如：

```Plain Text
$ nmblookup -U server -R 'zhangsan'
192.168.2.31 zhangsan<00>


```

完整脚本如下：

```Plain Text
#! /bin/sh

ip=$(nmblookup -U server -R 'zhangsan' | awk -F "[ /]+" '{print $1}')
xfreerdp /v:$ip /u:zhangsan /p:123456 /f +fonts +window-drag +drives +menu-anims +aero /bpp:32 /monitors:1 +glyph-cache +clipboard  /network:auto  /gdi:hw /audio-mode:0 /sound


```

部分参数参考链接：[https://manpages.debian.org/testing/freerdp2-x11/xfreerdp.1.en.html](https://links.jianshu.com/go?to=https%3A%2F%2Fmanpages.debian.org%2Ftesting%2Ffreerdp2-x11%2Fxfreerdp.1.en.html)

更新：
[RDP：解决远程 windows 电脑时调用 OpenGL 失败的问题](https://www.jianshu.com/p/91988133038c)

版权声明：本文为「txfly」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。
原文链接：[https://www.jianshu.com/p/f6fcf5b56fe3](https://www.jianshu.com/p/f6fcf5b56fe3)

