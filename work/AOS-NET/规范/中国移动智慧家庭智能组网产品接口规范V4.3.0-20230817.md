

前 言

本标准对中国移动智能家庭组网终端的管理接口提出要求，是智能家庭组网终端设备和各级管理平台需要遵从的技术文件。本标准供中国移动内部和厂商共同使用，是实施智能家庭组网终端设备管理，开展家庭组网业务的依据之一。

本标准主要包括以下几方面内容：智能家庭组网终端接口流程要求、智能家庭组网终端接口协议要求和智能家庭组网终端接口功能要求。

本标准是有线接入网与家庭网络系列标准之一，该系列标准的结构、名称或预计的名称如下：

  ----------- ----------------- ----------------------------------------------------------
  序号        标准编号          标准名称

  \[1\]       QB-B-024-2014     中国移动家庭网关设备规范

  \[2\]       QB-B-031-2014     中国移动家庭网关远程管理规范

  \[3\]       QB-D-183-2015     中国移动家庭网关设备测试规范

  \[4\]       待发布            中国移动家庭网关设备互通技术规范

  \[5\]       QB-D-193-2016     中国移动数字家庭总体技术要求

  \[6\]       QB-D-195-2016     中国移动智能家庭网关技术规范

  \[7\]       QB-D-196.1-2016   中国移动智能家庭网关接口技术规范-终端管理分册

  \[8\]       QB-D-196.2-2016   中国移动智能家庭网关接口技术规范-插件管理分册

  \[9\]       QB-D-207-2016     中国移动智能家庭网关测试规范

  \[10\]      QB-D-197-2016     中国移动省级数字家庭管理平台规范

  \[11\]      待发布            中国移动省级数字家庭管理平台测试规范

  \[12\]      QB-D-198-2016     中国移动一级家庭开放平台规范

  \[13\]      QB-D-199-2016     中国移动一级家庭开放平台与省级数字家庭管理平台间接口规范

  \[14\]      待发布            中国移动家庭网关技术规范-融合网关分册

  \[15\]      QB-E-062-2017     中国移动智慧家庭智能组网产品入库技术规范

  \[16\]      QB-E-061-2017     中国移动智慧家庭智能组网产品入库接口规范

  \[17\]      待发布            中国移动数字家庭组网终端接口规范-远程管理分册
  ----------- ----------------- ----------------------------------------------------------

本标准的附录B、附录C和附录D为标准性附录。

本标准由中移     号文件印发。

本标准起草单位：中国移动智慧家庭运营中心

本标准主要起草人：
赵航斌、李光华、季超凡、张依东、魏飞、王华景、王晓峰、陈桂辉、金波、范水香、位恒曦、颜慧强、施超、李峰

# 范围 {#范围 .QB标题1}

本标准规定了中国移动智能家庭组网终端（简称家庭组网终端）的管理接口，包括家庭组网终端配网流程、家庭组网终端首次上电和重启、家庭组网终端与家庭网关交互流程、家庭组网终端与省级数字家庭管理平台/一级家开平台/组网云平台互流程等接口流程。

本标准适用于中国移动网络环境下的家庭组网终端设备和各级管理平台。

# 规范性引用文件 {#规范性引用文件 .QB标题1}

下列文件中的条款通过本标准的引用而成为本标准的条款。凡是注日期的引用文件，其随后所有的修改单（不包括勘误的内容）或修订版均不适用于本标准，然而，鼓励根据本标准达成协议的各方研究是否可使用这些文件的最新版本。凡是不注日期的引用文件，其最新版本适用于本标准。

  ------- ---------------- -------------------------------------------------- ------------------------
  序号    标准编号         标准名称                                           发布单位

  \[1\]   待发布           中国移动And•link协议规范（智能硬件本地接入分册）   中国移动通信集团公司

  \[2\]   待发布           中国移动数字家庭组网终端接口规范-远程管理分册      中国移动通信集团公司

  \[3\]   IETF RFC 7252 -  The Constrained Application Protocol (CoAP)        IETF(互联网工程任务组)
          2014                                                                
  ------- ---------------- -------------------------------------------------- ------------------------

# 术语、定义和缩略语 {#术语定义和缩略语 .QB标题1}

下列术语、定义和缩略语适用于本标准：

  -----------------------------------------------------------------------
  词语          全写                              解释
  ------------- --------------------------------- -----------------------
  AES           Advanced Encryption Standard      高级加密标准

  AP            Access Point                      接入点

  API           Application Programming Interface 应用程序编程接口

  CoAP          Constrained Application Protocol  受约束的应用协议

  ID            Identity                          身份认证

  IP            Internet Protocol                 互联网协议

  JSON          JavaScript Object Notation        JavaScript对象标记

  JVM           Java Virtual Machine              Java虚拟机

  MAC           Medium Access Control             媒质访问控制

  OSGi          Open Service Gateway Initiative   开放服务网关项目

  RSSI          Received Signal Strength          接收信号强度指示
                Indication                        

  SSID          Service Set Identifier            服务集标识符

  STA           Station                           无线客户端

  TCP           Transmission Control Protocol     传输控制协议

  UDP           User Datagram Protocol            用户数据报协议

  URL           Uniform Resource Locator          统一资源定位符

  UTC           Universal Time Coordinated        世界标准时间

  WiFi          Wireless-Fidelity                 无线保真

  WLAN          Wireless Local Area Networks      无线局域网

  WPS           WiFi Protected Setup              WiFi保护设置
  -----------------------------------------------------------------------

# 接口概述 {#接口概述 .QB标题1}

![](media/image3.emf)

图4-1 接口概述

家庭组网终端管理通过一级家庭开放平台/省级数字家庭管理平台/组网云平台进行管理。省级数字家庭管理平台、一级家庭开发平台和组网云平台要求同时支持IPv4和IPv6的地址管理能力。

IF1:
手机客户端（和家亲APP）与一级家庭开放平台间接口，负责家庭组网终端的网络状态参数同步、用户操作信息传递。

IF3：与家庭组网终端与家庭网关的And-link(组网)插件之间的接口，用于家庭组网终端与家庭网关之间建立管理消息通路、同步WiFi参数配置信息等功能。

IF5：家庭组网终端与一级家庭开放平台之间的接口，家庭组网终端使用此接口接入到一级家庭开放平台。

IF6：家庭组网终端与省级数字家庭管理平台之间的接口，家庭组网终端使用此接口接入到省级数字家庭管理平台。

IF7：一级家庭开放平台与省级数字家庭管理平台之间的接口，用于完成智能组网订购业务的信息同步，用于用户侧业务预定及信息展现、业务进度跟踪。

IF8：组网终端与组网云平台之间的接口，组网终端使用此接口上报业务及网络质量数据，具体接口参阅《中国移动智能组网终端质量管理接口规范》

# 接口流程 {#接口流程 .QB标题1}

## 家庭组网终端首次上电和重启流程 {#家庭组网终端首次上电和重启流程 .QB标题2}

组网终端默认工作在桥接模式；

设备首次上电时，当AP无法获取上行网元分配的IP时，AP需支持开启DHCP
Server功能，具备为下挂STA分配IP地址的能力；

当AP获取到上联网元分配的IP地址后，应自动关闭DHCP
Server功能，下挂设备由上联网元分配IP地址；

设备首次上电，若尚未连接外网时，即发生断电，则下次上电后仍需执行首次上电流程；

## 家庭组网终端与家庭网关交互流程（IF3） {#家庭组网终端与家庭网关交互流程if3 .QB标题2}

组网终端在一级家庭开放平台/省级数字家庭管理平台/组网云平台注册或上线之前，需发送寻找上联网关的广播接口，获取到上联网关信息，并通过注册、上线接口上报给相应平台。

![](media/image4.emf)

图5-2 组网终端与网关接口流程

组网终端在进行Wi-Fi信息同步时，需先寻找上联网关的广播接口，再发送设备入网请求，最后接收网关Wi-Fi信息。

![](media/image5.emf)

图5-3 组网终端与家庭网关交互接口流程

## 家庭组网终端与省级数字家庭管理平台交互流程（IF6） {#家庭组网终端与省级数字家庭管理平台交互流程if6 .QB标题2}

## 上线认证流程 {#上线认证流程 .QB标题3}

![](media/image6.emf){width="3.847981189851269in"
height="2.4852930883639544in"}

图5-4 家庭组网终端上线认证流程

1)  组网终端启动或WAN IP变更后，调用UDP
    Boot方法（7.2.2.1.1设备上线请求），上报终端信息及参数，向省级数字家庭管理平台发起上线；

2)  省级数字家庭管理平台对终端MAC进行合法性认证，返回Boot
    Response（7.2.2.1.2设备上线响应），响应信息中包含ChallengeCode，用于下一步验证终端；

3)  组网终端收到平台的响应后，得到ChallengeCode，将它与组网终端SN拼接后，计算MD5值为CheckSN后，调用Register方法（7.2.2.2.1节设备认证请求），向平台发起认证；

4)  省级管理平台通过上一步中的MAC地址在数据库中找到该终端的SN，用相同的方法计算MD5值后进行比对，如果相同，则认证成功，返回Register
    Response（7.2.2.2.2设备认证响应）。

## 心跳保活流程 {#心跳保活流程 .QB标题3}

![](media/image7.emf)

图5-5 家庭组网终端心跳保活流程

1)  对于UDP连接，终端每隔一段时间（默认60s，由平台在Register方法返回的heartBeatTime决定）发送heartbeat消息（7.2.2.3.1心跳保活请求），对于TCP连接，不周期性发起心跳，当发现服务器空闲100秒无操作时，主动发送heartbeat消息（7.2.2.3.1心跳保活请求）；

2)  管理平台返回heartbeat Response（7.2.2.3.2心跳保活响应）。

## 组网终端向省级管理平台发起请求流程 {#组网终端向省级管理平台发起请求流程 .QB标题3}

![](media/image8.emf){width="3.6944444444444446in" height="2.9375in"}

图5-6 组网终端主动向管理平台发起请求流程

组网终端需要上报事件（7.2.2.6节事件上报接口）到管理平台时，可以主动建立连接。

1)  组网终端建立TCP连接会话；

2)  组网终端调用Boot方法(7.2.2.1节设备上线请求)，上报终端信息及参数；

3)  管理平台对终端MAC进行合法性认证，返回Boot
    Response(7.2.2.1.2节设备上线响应)，响应信息中包含ChallengeCode，用于下一步验证终端；

4)  组网终端收到平台的成功响应后，得到ChallengeCode，将它与设备SN拼接后，计算MD5值为CheckSN后，调用Register方法(7.2.2.2.1节设备认证请求)，向平台发起认证；

5)  管理平台通过上一步中的MAC地址在数据库中找到该设备的SN，用相同的方法计算MD5值后进行比对，如果相同，则认证成功，返回Register
    Response(7.2.2.2.2节设备认证响应)。组网终端和管理平台完成通讯连接建立；

6)  组网终端和管理平台建立通讯连接后，主动上报需要上报的消息，上报确认完成后应断开此次TCP连接。

## 管理平台主动向组网终端发起请求流程 {#管理平台主动向组网终端发起请求流程 .QB标题3}

![](media/image9.emf){width="4.3125in" height="4.180555555555555in"}

图5-7 管理平台主动向组网终端发起请求流程

组网终端和管理平台通过UDP的心跳保活流程维持UDP连接，管理平台需要记录终端的UDP报文的源IP和源端口。当管理平台需要向终端下发查询、控制或升级等任务时，可以先向终端发送UDP反向连接请求报文，主动发起建立连接。

1）管理平台根据终端和平台通过心跳维持的UDP会话，主动发送反向连接请求(7.2.2.4.1节反向触发请求)给终端；

2）组网终端对平台进行合法性认证，返回响应(7.2.2.4.2节反向触发响应)，响应中包含下一次反向连接的随机码；

3.  管理平台返回消息确认已经收到响应(7.2.2.4.3节反向触发平台回应)；

4.  组网终端建立TCP连接会话；

5.  组网终端调用Boot方法(7.2.2.1.1节设备上线请求)，上报终端信息及参数；

6）管理平台对终端MAC进行合法性认证，返回Boot
Response(7.2.2.1.2节设备上线响应)，响应信息中包含ChallengeCode，用于下一步验证终端；

7）组网终端收到平台的成功响应后，得到ChallengeCode，将它与设备SN拼接后，计算MD5值为CheckSN后，调用Register方法(7.2.2.2.1节设备认证请求)，向平台发起认证；

8）管理平台通过上一步中的MAC地址在数据库中找到该设备的SN，用相同的方法计算MD5值后进行比对，如果相同，则认证成功，返回Register
Response(7.2.2.2.2节设备认证响应)；

9）组网终端和管理平台建立通讯连接后，管理平台对组网终端进行配置或查询，操作完成后管理平台通知组网终端断开TCP连接（7.2.2.5节服务器断开连接接口）。

说明：当设备发现服务器空闲100秒无操作时，主动向服务器报告（7.2.2.3.1节心跳保活接口）一次，若返回（7.2.2.3.2节心跳保活响应）-1，或超时，设备断开连接，等待下一次反向触发（7.2.2.4.1节反向触发请求）。

## 事件上报流程 {#事件上报流程 .QB标题3}

![](media/image10.emf)

图5-8 组网终端事件上报流程

## 周期/上电上报流程 {#周期上电上报流程 .QB标题3}

![](media/image11.emf)

> 图5-9 组网终端周期/上电上报流
>
> 注：组网终端首次上电或断电重启后，组网通过IF6接口完成上线认证后，组网终端应间隔interval，再发起首次周期上报，interval=rand\[0,
> 600\]，单位秒。

## 功能控制流程 {#功能控制流程 .QB标题3}

![](media/image12.emf)

图5-10 组网终端功能控制流程

## 信息查询流程 {#信息查询流程 .QB标题3}

![](media/image13.emf)

图5-11 组网终端信息查询流程

## 设备升级流程 {#设备升级流程 .QB标题3}

> ![](media/image14.emf)
>
> 图5-12 组网终端设备升级流程

## 云AC漫游流程 {#云ac漫游流程 .QB标题3}

![](media/image15.emf)

图5-13 云AC漫游流程

## 组网终端与一级家庭开放平台交互接口流程（IF5） {#组网终端与一级家庭开放平台交互接口流程if5 .QB标题2}

## 注册上线流程 {#注册上线流程 .QB标题3}

![](media/image16.emf)

图5-14注册/上线流程

## 事件上报流程 {#事件上报流程-1 .QB标题3}

![](media/image17.emf)

图5-15 事件上报流程

## 组网终端功能控制流程 {#组网终端功能控制流程 .QB标题3}

![](media/image18.emf)

图5-16 功能控制流程

## 信息查询流程 {#信息查询流程-1 .QB标题3}

![](media/image19.emf)

图5-17 信息查询流程

## 设备解绑流程 {#设备解绑流程 .QB标题3}

![](media/image20.emf)

图5-18 APP解绑流程

## 设备升级流程 {#设备升级流程-1 .QB标题3}

![](media/image21.emf)

图5-19 组网终端升级流程

## 连接与重连机制 {#连接与重连机制 .QB标题3}

## 获取一级平台地址重试 {#获取一级平台地址重试 .QB标题4}

组网终端调用获取一级平台接口后收不到响应，则进行重试，重试频率为5s一次，重试3次。如果3次未能获取，则不再获取，使用设备预置地址同平台进行交互，待下次上电后，重新执行该流程。

## 注册上线重试机制 {#注册上线重试机制 .QB标题4}

组网终端到一级家开平台连接重试机制包括：注册/上线重试机制流程如图5-22所示。

设备尝试注册/上线，起始n =
0，当操作失败时，n++进入重试，若重试次数超过5次，则取n=5，重试间隔时间interval
= 30\*2\^(n-1)+rand\[0-50\]。

![](media/image22.emf)

图5-20 注册上线重试机制

## MQTT连接重试机制 {#mqtt连接重试机制 .QB标题4}

设备上线成功后获取MqttRetry数据值，MQTT建立连接失败和MQTT建立连接成功后连接异常断开，MQTT连接重试机制由上线请求响应的MqttRetry值决定，例如：上线响应MqttRetry为\[0,60,120,240\]，重试间隔依次为MR\[i\]秒至MR\[i+1\]秒(i从0开始)内随机值直到该数组元素的最大次数，当重试到该数组元素最大次数后，设备重新发起上线（boot）消息。

![](media/image23.emf){width="3.75in" height="5.423611111111111in"}

图5-21 MQTT连接重试机制

## 和家亲APP与组网终端绑定流程 {#和家亲app与组网终端绑定流程 .QB标题3}

![](media/image24.emf)

图5-22 APP与设备绑定流程1

![](media/image25.emf)

图5-23 APP与设备绑定流程2

## 智能设备无感配网流程 {#智能设备无感配网流程 .QB标题3}

> ![](media/image26.emf)
>
> 图5-24 智能设备快连接入流程

![](media/image27.emf)

图5-25 智能设备引导热点接入流程

## 省份编码配置接口流程 {#省份编码配置接口流程 .QB标题3}

![](media/image28.emf)

图 5-26 省码预配置接口流程

## 持续测速接口流程 {#持续测速接口流程 .QB标题3}

![](media/image29.emf)

图 5-28 持续测速接口流程

## 组网终端与家宽优选业务平台交互接口流程 {#组网终端与家宽优选业务平台交互接口流程 .QB标题2}

## 家宽优选业务服务流程 {#家宽优选业务服务流程 .QB标题3}

![](media/image30.emf)

图 5-27 管理插件服务流程

![](media/image31.emf)

图5-28 通信插件服务流程

![](media/image32.emf)

图 5-29 绿色上网插件服务流程

![](media/image33.emf)

图5-30 教育加速插件服务流程

![](media/image34.emf)

图5-31 电竞加速插件服务流程

# 接口协议 {#接口协议 .QB标题1}

## 家庭组网终端与家庭网关交互接口协议（IF3） {#家庭组网终端与家庭网关交互接口协议if3 .QB标题2}

## 协议模型 {#协议模型 .QB标题3}

![](media/image35.emf)

图6-1 IF3接口协议模型

家庭网关和家庭组网终端之间的管理接口协议模型如图6-1所示。

UDP协议层应使用标准的UDP协议。

CoAP协议层基于UDP协议层，应遵循RFC7252《The Constrained Application
Protocol (CoAP)》中的相关要求，应支持可靠消息传递机制，支持分包机制。

JSON协议层定义了家庭网关和家庭组网终端之间管理接口应支持的请求和响应参数，用于传递和承载完成家庭组网终端管理所需的注册上线、心跳保活、功能控制和信息查询等信息。应支持对全部JSON数据加密。具体要求见6.3节。

## CoAP协议层 {#coap协议层 .QB标题3}

应遵循《中国移动And·link协议规范（智能硬件本地接入分册）》中的CoAP协议层要求。

## JSON协议层 {#json协议层 .QB标题2}

## 上行方向 {#上行方向 .QB标题3}

由家庭组网终端设备向网关/省级数字家庭管理平台发起请求，包括设备注册、上线、认证、事件上报和心跳保活等功能。

注册、上线和心跳消息采用明文发送，用于指定设备ID和加密密钥及加密开关。

认证、事件上报消息需要加密，加密算法参见6.3.3说明。

## 家庭组网终端与省级数字家庭管理平台交互接口协议（IF6） {#家庭组网终端与省级数字家庭管理平台交互接口协议if6 .QB标题2}

## 协议模型 {#协议模型-1 .QB标题3}

家庭组网终端通过JSON over TCP 或JSON over
UDP的方式实现家庭组网终端与管理平台之间的远程访问。

JSON over TCP、JSON over
UDP两种方式应遵循以下原则：1）家庭组网终端通过JSON over
UDP方式向管理平台发起上线认证，并维持心跳连接。2）管理平台通过该UDP连接反向触发家庭组网终端通过TCP方式连接到管理平台，管理平台通过该TCP连接对家庭组网终端进行远程管理维护。完成远程管理维护后应拆除TCP连接。3）家庭组网终端需要上报事件时，主动发起TCP连接，完成事件上报后应拆除TCP连接。4）应支持对全部JSON数据加密。JSON具体要求见6.3节。

协议分层参考下图：

![](media/image36.emf)

图6-2 IF6协议模型

## UDP协议 {#udp协议 .QB标题3}

> 协议包格式定义：
>
> ![](media/image37.emf)
>
> 图6-3 JSON over UDP协议包格式
>
> 上行和下行接口要求如下：

表6-1 JSON over UDP上行接口

  ------------------ ----------------------------------------------------
  上行接口描述       实现家庭组网终端注册、认证、心跳维持功能

  目的IP地址         管理平台的地址

  UDP端口            9007

  请求方法           UDP

  请求类型           JSON

  响应类型           JSON

  请求方向           家庭组网终端→管理平台；

  适用接口           UDP上线、UDP认证、UDP心跳保活
  ------------------ ----------------------------------------------------

表6-2 JSON over UDP下行接口

  ------------------- ---------------------------------------------------
  下行接口描述        实现管理平台反向触发连接功能

  目的IP地址          管理平台记录的组网终端UDP连接会话的源IP

  UDP端口             管理平台记录的组网终端UDP连接会话的源端口

  请求方法            UDP

  请求类型            JSON

  响应类型            JSON

  请求方向            反向触发连接：管理平台→组网终端
  ------------------- ---------------------------------------------------

## TCP协议 {#tcp协议 .QB标题3}

> 协议包格式定义如下。其中，数据长度域的格式为十六进制，4个字节，Big-Endian方式。
>
> ![](media/image38.emf)
>
> 图6-4 JSON over UDP协议包格式
>
> 上行和下行接口要求如下：
>
> 表6-3 JSON over TCP上行接口

  ----------------- -----------------------------------------------------------
  上行接口描述      组网终端向管理平台发起上线、认证及心跳功能，建立TCP连接。

  目的IP地址        管理平台的地址

  设备TCP端口       9005

  请求方法          TCP

  请求类型          JSON

  响应类型          JSON

  请求方向          组网终端→管理平台

  适用接口          TCP上线、TCP认证、TCP心跳保活TCP事件上报
  ----------------- -----------------------------------------------------------

> 表6-4 JSON over TCP下行接口

  ----------------- --------------------------------------------------------------------------
  下行接口描述      管理平台向组网终端下发管理控制命令，向组网终端执行查询和配置等操作。

  目的IP地址        管理平台记录的组网终端TCP连接会话的源IP

  组网终端TCP端口   管理平台记录的组网终端TCP连接会话的源端口

  请求方法          TCP

  请求类型          JSON

  响应类型          JSON

  请求方向          管理平台→组网终端

  适用接口          组网终端功能控制接口，组网终端信息查询接口、断开连接、设备解绑、设备升级
  ----------------- --------------------------------------------------------------------------

## 下行方向 {#下行方向 .QB标题3}

由省级数字家庭管理平台向组网终端下发请求，包括设备功能控制、信息查询、解绑和升级功能。

反向触发、服务器断开连接、设备功能控制、信息查询、解绑和升级功能消息需要加密，加密算法参见6.3.5说明。组网终端设备不应响应和处理未加密的下行方向报文。

## 加密方式 {#加密方式 .QB标题3}

加密算法采用AES-128，对全部JSON数据加密，详细方式约定：

加密模式：CBC

填充方式：PKCS5Padding

加密密钥：由组网终端发起的上行请求和响应消息的加密密钥为MD5(SN)为128比特，SN格式要求见《中国移动家庭组网终端技术规范》；由平台发起的下行请求和响应消息加密密钥为MD5(SN)为128比特。

偏移量："0000000000000000"(16个0)

输出格式：base64

字符集：utf-8

AES为对称加密算法，以上约定的方法也适用于解密算法。

IF6加密密钥举例如下：

SN=11002180634034F

MD5(SN)=ab73d42c83bc56fabfc5be06f850d63d（32个字符小写）

截取前16个字符作为128比特加密密钥：ab73d42c83bc56fa

## 组网终端与一级家庭开放平台接口协议模型（IF5） {#组网终端与一级家庭开放平台接口协议模型if5 .QB标题2}

## 协议模型 {#协议模型-2 .QB标题3}

![](media/image39.png){width="2.2518569553805774in"
height="1.164753937007874in"}

图6-5 接口协议模型

家开平台和智能设备之间的管理接口协议模型如图6-5所示。

TCP协议层应使用标准的TCP协议。

HTTPS、MQTT协议层基于TCP协议层，它们均支持TLS/SSL方式对消息进行加密，保障数据在网络上传输的安全性。

JSON协议层定义了智能设备管理应支持的请求和响应参数。

## MQTT协议层 {#mqtt协议层 .QB标题3}

## MQTT 数据包结构 {#mqtt-数据包结构 .QB标题4}

固定头（Fixed
header），存在于所有MQTT数据包中，表示数据包类型及数据包的分组类标识；

可变头（Variable
header），存在于部分MQTT数据包中，数据包类型决定了可变头是否存在及其具体内容；

消息体（Payload），存在于部分MQTT数据包中，表示客户端收到的具体内容；

## MQTT固定头 {#mqtt固定头 .QB标题4}

固定头存在于所有MQTT数据包中，其结构如下：

  ------------- ---------------- ------- ------- -------- ---------------------- ------- ------- -------
  Bit           7                6       5       4        3                      2       1       0

  Byte1         MQTT数据包类型                            MQTT数据包的具体标识                   

  Byte2...      剩余长度                                                                         
  ------------- ---------------- ------- ------- -------- ---------------------- ------- ------- -------

## MQTT数据包类型 {#mqtt数据包类型 .QB标题4}

位置：byte 1, bits 7-4。

相于一个4位的无符号值，类型如下：

  ---------------- -------- ----------------- -----------------------------
  名称             值       流方向            描述

  Reserved         0        不可用            保留位

  CONNECT          1        客户端到服务器    客户端请求连接到服务器

  CONNACK          2        服务器到客户端    连接确认

  PUBLISH          3        双向              发布消息

  PUBACK           4        双向              发布确认

  PUBREC           5        双向              发布收到（保证第1部分到达）

  PUBREL           6        双向              发布释放（保证第2部分到达）

  PUBCOMP          7        双向              发布完成（保证第3部分到达）

  SUBSCRIBE        8        客户端到服务器    客户端请求订阅

  SUBACK           9        服务器到客户端    订阅确认

  UNSUBSCRIBE      10       客户端到服务器    请求取消订阅

  UNSUBACK         11       服务器到客户端    取消订阅确认

  PINGREQ          12       客户端到服务器    PING请求

  PINGRESP         13       服务器到客户端    PING应答

  DISCONNECT       14       客户端到服务器    中断连接

  Reserved         15       不可用            保留位
  ---------------- -------- ----------------- -----------------------------

标识位位置：byte 1, bits
3-0。在不使用标识位的消息类型中，标识位被做为保留位。如果收到无效的标志时，接收端必须关闭网络连接：

  ---------------- ----------------- -------- -------- -------- ---------
  数据包           标识位            Bit 3    Bit 2    Bit 1    Bit 0

  CONNECT          保留位            0        0        0        0

  CONNACK          保留位            0        0        0        0

  PUBLISH          MQTT 3.1.1使用    DUP1     QoS2     QoS2     RETAIN3

  PUBACK           保留位            0        0        0        0

  PUBREC           保留位            0        0        0        0

  PUBREL           保留位            0        0        0        0

  PUBCOMP          保留位            0        0        0        0

  SUBSCRIBE        保留位            0        0        0        0

  SUBACK           保留位            0        0        0        0

  UNSUBSCRIBE      保留位            0        0        0        0

  UNSUBACK         保留位            0        0        0        0

  PINGREQ          保留位            0        0        0        0

  PINGRESP         保留位            0        0        0        0

  DISCONNECT       保留位            0        0        0        0
  ---------------- ----------------- -------- -------- -------- ---------

DUP：发布消息的副本。用来在保证消息的可靠传输；若设置为
1，则在下面的变长中增加MessageId，并且需要回复确认，以保证消息传输完成，但不能用于检测消息重复发送。

QoS：发布消息的服务质量，即：保证消息传递的次数

> 00：最多一次，即：\<=1
>
> 01：至少一次，即：\>=1
>
> 10：一次，即：=1
>
> 11：预留

RETAIN：
发布保留标识，表示服务器要保留这次推送的信息，如果有新的订阅者出现，就把这消息推送给它，如果设有那么推送至当前订阅者后释放。

剩余长度（Remaining Length）

位置：byte 1。

固定头的第二字节用来保存变长头部和消息体的总大小的，但不是直接保存的。这一字节是可以扩展，其保存机制，前7位用于保存长度，后一部用做标识。当最后一位为
1时，表示长度不足，需要使用二个字节继续保存。 例如：计算出后面的大小为0

## MQTT可变头 {#mqtt可变头 .QB标题4}

MQTT数据包中包含一个可变头，它驻位于固定的头和负载之间。可变头的内容因数据包类型而不同，较常的应用是作为包的标识：

  ------------- ----------------- ------- ------- -------- ------- ------- ------- -------
  Bit           7                 6       5       4        3       2       1       0

  Byte1         包标签符（MSB）                                                    

  Byte2...      包标签符（LSB）                                                    
  ------------- ----------------- ------- ------- -------- ------- ------- ------- -------

很多类型数据包中都包括一个2字节的数据包标识字段，这些类型的包有：PUBLISH
(QoS \>
0)、PUBACK、PUBREC、PUBREL、PUBCOMP、SUBSCRIBE、SUBACK、UNSUBSCRIBE、UNSUBACK

## Payload消息体 {#payload消息体 .QB标题4}

Payload消息体位MQTT数据包的第三部分，CONNECT、SUBSCRIBE、SUBACK、UNSUBSCRIBE四种类型的消息
有消息体：

CONNECT，消息体内容主要是：客户端的ClientID、订阅的Topic、Message以及用户名和密码。

SUBSCRIBE，消息体内容是一系列的要订阅的主题以及QoS。

SUBACK，消息体内容是服务器对于SUBSCRIBE所申请的主题及QoS进行确认和回复。

UNSUBSCRIBE，消息体内容是要订阅的主题。

## JSON协议层 {#json协议层-1 .QB标题3}

## 消息内容 {#消息内容 .QB标题4}

包括智能硬件的所有上行和下行消息，上行消息指由智能硬件向家开平台发起请求，包括注册、上线、数据上报以及设备控制命令异步响应等。

下行消息指由家开平台向智能硬件下发的所有请求控制消息，包括设备管控、数据查询、文件操作命令下发等。

## 数据安全性 {#数据安全性 .QB标题4}

## ·主要参数 {#主要参数 .QB标题4}

+-------------+--------------------------------------------------------+
| 参数名      | 含义                                                   |
+-------------+--------------------------------------------------------+
| gwId        | 一级家开平台唯一标识                                   |
+-------------+--------------------------------------------------------+
| gwToken     | 一级家开平台token                                      |
+-------------+--------------------------------------------------------+
| deviceId    | 设备唯                                                 |
|             | 一标识，设备注册(首次上线)时通过平台分配给设备的唯一标 |
|             | 识，设备需要保存在flash中作为后续与平台交互的身份识别  |
+-------------+--------------------------------------------------------+
| deviceToken | 设备token，设备注册时经过                              |
|             | 用户确认后生成的鉴权标识，设备更换用户需要重新生成该值 |
+-------------+--------------------------------------------------------+
| deviceType  | 设备                                                   |
|             | 类型，设备在开发者门户创建时为该类型分配的唯一产品编码 |
+-------------+--------------------------------------------------------+
| p           | 产品token，设备在开发者门户注册时生成的该设备类型的    |
| roductToken | 鉴权码，设备在首次上线向平台注册时平台侧解密和鉴权使用 |
+-------------+--------------------------------------------------------+
| a           | 平台token，设备在开发者门户                            |
| ndlinkToken | 注册时生成的该设备类型的鉴权码，设备在首次上线向平台注 |
|             | 册时设备侧解密和鉴权使用,也用于设备相关服务的访问鉴权  |
+-------------+--------------------------------------------------------+
| ch          | 子设备唯一标识                                         |
| ildDeviceId |                                                        |
+-------------+--------------------------------------------------------+
| deviceMac   | 设备物理地址                                           |
+-------------+--------------------------------------------------------+
| data        | 设备协议交互的差异化数据区，不同命令对应不同的内容     |
+-------------+--------------------------------------------------------+
| timestamp   | 消息时间戳，由消息发起方生成                           |
+-------------+--------------------------------------------------------+
| eventType   | 上报事件类型                                           |
+-------------+--------------------------------------------------------+
| Response    | 执行结果响应信息                                       |
|             |                                                        |
|             | {\"respCode\":\*\*\*\*, //响应码                       |
|             |                                                        |
|             | \"respCont\":\"\*\*\*\*\"//异常描述                    |
|             |                                                        |
|             | }                                                      |
+-------------+--------------------------------------------------------+

## HTTPS接口鉴权 {#https接口鉴权 .QB标题3}

通过IF5接口同一级组网平台交互的数据包，其HTTPS包头应符合以下标准：

Accept:application/json;

Content-Type:application/json;charset=utf-8; Content-Length:256;

表6-6 HTTPS标准包头字段

  -------------- ---------- ------------------------------------------ ----------
  参数名         类型       描述                                       是否必须

  Sig            String     包头必须带有此参数                         Y

  Accept         String     客户端响应接收数据格式：application/json   Y

  Content-Type   String     类型：application/json;charset=utf-8       Y

  AuthorToken    String     验证信息                                   Y
  -------------- ---------- ------------------------------------------ ----------

说明：

1）HTTP头Sig字段，作为合法性校验信息，Sig=MD5（authDevKey+secretKey+时间戳）

2）时间戳采用系统时间（24小时制），格式"yyyyMMddHHmmss"。

3）AuthorToken字段，为包头验证信息，AuthorToken=Base64（authDevKey+冒号+时间戳），采用英文冒号，时间戳同Sig中时间戳保持一致。

4）
authDevKey由IF5平台与端侧设备约定，用于鉴权设备请求合法性。authDevKey和secretKey的具体参数值通过AOS-NET进行搭载。

# 接口功能要求 {#接口功能要求 .QB标题1}

## 组网终端与智能网关交互接口定义（IF3） {#组网终端与智能网关交互接口定义if3 .QB标题2}

## 上联网关信息查询接口 {#上联网关信息查询接口 .QB标题3}

> 接口说明：该接口用于组网终端查询上联网关基本信息；每次重启或IP地址变更时进行该请求；

请求coap://broadcastIp:5683/qlink/queryGwExt

请求类型：组网终端 -\> 网关

## 请求 {#请求 .QB标题4}

{\"searchKey\":\"ANDLINK-DEVICE\"}

## 响应 {#响应 .QB标题4}

> {\"searchAck\":\"ANDLINK-GW\",\"andlinkVersion\":\"V2.3\",\"gatewayPPPOEuser\":\"\*\*\*\*\*\*\",\"UplinkMac\":\"\*\*\*\*\*\*\"}

注：

1）请求发送后收不到响应，应重试3次，重试间隔为2s；

2）组网终端通过响应消息获取网关信息；

## 组网设备入网接口 {#组网设备入网接口 .QB标题3}

接口说明：组网终端请求网关Wi-Fi配置参数，设备每次重启或IP地址变更都要进行该请求，家庭网关会根据策略将实际的Wi-Fi参数通过异步下发给组网终端。

请求url：coap://gwIp:5683/device/inform/requestSync

请求类型：POST-CON

请求方向：组网终端-\>网关

## 请求 {#请求-1 .QB标题4}

表7.1-1 设备请求Wi-Fi参数

+-------------+--------+-------------------------------------+--------+
| 参数名      | 类型   | 描述                                | 是     |
|             |        |                                     | 否必须 |
+=============+========+=====================================+========+
| deviceMac   | String | 组网终端铭牌MAC地址，推荐使         | Y      |
|             |        | 用WAN口MAC，格式为不带冒号并且大写  |        |
+-------------+--------+-------------------------------------+--------+
| deviceType  | String | 组网终端产品类型码                  | Y      |
+-------------+--------+-------------------------------------+--------+
| timestamp   | Number | 时间戳，单位：毫秒；                | Y      |
+-------------+--------+-------------------------------------+--------+
| SyncCode    | String | 配置同步码。反映针对当前            | Y      |
|             |        | 组网终端参数配置的计数值，初始为0。 |        |
+-------------+--------+-------------------------------------+--------+
| radio5      | Number | 终端支持频段信息：                  | Y      |
|             |        |                                     |        |
|             |        | 0：单频组网终端                     |        |
|             |        |                                     |        |
|             |        | 1：双频组网终端                     |        |
|             |        |                                     |        |
|             |        | 2：三频组网终端                     |        |
+-------------+--------+-------------------------------------+--------+

示例：{\"deviceMac\":\"AABBCCDDEEFF\",\"deviceType\":\"30103\",\"timestamp\":1628562566021,\"SyncCode\":\"0\",\"radio5\":1}

## 响应 {#响应-1 .QB标题4}

  ------------- ------------- ---------------------------------- ----------
  参数名        类型          描述                               是否必须

  respCode      Number        响应码，成功响应为1：              Y

  restCont      String        响应的返回值；                     N
  ------------- ------------- ---------------------------------- ----------

示例：{\"respCode\":1,\"restCont\":\"XXXXXX\"}

## Wi-Fi参数同步接口 {#wi-fi参数同步接口 .QB标题3}

接口说明：通过该消息将Wi-Fi参数配置下发给组网终端。

请求url：coap://APIP:5683/apdevice/control/WiFiParameterSync

请求类型：POST-CON

请求方向：网关-\>家庭组网终端

说明：当syncEnable值为0时，组网终端将不执行该同步接口；

## 请求 {#请求-2 .QB标题4}

表7.1-2 Wi-Fi参数同步请求

+----------------+-----+--------------------------------------+-------+
| 参数名         | 类  | 描述                                 | 是否  |
|                | 型  |                                      | 必须  |
+================+=====+======================================+=======+
| deviceId       | Str | 组网终端ID                           | N     |
|                | ing |                                      |       |
+----------------+-----+--------------------------------------+-------+
| data           | Obj | 终端要解析的数据包                   | Y     |
|                | ect |                                      |       |
+----------------+-----+--------------------------------------+-------+
| SyncCode       | Str | 配置同步码。反映针对当前             | N     |
|                | ing | 组网终端参数配置的计数值。初始为0。  |       |
|                |     |                                      |       |
|                |     | 家庭                                 |       |
|                |     | 网关Wi-Fi配置发生修改后将其加1，下发 |       |
|                |     | 配置到组网终端时将新SyncCode也配置下 |       |
|                |     | 去，组网终端需在本地保存新SyncCode。 |       |
|                |     |                                      |       |
|                |     | 组网终端上线时上报当前SyncCode，     |       |
|                |     | 家庭网关比对其SyncCode是否与家庭网关 |       |
|                |     | 上保存的一致，若一致则表明该家庭组网 |       |
|                |     | 终端的Wi-Fi配置已经同步，否则家庭网  |       |
|                |     | 关立即同步Wi-Fi配置到家庭组网终端。  |       |
+----------------+-----+--------------------------------------+-------+
| Configurations | Ar  | Wi-Fi配置的数组                      | Y     |
|                | ray |                                      |       |
+----------------+-----+--------------------------------------+-------+
| Radio          | Str | 待设置的频段，枚举取值：             | Y     |
|                | ing | 2.4G、5G或5G-2                       |       |
|                |     |                                      |       |
|                |     | 注                                   |       |
|                |     | ：对于三频设备，5G表示5.1G频段，5G-2 |       |
|                |     | 表示5.8G频段；双频设备忽略5G-2频段； |       |
+----------------+-----+--------------------------------------+-------+
| Index          | Num | SSID的索引，2.4G                     | Y     |
|                | ber | 采用1-4，5G采用5-8，5G-2索引为9-12； |       |
|                |     |                                      |       |
|                |     | 注：对于双频设备，忽略5G-2频段；     |       |
+----------------+-----+--------------------------------------+-------+
| Enable         | Num | 是否启用，1为启用，0禁用             | Y     |
|                | ber |                                      |       |
+----------------+-----+--------------------------------------+-------+
| SSID           | Str | SSID名称                             | Y     |
|                | ing |                                      |       |
+----------------+-----+--------------------------------------+-------+
| SecurityMode   | Str | 认证加密模式，枚举取值：             | Y     |
|                | ing |                                      |       |
|                |     | None                                 |       |
|                |     |                                      |       |
|                |     | WEP-64                               |       |
|                |     |                                      |       |
|                |     | WEP-128                              |       |
|                |     |                                      |       |
|                |     | WPA-Personal                         |       |
|                |     |                                      |       |
|                |     | WPA2-Personal                        |       |
|                |     |                                      |       |
|                |     | MIXED-WPAPSK2                        |       |
|                |     |                                      |       |
|                |     | WPA3-SAE                             |       |
|                |     |                                      |       |
|                |     | MIXED-WPA2WPA3                       |       |
+----------------+-----+--------------------------------------+-------+
| Pwd            | Str | Wi-Fi密钥，WEP Key或Pre-shared Key   | Y     |
|                | ing |                                      |       |
+----------------+-----+--------------------------------------+-------+
| M              | Num | 该SSID最大允许接入的用户数           | Y     |
| axAssociateNum | ber |                                      |       |
+----------------+-----+--------------------------------------+-------+
| SSIDAdvert     | Num | 是否广播SSID，1为广播，0为不广播     | Y     |
| isementEnabled | ber |                                      |       |
+----------------+-----+--------------------------------------+-------+

示例：

{\"deviceId\":\"\*\*\*\",\"data\":{\"SyncCode\":\"105\",\"Configurations\":\[{\"Radio\":\"2.4G\",\"Index\":1,\"Enable\":1,\"SSID\":\"CMCC-2341\",\"SecurityMode\":\"MIXED-WPAPSK2\",\"Pwd\":\"XXXXXX\",\"MaxAssociateNum\":32,\"SSIDAdvertisementEnabled\":1},{\"Radio\":\"5G\",\"Index\":5,\"Enable\":1,\"SSID\":\"CMCC-2341-5G\",\"SecurityMode\":\"MIXED-WPAPSK2\",\"Pwd\":\"XXXXXX\",\"MaxAssociateNum\":32,\"SSIDAdvertisementEnabled\":1}\]}}

## 响应 {#响应-2 .QB标题4}

表7.1-3 Wi-Fi参数同步响应

  ------------- ------------- ------------------------------------- ----------
  参数名        类型          描述                                  是否必须

  respCode      Number        响应码，1为成功，其余code见响应码表   Y

  restCont      String        响应的返回值，                        N
  ------------- ------------- ------------------------------------- ----------

成功示例：{\"respCode\":1}

失败示例：{\"respCode\":0,\"restCont\":\"XXXXX\"}

## 信息查询接口 {#信息查询接口 .QB标题3}

## Wi-Fi信息查询 {#wi-fi信息查询 .QB标题4}

接口说明：通过该消息查询家庭组网终端的Wi-Fi信息。

请求url：coap://APIP:5683/apdevice/query/WiFiStatus

请求类型：GET-CON

请求方向：网关-\>组网终端

## 请求 {#请求-3 .QB标题5}

无输入参数

## 响应 {#响应-3 .QB标题5}

表7.1-4 Wi-Fi信息查询响应

+------------------+--------+--------------------------------+---------+
| 参数名           | 类型   | 描述                           | 是      |
|                  |        |                                | 否必须  |
+------------------+--------+--------------------------------+---------+
| deviceId         | String | 组网终端ID                     | N       |
+------------------+--------+--------------------------------+---------+
| data             | Object | 响应数据                       | Y       |
+------------------+--------+--------------------------------+---------+
| Radios           | Array  | Wi-Fi射频信息数组；            | Y       |
|                  |        |                                |         |
|                  |        | 包含：Radio，                  |         |
|                  |        | Enable，TransmitPower，Channel |         |
+------------------+--------+--------------------------------+---------+
| Radio            | String | 频段，采用枚举取值：           | Y       |
|                  |        |                                |         |
|                  |        | 2.4G                           |         |
|                  |        |                                |         |
|                  |        | 5G                             |         |
|                  |        |                                |         |
|                  |        | 5G-2                           |         |
|                  |        |                                |         |
|                  |        | 注：对于三频设                 |         |
|                  |        | 备，5G表示5.1G频段，5G-2表示5. |         |
|                  |        | 8G频段；双频设备忽略5G-2频段； |         |
+------------------+--------+--------------------------------+---------+
| Enable           | Number | 频段是否启                     | Y       |
|                  |        | 用；枚举取值，1为启用，0为禁用 |         |
+------------------+--------+--------------------------------+---------+
| TransmitPower    | String | Wi-Fi发射功率级别（百分比）    | Y       |
+------------------+--------+--------------------------------+---------+
| Channel          | String | 当前工作信道号，若存在多个信道 | Y       |
|                  |        | ，可用","逗号分隔，例如："1,6" |         |
+------------------+--------+--------------------------------+---------+
| Configurations   | Array  | Wi-Fi信息数组；包含            | Y       |
|                  |        | Radio、Index、Enable、SSID、Se |         |
|                  |        | curityMode、Pwd、MaxAssociateN |         |
|                  |        | um和SSIDAdvertisementEnabled； |         |
+------------------+--------+--------------------------------+---------+
| Radio            | String | 频段，枚举取值：               | Y       |
|                  |        |                                |         |
|                  |        | 2.4G                           |         |
|                  |        |                                |         |
|                  |        | 5G                             |         |
|                  |        |                                |         |
|                  |        | 5G-2                           |         |
|                  |        |                                |         |
|                  |        | 注：对于三频设                 |         |
|                  |        | 备，5G表示5.1G频段，5G-2表示5. |         |
|                  |        | 8G频段；双频设备忽略5G-2频段； |         |
+------------------+--------+--------------------------------+---------+
| Index            | Number | SSID的索引                     | Y       |
+------------------+--------+--------------------------------+---------+
| Enable           | Number | 是否启用，1为启用，0为禁用     | Y       |
+------------------+--------+--------------------------------+---------+
| SSID             | String | SSID名称                       | Y       |
+------------------+--------+--------------------------------+---------+
| SecurityMode     | String | 认证加密模式，枚举取值：       | Y       |
|                  |        |                                |         |
|                  |        | None                           |         |
|                  |        |                                |         |
|                  |        | WEP-64                         |         |
|                  |        |                                |         |
|                  |        | WEP-128                        |         |
|                  |        |                                |         |
|                  |        | WPA-Personal                   |         |
|                  |        |                                |         |
|                  |        | WPA2-Personal                  |         |
|                  |        |                                |         |
|                  |        | MIXED-WPAPSK2                  |         |
|                  |        |                                |         |
|                  |        | WPA3-SAE                       |         |
|                  |        |                                |         |
|                  |        | MIXED-WPA2WPA3                 |         |
+------------------+--------+--------------------------------+---------+
| Pwd              | String | Wi-Fi密钥，                    | Y       |
|                  |        | 管理平台不应存储和显示此参数。 |         |
+------------------+--------+--------------------------------+---------+
| MaxAssociateNum  | Number | 该SSID最大                     | Y       |
|                  |        | 允许接入的用户数，0表示不限制  |         |
+------------------+--------+--------------------------------+---------+
| SSIDAdve         | Number | 是                             | Y       |
| rtisementEnabled |        | 否广播SSID，1为广播，0为不广播 |         |
+------------------+--------+--------------------------------+---------+

成功示例：

{\"deviceId\":\"xxxxxxxx\",\"data\":{\"Radios\":\[{\"Radio\":\"2.4G\",\"Enable\":1,\"TransmitPower\":\"100\",\"Channel\":\"1,6\"},{\"Radio\":\"5G\",\"Enable\":1,\"TransmitPower\":\"100\",\"Channel\":\"36\"}\],\"Configurations\":\[{\"Radio\":\"2.4G\",\"Index\":1,\"Enable\":1,\"SSID\":\"CMCC-2341\",\"SecurityMode\":\"MIXED-WPAPSK2\",\"Pwd\":\"\*\*\*\*\*\*\*\",\"MaxAssociateNum\":10,\"SSIDAdvertisementEnabled\":1},{\"Radio\":\"5G\",\"Index\":1,\"Enable\":1,\"SSID\":\"CMCC-2341-5G\",\"SecurityMode\":\"MIXED-WPAPSK2\",\"Pwd\":\"\*\*\*\*\*\*\*\",\"MaxAssociateNum\":10,\"SSIDAdvertisementEnabled\":1}\]}}

失败示例：{\"respCode\":1001,\"respCont\":\"invalid argument\"}

## 下挂设备信息 {#下挂设备信息 .QB标题4}

接口说明：通过该消息查询家庭组网终端当前下挂的设备信息。

请求url：coap://APIP:5683/apdevice/query/STAInfo

请求类型：GET-CON

请求方向：网关-\>家庭组网终端

## 请求 {#请求-4 .QB标题5}

无输入参数

## 响应 {#响应-4 .QB标题5}

表7.1-5 下挂设备信息响应

+-------------+-------+---------------------------------------+--------+
| 参数名      | 类型  | 描述                                  | 是     |
|             |       |                                       | 否必须 |
+=============+=======+=======================================+========+
| deviceId    | S     | 组网终端ID                            | N      |
|             | tring |                                       |        |
+-------------+-------+---------------------------------------+--------+
| data        | O     | 响应数据                              | Y      |
|             | bject |                                       |        |
+-------------+-------+---------------------------------------+--------+
| STANumber   | N     | 下挂                                  | Y      |
|             | umber | 设备数据，当值为0时，设备信息数组为空 |        |
+-------------+-------+---------------------------------------+--------+
| Devices     | Array | 连接                                  | N      |
|             |       | 的设备信息数组，下挂设备数非零时必选  |        |
+-------------+-------+---------------------------------------+--------+
| IPAddress   | S     | 下挂设备的内网I                       | N      |
|             | tring | Pv4地址；该字段在下挂设备数非零时必选 |        |
+-------------+-------+---------------------------------------+--------+
| STAIP       | S     | 下挂设备的IPV6地址；该字              | N      |
| v6IPAddress | tring | 段在下挂设备数非零，且支持IPv6时必选  |        |
+-------------+-------+---------------------------------------+--------+
| HostName    | S     | 下挂设备的H                           | N      |
|             | tring | ostName；该字段在下挂设备数非零时必选 |        |
+-------------+-------+---------------------------------------+--------+
| MacAddress  | S     | 下                                    | N      |
|             | tring | 挂设备MAC地址，格式为不带冒号且大写； |        |
|             |       |                                       |        |
|             |       | 该字段在下挂设备数非零时必选          |        |
+-------------+-------+---------------------------------------+--------+
| VMacAddress | S     | 下挂设备在组网终端下的虚拟MAC，如果未 | N      |
|             | tring | 转换，则和真实MAC一致。格式为不带冒号 |        |
|             |       | 且大写；该字段在下挂设备数非零时必选  |        |
+-------------+-------+---------------------------------------+--------+
| STAType     | S     | 下挂设备                              | N      |
|             | tring | 类型；该字段在下挂设备数非零时必选；  |        |
+-------------+-------+---------------------------------------+--------+
| UpTime      | S     | 已连接时间，单                        | N      |
|             | tring | 位：秒；该字段在下挂设备数非零时必选  |        |
+-------------+-------+---------------------------------------+--------+
| Radio       | S     | WLAN下挂设备的接入频段，取            | N      |
|             | tring | 值2.4G、5G或5G-2，对非WLAN下挂设备应  |        |
|             |       | 填空值；该字段在下挂设备数非零时必选  |        |
|             |       |                                       |        |
|             |       | 注：对于三频设备，5G表示5.1G频段，5G- |        |
|             |       | 2表示5.8G频段；双频设备忽略5G-2频段； |        |
+-------------+-------+---------------------------------------+--------+
| SSID        | S     | WLAN下挂设                            | N      |
|             | tring | 备的接入SSID名称，非WLAN下挂设备应填  |        |
|             |       | 空值；该字段在下挂设备数非零时必选；  |        |
+-------------+-------+---------------------------------------+--------+
| RSSI        | S     | WLAN下挂设备当前的信                  | N      |
|             | tring | 号强度，单位为dBm，对非WLAN下挂设备应 |        |
|             |       | 填空值；该字段在下挂设备数非零时必选  |        |
+-------------+-------+---------------------------------------+--------+
| RxRate      | S     | 下挂设备协商接                        | N      |
|             | tring | 收速率；该字段在下挂设备数非零时必选  |        |
+-------------+-------+---------------------------------------+--------+
| TxRate      | S     | 下挂设备协商发                        | N      |
|             | tring | 送速率；该字段在下挂设备数非零时必选  |        |
+-------------+-------+---------------------------------------+--------+

成功示例：

{\"deviceId\":\"xxxxxxxx\",\"data\":{\"STANumber\":2,\"Devices\":\[{\"IPAddress\":\"192.168.10.1\",\"STAIPv6IPAddress\":\"2001:DA8:1000::F1\",\"HostName\":\"AP1\",\"MacAddress\":\"012233445566\",\"VMacAddress\":\"012233445566\",\"STAType\":\"phone\",\"UpTime\":\"100\",\"Radio\":\"2.4G\",\"SSID\":\"CMCC-12345\",\"RSSI\":\"-55\",\"RxRate\":\"1000\",\"TxRate\":\"1000\"},{\"IPAddress\":\"192.168.10.3\",\"STAIPv6IPAddress\":\"2001:DA8:1000::F2\",\"HostName\":\"AP2\",\"MacAddress\":\"012233445566\",\"VMacAddress\":\"012233445566\",\"UpTime\":\"100\",\"Radio\":\"5G\",\"SSID\":\"CMCC-12345-5G\",\"RSSI\":\"-55\",\"RxRate\":\"1000\",\"TxRate\":\"1000\"}\]}}

失败示例：{\"respCode\":1001,\"respCont\":\"invalid argument\"}

## 周边Wi-Fi信息 {#周边wi-fi信息 .QB标题4}

接口说明：通过该消息查询组网终端周边Wi-Fi信息。

请求url：coap://APIP:5683/apdevice/query/WlanNeighborInfo

请求类型：GET-CON

请求方向：网关-\>家庭组网终端

## 请求 {#请求-5 .QB标题5}

无输入参数

## 响应 {#响应-5 .QB标题5}

表7.1-6 周边Wi-Fi信息响应

+--------+----------+----------------------------------------+--------+
| 参数名 | 类型     | 描述                                   | 是     |
|        |          |                                        | 否必须 |
+========+==========+========================================+========+
| de     | String   | 家庭组网终端ID                         | Y      |
| viceId |          |                                        |        |
+--------+----------+----------------------------------------+--------+
| data   | Object   | 响应数据                               | Y      |
+--------+----------+----------------------------------------+--------+
| Number | Number   | 周边W                                  | Y      |
|        |          | i-Fi数量，当值为0时，Wi-Fi信息数组为空 |        |
+--------+----------+----------------------------------------+--------+
| Radios | Array    | 周边                                   | N      |
|        |          | Wi-Fi信息数组，当周边Wi-Fi不为0时有效  |        |
+--------+----------+----------------------------------------+--------+
| Radio  | String   | 频段：2.4G、5G                         | N      |
+--------+----------+----------------------------------------+--------+
| SSID   | String   | 周边Wi-Fi的SSID名称                    | N      |
+--------+----------+----------------------------------------+--------+
| MacA   | String   | 周边                                   | N      |
| ddress |          | Wi-Fi的MAC地址，格式为不带冒号并且大写 |        |
+--------+----------+----------------------------------------+--------+
| C      | String   | 周边Wi-Fi信道，如存在                  | N      |
| hannel |          | 多个信道，可用","逗号分隔，例如："1,6" |        |
+--------+----------+----------------------------------------+--------+
| Ban    | Number   | 周边Wi-Fi频宽，采                      | N      |
| dwidth |          | 用枚举取值：周边Wi-Fi数量非零时必选；  |        |
|        |          |                                        |        |
|        |          | 1：20MHz                               |        |
|        |          |                                        |        |
|        |          | 2：40MHz                               |        |
|        |          |                                        |        |
|        |          | 3：80MHz                               |        |
|        |          |                                        |        |
|        |          | 4：160MHz                              |        |
|        |          |                                        |        |
|        |          | 5：80+80MHz                            |        |
|        |          |                                        |        |
|        |          | 0：自适应频宽                          |        |
+--------+----------+----------------------------------------+--------+
| RSSI   | String   | 周边Wi-Fi的弱信号值                    | N      |
+--------+----------+----------------------------------------+--------+
| Lo     | Number   | 信道使用率（%），数据范围：0-100；     | N      |
| adRate |          |                                        |        |
+--------+----------+----------------------------------------+--------+
| Wifist | Number   | 周边Wi-Fi使用的无线标准，采            | N      |
| andard |          | 用枚举取值：周边Wi-Fi数量非零时必选；  |        |
|        |          |                                        |        |
|        |          | 0：:802.11a或802.11b                   |        |
|        |          |                                        |        |
|        |          | 1：802.11b/g                           |        |
|        |          |                                        |        |
|        |          | 2：802.11b/g/n                         |        |
|        |          |                                        |        |
|        |          | 3：802.11a/n/ac                        |        |
|        |          |                                        |        |
|        |          | 4：802.11b/g/n/ax                      |        |
|        |          |                                        |        |
|        |          | 5：802.11a/n/ac/ax                     |        |
|        |          |                                        |        |
|        |          | 6：802.11a/n                           |        |
|        |          |                                        |        |
|        |          | 7：802.11n                             |        |
|        |          |                                        |        |
|        |          | 8：802.11g                             |        |
|        |          |                                        |        |
|        |          | 9：802.11g/n                           |        |
+--------+----------+----------------------------------------+--------+

注：当周边Wi-Fi数量超过24时，按RSSI信号强度从大道小上报24个周边Wi-Fi信息；

成功示例：

{\"deviceId\":\"xxxxxxxx\",\"data\":{\"Number\":2,\"Radios\":\[{\"Radio\":\"2.4G\",\"SSID\":\"CMCC-1234\",\"MacAddress\":\"0A2233445568\",\"Channel\":\"1,6\",\"Bandwidth\":4,\"RSSI\":\"-60\",\"LoadRate\":50,\"Wifistandard\":3},{\"Radio\":\"5G\",\"SSID\":\"CMCC-1234\",\"MacAddress\":\"0B2233445566\",\"Channel\":\"36\",\"Bandwidth\":4,\"RSSI\":\"-50\",\"LoadRate\":50,\"Wifistandard\":4}\]}}

失败示例：

{\"respCode\":1001,\"respCont\":\"invalid argument\"}

## 组网终端与省级数字家庭管理平台交互接口定义（IF6） {#组网终端与省级数字家庭管理平台交互接口定义if6 .QB标题2}

## 接口描述 {#接口描述 .QB标题3}

表7.2-1 组网终端与省级数字家庭管理平台交互接口汇总

  ---------- ----------------------------------- --------------------- ---------------------
  接口ID     接口说明                            接口方向              接口类型

  7.2.2.1    设备上线接口                        设备\>平台            JSON

  7.2.2.2    设备认证接口                        设备\>平台            JSON

  7.2.2.3    心跳保活接口                        设备\>平台            JSON

  7.2.2.4    反向触发设备发起TCP连接到平台接口   平台\>设备            JSON

  7.2.2.5    服务器断开连接接口                  平台\>设备            JSON

  7.2.2.6    事件上报接口                        设备\>平台            JSON

  7.2.2.7    周期/上电上报接口                   设备\>平台            JSON

  7.2.2.8    功能控制接口                        平台\>设备            JSON

  7.2.2.9    信息查询接口                        平台\>设备            JSON

  7.2.2.10   设备升级接口                        平台\>设备            JSON

  7.2.2.11   云漫游控制接口                      平台\>设备            JSON
  ---------- ----------------------------------- --------------------- ---------------------

## 接口详细定义 {#接口详细定义 .QB标题3}

## 设备上线接口 {#设备上线接口 .QB标题4}

接口说明：组网终端启动或WAN IP变更后，向平台发送boot消息发起上线。

请求方向：组网终端-\>省级数字家庭管理平台

## 请求 {#请求-6 .QB标题5}

表7.2-2 设备上线请求

+--------------+-------+---------------------------------------+-------+
| 参数名       | 类型  | 描述                                  | 是否  |
|              |       |                                       | 必须  |
+==============+=======+=======================================+=======+
| RPCMethod    | S     | 命令字，取值"boot"                    | Y     |
|              | tring |                                       |       |
+--------------+-------+---------------------------------------+-------+
| DevRND       | S     | DevRND为设备生成的                    | Y     |
|              | tring | 随机数，将用于"反向调用"触发时校验平  |       |
|              |       | 台的合法性，32字节16进制随机数字符串  |       |
+--------------+-------+---------------------------------------+-------+
| deviceMac    | S     | 组网终端铭牌MAC地址，推荐使           | Y     |
|              | tring | 用WAN口MAC，格式为不带冒号并且大写；  |       |
+--------------+-------+---------------------------------------+-------+
| cmei         | S     | 组网终端串码号                        | Y     |
|              | tring |                                       |       |
+--------------+-------+---------------------------------------+-------+
| deviceType   | S     | 组网终端产品类型                      | Y     |
|              | tring |                                       |       |
+--------------+-------+---------------------------------------+-------+
| fir          | S     | 组网终端硬件版本                      | Y     |
| mwareVersion | tring |                                       |       |
+--------------+-------+---------------------------------------+-------+
| sof          | S     | 组网终端软件版本                      | Y     |
| twareVersion | tring |                                       |       |
+--------------+-------+---------------------------------------+-------+
| networkP     | S     | 组网中间件版本；                      | Y     |
| luginVersion | tring |                                       |       |
+--------------+-------+---------------------------------------+-------+
| bootType     | N     | Udp boot触发类型，枚举取值：          | Y     |
|              | umber |                                       |       |
|              |       | 0：重试触发（未断电）                 |       |
|              |       |                                       |       |
|              |       | 1：上电触发（非恢复出厂）；           |       |
|              |       |                                       |       |
|              |       | 2：恢复出厂触发                       |       |
+--------------+-------+---------------------------------------+-------+
| PPPOEuser    | S     | PPPOE账号信息（7.1.1.2上联网关查询    | Y     |
|              | tring | 接口获取成功时，上报网关PPPoE账号；AP |       |
|              |       | 工作在PPPOE拨号上网时，填写AP自身的PP |       |
|              |       | PoE账号；除上述两种情况外，该值为空） |       |
+--------------+-------+---------------------------------------+-------+
| WorkingMode  | N     | AP工作模式，枚举取值：                | Y     |
|              | umber |                                       |       |
|              |       | 0：桥接                               |       |
|              |       |                                       |       |
|              |       | 1：路由                               |       |
|              |       |                                       |       |
|              |       | 2：中继                               |       |
+--------------+-------+---------------------------------------+-------+
| ipAddress    | S     | 组网终端IPv4地址                      | Y     |
|              | tring |                                       |       |
+--------------+-------+---------------------------------------+-------+
| IPv6Status   | N     | 组网终端IPv4/IPv6双栈状态，枚举取值； | N     |
|              | umber |                                       |       |
|              |       | 0：关闭IPv4/IPv6双栈                  |       |
|              |       |                                       |       |
|              |       | 1：开启IPv4/IPv6双栈                  |       |
+--------------+-------+---------------------------------------+-------+
| I            | S     | 组网终端IPv6地址;                     | Y     |
| Pv6IPAddress | tring |                                       |       |
+--------------+-------+---------------------------------------+-------+
| timestamp    | N     | 时间戳，单位：毫秒                    | Y     |
|              | umber |                                       |       |
+--------------+-------+---------------------------------------+-------+
| XData        | O     | 需解析数据                            | Y     |
|              | bject | 包，包含deviceVendor、deviceModel、d  |       |
|              |       | eviceSn、FlashSize、RamSize、apUplink |       |
|              |       | Type、radio5、factorySetting、apUplin |       |
|              |       | kMac、andlinkVersion、UplinkMac等信息 |       |
+--------------+-------+---------------------------------------+-------+
| deviceVendor | S     | 厂商编码                              | Y     |
|              | tring |                                       |       |
+--------------+-------+---------------------------------------+-------+
| deviceModel  | S     | 型号编码                              | Y     |
|              | tring |                                       |       |
+--------------+-------+---------------------------------------+-------+
| deviceSn     | S     | 序列号                                | Y     |
|              | tring |                                       |       |
+--------------+-------+---------------------------------------+-------+
| cpuType      | S     | C                                     | N     |
|              | tring | PU型号；示例：MTK7621DA，精确到型号； |       |
+--------------+-------+---------------------------------------+-------+
| FlashSize    | N     | Flash容量，单位：MB                   | Y     |
|              | umber |                                       |       |
+--------------+-------+---------------------------------------+-------+
| RamSize      | N     | Ram容量，单位：MB                     | Y     |
|              | umber |                                       |       |
+--------------+-------+---------------------------------------+-------+
| apUplinkType | S     | 上行接入方式：                        | Y     |
|              | tring |                                       |       |
|              |       | WLAN、Ethernet、PLC、Cable、Optical   |       |
|              |       | Ethernet、GPON、XGPON、PoE            |       |
+--------------+-------+---------------------------------------+-------+
| radio5       | N     | 组网终端支持频段信息：                | Y     |
|              | umber |                                       |       |
|              |       | 0：单频组网终端                       |       |
|              |       |                                       |       |
|              |       | 1：双频组网终端                       |       |
|              |       |                                       |       |
|              |       | 2：三频组网终端                       |       |
+--------------+-------+---------------------------------------+-------+
| fa           | N     | 是否恢复出厂设置首次上线；            | Y     |
| ctorySetting | umber |                                       |       |
|              |       | 1：首次上线，0：非首次上线            |       |
+--------------+-------+---------------------------------------+-------+
| apUplinkMac  | S     | 上联网元Mac，非PPPoE拨号时必选；      | N     |
|              | tring |                                       |       |
|              |       | 注：光网关该值为空；                  |       |
+--------------+-------+---------------------------------------+-------+
| an           | S     | 网关插件版本；                        | N     |
| dlinkVersion | tring |                                       |       |
|              |       | 在7.1.1.2上                           |       |
|              |       | 联网关查询接口获取成功的情况下必选；  |       |
+--------------+-------+---------------------------------------+-------+
| UplinkMac    | S     | 网关mac；                             | N     |
|              | tring |                                       |       |
|              |       | 在7.1.1.                              |       |
|              |       | 2上联网关查询接口获取成功的情况下必选 |       |
+--------------+-------+---------------------------------------+-------+
| meshRole     | N     | Mesh角色，枚举取值：                  | N     |
|              | umber |                                       |       |
|              |       | 0：非mesh终端；                       |       |
|              |       |                                       |       |
|              |       | 1：controller；                       |       |
|              |       |                                       |       |
|              |       | 2：agent；                            |       |
|              |       |                                       |       |
|              |       | 3：AC；                               |       |
|              |       |                                       |       |
|              |       | 4：AP；（专指面板式AP）               |       |
+--------------+-------+---------------------------------------+-------+
| wifiS        | N     | Wi-Fi无线规格，采用枚举取值：         | Y     |
| pecification | umber |                                       |       |
|              |       | 1：AC120                              |       |
|              |       | 0（空间流：2.4G：2×2，5G：2×2@80MHz） |       |
|              |       |                                       |       |
|              |       | 2：AC190                              |       |
|              |       | 0（空间流：2.4G：3×3，5G：3×3@80MHz） |       |
|              |       |                                       |       |
|              |       | 3：AC210                              |       |
|              |       | 0（空间流：2.4G：2×2，5G：4×4@80MHz） |       |
|              |       |                                       |       |
|              |       | 4：AC2100                             |       |
|              |       | （空间流：2.4G：2×2，5G：2×2@160MHz） |       |
|              |       |                                       |       |
|              |       | 5：AC260                              |       |
|              |       | 0（空间流：2.4G：4×4，5G：4×4@80MHz） |       |
|              |       |                                       |       |
|              |       | 6：AX150                              |       |
|              |       | 0（空间流：2.4G：2×2，5G：2×2@80MHz） |       |
|              |       |                                       |       |
|              |       | 7：AX180                              |       |
|              |       | 0（空间流：2.4G：2×2，5G：2×2@80MHz） |       |
|              |       |                                       |       |
|              |       | 8：AX3000                             |       |
|              |       | （空间流：2.4G：2×2，5G：2×2@160MHz） |       |
|              |       |                                       |       |
|              |       | 9：AX300                              |       |
|              |       | 0（空间流：2.4G：2×2，5G：4×4@80MHz） |       |
|              |       |                                       |       |
|              |       | 10：AX360                             |       |
|              |       | 0（空间流：2.4G：4×4，5G：4×4@80MHz） |       |
|              |       |                                       |       |
|              |       | 11：AX5400                            |       |
|              |       | （空间流：2.4G：2×2，5G：4×4@160MHz） |       |
|              |       |                                       |       |
|              |       | 12：AX6000                            |       |
|              |       | （空间流：2.4G：4×4，5G：4×4@160MHz） |       |
|              |       |                                       |       |
|              |       | 13：AX4200（空间流：2.4G：2×2         |       |
|              |       | ，5.2G：2×2@160MHz，5.8G：2×2@80MHz） |       |
+--------------+-------+---------------------------------------+-------+
| apType       | N     | 终端类型，枚举取值；                  | Y     |
|              | umber |                                       |       |
|              |       | 0：常规路由器（DC12供电）             |       |
|              |       |                                       |       |
|              |       | 1：AP面板（PoE供电）                  |       |
|              |       |                                       |       |
|              |       | 2：AC控制器                           |       |
|              |       |                                       |       |
|              |       | 3：PLC终端                            |       |
|              |       |                                       |       |
|              |       | 4：FTTR-光网关                        |       |
|              |       |                                       |       |
|              |       | 5：FTTR-光路由（DC12供电）            |       |
|              |       |                                       |       |
|              |       | 6：FTTR-光路由（光电混合缆供电）      |       |
|              |       |                                       |       |
|              |       | 7：FTTR-光交换机                      |       |
+--------------+-------+---------------------------------------+-------+

成功示例：

{\"RPCMethod\":\"boot\",\"DevRND\":\"011CB9249F81239A225D23CDA27EA24C\",\"deviceMac\":\"XXXXXXXXX\",\"cmei\":\"XXXXXXXXX\",\"deviceType\":\"30103\",\"firmwareVersion\":\"1.0.1\",\"softwareVersion\":\"3.2\",\"networkPluginVersion\":\"V1.5.0\",\"bootType\":1,\"PPPOEuser\":\"xxxx\",\"WorkingMode\":0,\"ipAddress\":\"192.168.1.111\",\"IPv6Status\":1,\"IPv6IPAddress\":\"2001:DA8:1000::F1\",\"timestamp\":1628562566021,\"XData\":{\"deviceVendor\":\"01\",\"deviceModel\":\"1101\",\"deviceSn\":\"011101xxxxxxxxxx\",\"cpuType\":\"MT7621DA\",\"FlashSize\":128,\"RamSize\":256,\"apUplinkType\":\"Ethernet\",\"radio5\":1,\"factorySetting\":1,\"apUplinkMac\":\"\*\*\*\*\*\*\",\"andlinkVersion\":\"V2.6\",\"meshRole\":1,\"wifiSpecification\":8,\"apType\":0}}

## 响应 {#响应-6 .QB标题5}

表7.2-3 设备上线响应

  ------------------------------------------------------------------------------------------
  参数名          类型     描述                                                   是否必须
  --------------- -------- ------------------------------------------------------ ----------
  respCode        Number   返回结果取值：0\|-1\|-2\|-5，见附录B。                 Y

  respCont        String   设备上线失败时的返回值；                               N

  timestamp       Number   平台时间戳，单位：毫秒；成功响应时必选；               N

  encrypt         Number   后续报文是否加密，缺省为1，加密，成功响应时必选；      N

  ChallengeCode   String   十六字节随机数，用于下一步验证终端，成功响应时必选；   N

  ServerIP        String   管理服务器域名或IP：端口号，格式为:"IP地址:端口号";    N

  timeAdjust      Number   该设备是否需要进行时间校准，0：不需要；1：需要。       N
  ------------------------------------------------------------------------------------------

成功示例：{\"respCode\":0,\"timestamp\":1590274859154,\"encrypt\":1,\"ChallengeCode\":\"十六字节随机数\",\"ServerIP\":\"10.34.33.34:9007\",\"timeAdjust\":1}

失败示例：{\"respCode\":-5,\"respCont\":\"Reconnect to other servers\"}

注：

1)  设备上电后，若没有收到平台响应（10秒）或平台返回-1时，应重新解析DNS，按图7-1重试机制发起重试，采用配置文件中预置省级数字家庭管理平台地址发起请求（Boot）；

2)  设备Boot成功后连接异常断开时，若没有收到平台响应（10秒）或平台返回-1时，应选择重新解析DNS，按图7-1重试机制，采用配置文件中预置省级数字家庭管理平台地址发起请求（Boot）。

3）平台返回-2时，表示设备提交信息不合法，设备在重启或WAN
IP变更时再调用本接口。

4）平台返回-5时，会同时携带ServerIP参数，此后设备应立即连接该服务器，重新开始上线过程。

5\) IF6平台设备重试机制；设备尝试上线时，起始n =
0，当操作失败时，n++进入重试，若重试次数超过5次，则取n=5，重试间隔时间interval
= 30\*2\^(n-1)+rand\[0-50\]。

> ![](media/image40.emf)
>
> 图7-1 IF6上线重试机制

## 设备认证接口 {#设备认证接口 .QB标题4}

接口说明：组网终端向省级数字家庭管理平台认证消息。

请求方向：组网终端-\>省级数字家庭管理平台

## 请求 {#请求-7 .QB标题5}

表7.2-4 认证请求

  --------------- -------- ---------------------------------------------------------------------------------------------------------------------------------------------------- ----------
  参数名          类型     描述                                                                                                                                                 是否必须

  RPCMethod       String   命令字，取值"Register"                                                                                                                               Y

  MAC             String   组网终端铭牌MAC地址                                                                                                                                  Y

  CheckSN         String   ChallengeCode与SN的MD5结果，SN序列号格式要求见《中国移动家庭组网终端技术规范》                                                                       Y

  LockNetStatus   Number   锁网状态标识，表示设备当前的锁网状态：1为锁网（设备保留Wi-Fi信号，但需关闭Wi-Fi与有线上网功能，详见组网终端技术规范），0为不锁网（设备可正常上网）   Y
  --------------- -------- ---------------------------------------------------------------------------------------------------------------------------------------------------- ----------

示例：

{\"RPCMethod\":\"Register\",\"MAC\":\"AABBCCDDEEFF\",\"CheckSN\":\"e10adc3949ba59abbe56e057f20f883e\",\"LockNetStatus\":0}

## 响应 {#响应-7 .QB标题5}

表7.2-5 认证响应

  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  参数名            类型     描述                                                                                                                                       是否必须
  ----------------- -------- ------------------------------------------------------------------------------------------------------------------------------------------ ----------
  respCode          Number   响应码，取值范围：2\|-2\|-5                                                                                                                Y

  respCont          String   设备认证失败时的返回值；                                                                                                                   N

  heartBeatTime     Number   设备心跳包间隔时长，单位为毫秒，成功响应时必选；                                                                                           N

  MessageServer     String   消息服务器域名或IP：端口号，格式为:IP地址:端口号 。如果消息服务器与管理服务器共用，不带该属性。                                            N

  ServerIP          String   管理服务器域名或IP：端口号，格式为:IP地址:端口号；                                                                                         N

  SoftProbeServer   String   数据采集服务器域名或IP：端口号，格式为:IP地址:端口号；成功响应时必选；                                                                     N

  LockNet           Number   锁网标识，1为锁网（设备保留Wi-Fi信号，但需关闭Wi-Fi与有线上网功能，详见组网终端技术规范），0为不锁网（设备可正常上网），成功响应时必选；   N

  ClientIP          String   设备出口公网IP及端口号；                                                                                                                   Y
  --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

成功示例：

{\"respCode\":2,\"heartBeatTime\":60000,\"MessageServer\":\"10.34.33.34:9005\",\"SoftProbeServer\":\"10.34.33.35:9008\",\"LockNet\":0,\"ClientIP\":\"112.32.23.16\"}

失败示例：{\"respCode\":-5,\"respCont\":\"Reconnect to other
servers\",\"ServerIP\":\"10.10.23.2:9007\"}

说明：

当Boot成功时，得到ChallengeCode，将它与设备SN拼接后，计算MD5值为CheckSN。平台通过上一步中的MAC地址在数据库中找到该设备的SN，用相同的方法计算MD5值后进行比对，如果相同，则认证成功，返回2，同时携带MessageServer参数（消息服务器，设备有需要主动上报的消息时，主动tcp连接MessageServer，连接协商成功后主动上报需要上报的消息）；

返回-2后，表示CheckSN校验失败，设备静默10分钟，再重新进行Boot。

如果平台没有响应（10秒），设备应用相同服务器端口重试，重试间隔为60秒，重发3次；如果3次重试仍然没有收到回复。则重新进行Boot。

平台返回-5时，会同时携带ServerIP参数，此后设备应立即连接该服务器，重新开始Boot过程。

如果返回信息中有heartBeatTime，由后续心跳保活消息按照指定的心跳间隔进行。

## 心跳保活接口 {#心跳保活接口 .QB标题4}

接口说明：组网终端发送心跳消息到管理平台，根据保存的组网终端心跳间隔时长，来判断组网终端是否在线。心跳周期在设备认证时获取。

请求方向：组网终端-\>省级数字家庭管理平台

## 请求 {#请求-8 .QB标题5}

表7.2-6 心跳保活请求

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------
  参数名          类型        描述                                                                                                                         是否必须
  --------------- ----------- ---------------------------------------------------------------------------------------------------------------------------- ----------
  RPCMethod       String      命令字，取值"heartbeat"                                                                                                      Y

  MAC             String      组网终端铭牌MAC地址                                                                                                          Y

  IPAddr          String      设备内网地址；                                                                                                               Y

  LockNetStatus   Number      锁网状态标识：1为锁网（设备保留Wi-Fi信号，但需关闭Wi-Fi与有线上网功能，详见组网终端技术规范），0为不锁网（设备可正常上网）   Y
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------

示例：{\"RPCMethod\":\"heartbeat\",\"MAC\":\"AABBCCDDEEFF\",\"IPAddr\":\"192.168.1.111\",\"LockNetStatus\":0}

## 响应 {#响应-8 .QB标题5}

表7.2-7 心跳保活响应

+-----------+-------+---------------------------------------+--------+
| 参数名    | 类型  | 描述                                  | 是     |
|           |       |                                       | 否必须 |
+-----------+-------+---------------------------------------+--------+
| respCode  | N     | 响应码， 0为成功，详见附录B           | Y      |
|           | umber |                                       |        |
+-----------+-------+---------------------------------------+--------+
| respCont  | S     | 接口调用失败时的返回值；              | N      |
|           | tring |                                       |        |
+-----------+-------+---------------------------------------+--------+
| hear      | N     | 设备心跳包间隔时长，单位为毫秒        | Y      |
| tBeatTime | umber |                                       |        |
+-----------+-------+---------------------------------------+--------+
| ServerIP  | S     | 管理服务器域                          | Y      |
|           | tring | 名或IP：端口号，格式为:IP地址:端口号  |        |
+-----------+-------+---------------------------------------+--------+
| LockNet   | N     | 锁网标识，1为锁网（设                 | Y      |
|           | umber | 备需关闭Wi-Fi与有线上网功能，详终端技 |        |
|           |       | 术规范），0为不锁网（设备可正常上网） |        |
+-----------+-------+---------------------------------------+--------+
| ClientIP  | S     | 设备出口公网IP；                      | Y      |
|           | tring |                                       |        |
+-----------+-------+---------------------------------------+--------+
| [L        | [Numb | [锁网类型；]{.mark}                   | [N]{   |
| ockNetTyp | er]{. |                                       | .mark} |
| e]{.mark} | mark} | [1：基于                              |        |
|           |       | IP锁网；2：基于宽带账号锁网；]{.mark} |        |
|           |       |                                       |        |
|           |       | [说明：该                             |        |
|           |       | 字段缺失时，默认基于IP锁网；]{.mark}  |        |
+-----------+-------+---------------------------------------+--------+
| [Accoun   | [Stri | [宽带账号；]{.mark}                   | [N]{   |
| t]{.mark} | ng]{. |                                       | .mark} |
|           | mark} |                                       |        |
+-----------+-------+---------------------------------------+--------+

成功示例：{\"respCode\":0,\"heartBeatTime\":60000,\"LockNet\":0,\"ClientIP\":\"112.32.23.16\",[\"LockNetType\":1,
\"Account \":\"xxxxxxxx\"]{.mark}}

失败示例：{\"respCode\":-5,\"respCont\":\"Reconnect to other
servers\",\"ServerIP\":\"10.10.23.2:9007\"}

注：respCode取值0/-1/-3/-5：

按心跳周期（默认值60秒）发送心跳：

心跳发出后在重试间隔的一半未收到响应，即开始重试，重试间隔为心跳周期一半。如果3次重试仍然没有收到回复，则回到Boot。

收到回复时，保持正常心跳周期。

平台若返回-3时，需要设备重新向平台上线，即回到Boot。

平台返回-5时，会同时携带ServerIP参数，此后设备应立即连接该服务器，重新开始上线过程。

 如果返回信息中有heartBeatTime，由需要用新心跳间隔进行工作。

## 反向触发设备发起TCP连接到平台接口 {#反向触发设备发起tcp连接到平台接口 .QB标题4}

接口说明：省级数字家庭管理平台向组网终端发起配置或查询时，发送该消息给组网终端建立TCP连接。

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-9 .QB标题5}

表7.2-8 反向触发请求

  ------------- ---------- ------------------------------------------------------------------------------ ----------
  参数名        类型       描述                                                                           是否必须

  RPCMethod     String     命令字，取值"RequestPlug-in"                                                   Y

  Key           String     DevRND拼接SN的MD5值；                                                          Y

  ServerAddr    String     服务器IP地址或域名                                                             Y

  ServerPort    String     TCP端口                                                                        Y

  RoamingAddr   String     云漫游服务器IP地址或域名，云漫游功能开启时必选                                 N

  RoamingPort   String     云漫游服务器TCP端口，云漫游功能开启时必选                                      N

  TcpChannel    Number     TCP通道选择；TcpChannel = 0：建立纳管TCP通道；TcpChannel                       N
                           =1：建立云漫游TCP通道；云漫游功能开启时必选；该字段缺失时，建立纳管TCP通道；   
  ------------- ---------- ------------------------------------------------------------------------------ ----------

示例：

{\"RPCMethod\":\"RequestPlug-in\",\"Key\":\"f11adc3949ba59abbe56e057f20f883e\",\"ServerAddr\":\"10.34.33.34\",\"ServerPort\":\"9005\",\"RoamingAddr\":\"xx.xx.xx.xx\",\"RoamingPort\":\"9015\",\"TcpChannel\":1}

## 响应 {#响应-9 .QB标题5}

表7.2-9 反向触发响应

  ------------ ---------- ------------------------------------- ----------
  参数名       类型       描述                                  是否必须

  respCode     Number     响应码，取值范围：0或-1               Y

  respCont     String     接口调用失败时的返回值；              N

  DevRND       String     32字节随机数，仅用于设备响应平台      N
  ------------ ---------- ------------------------------------- ----------

成功示例：{\"respCode\":0,\"DevRND\":\"089CB9249F81239A225D23CDA27EA53D\"}

失败示例：{\"respCode\":-1,\"respCont\":\"Fail\"}

## 平台回应 {#平台回应 .QB标题5}

表7.2-10 反向触发平台回应

  ------------ ---------- ------------------------------------- ----------
  参数名       类型       描述                                  是否必须

  respCode     Number     响应码，取值范围：1或-1               Y

  respCont     String     接口调用失败时的返回值；              N
  ------------ ---------- ------------------------------------- ----------

回应示例：{\"respCode\":1}

注：

反向触发设备。判断key是否与平台前一次下发的RequestPlug-in相同，如果相同则收到的是平台重传报文，回复当前的DevRND和结果码。否则，用当前DevRND值拼接SN，并计算出MD5值，与请求中的Key进行比较：

如果相同，设备连接指定的服务器，并且设备回应respCode为0和下一次使用的DevRND。平台接收到新的DevRND后，返回respCode为1。若没有收到结果或平台返回respCode为-1，设备应重试三次，超时间为5秒。如果仍然失败，回到Boot。

如果不相同，设备应返回-1，设备回到Boot。

如果设备正在或已经连接到管理平台，设备再收到反向触发连接，设备立即返回respCode为0和新的devRND，保持当前TCP连接过程。

平台在处理反向触发连接流程过程中，当再次收到反向触发要求时，平台应过滤掉本次反向触发请求。

云漫游专属TCP2连接（以下简称TCP2连接）说明：

-   平台独立设置云漫游功能模块，AP终端与平台建立TCP2连接，实现云漫游接口交互（以下接口7.2.2.11.1、7.2.2.11.2、7.2.2.11.3、7.2.2.11.4、7.2.2.11.5、7.2.2.11.6通过TCP2连接进行承载）；其他接口走常规TCP通道；

-   AP收到平台建立TCP2的反向触发后，即建立同平台的TCP2的连接，TCP2连接默认不断开，平台通过TCP2下发云漫游配置；

-   AP以平台对TCP2下发Disconnect指令为准，收到Disconnect指令后断开TCP2连接；

-   AP同平台建立TCP2连接，该连接一直存在（因断电或网络异常导致TCP2断开时，待网络恢复后，按图7-1方式进行TCP2连接重试）；

-   若平台通过TCP2通道下发Disconnect连接，但未下发关闭云漫游功能时，AP将继续开启云漫游功能，待监测到漫游阈值时，设备主动建立TCP2连接，该连接将持续存在；

## 服务器断开连接接口 {#服务器断开连接接口 .QB标题4}

接口说明：省级数字家庭管理平台要求组网终端断开TCP连接消息，组网终端回复后关闭TCP连接。

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-10 .QB标题5}

表7.2-11 断开连接请求

  ----------- --------- ---------------------------------------------------------------------------------------------------------------------------------------------------- ----------
  参数名      类型      描述                                                                                                                                                 是否必须

  RPCMethod   String    命令字，取值"Disconnect"                                                                                                                             Y

  ID          String    事务ID，平台下发给设备的指令都携带事务ID号，要求返回执行结果时，必须携带该ID，以便于对设备执行指令的管理。使设备能够实现并行任务执行能力；（下同）   Y
  ----------- --------- ---------------------------------------------------------------------------------------------------------------------------------------------------- ----------

示例：{\"RPCMethod\":\"Disconnect\",\"ID\":\"12345678\"}

## 响应 {#响应-10 .QB标题5}

表7.2-12 断开连接响应

  ------------ ---------- ------------------------------------- ----------
  参数名       类型       描述                                  是否必须

  respCode     Number     响应码，取值范围：0或-1               Y

  respCont     String     接口调用失败时的返回值；              N

  ID           String     事务ID；                              Y
  ------------ ---------- ------------------------------------- ----------

成功示例：{\"respCode\":0,\"ID\":\"12345678\"}

失败示例：{\"respCode\":-1,\"respCont \":\"Fail\",\"ID\":\"12345678\"}

## 事件上报接口 {#事件上报接口 .QB标题4}

接口内容：除了上线、认证、心跳外，设备主动上报的其他信息都通过本接口上报

请求类型：组网终端-\>省级数字家庭管理平台

## 请求 {#请求-11 .QB标题5}

表7.2-13 事件上报请求

+---------+------+-------------------------------------------+--------+
| 参数名  | 类型 | 描述                                      | 是     |
|         |      |                                           | 否必须 |
+=========+======+===========================================+========+
| RP      | St   | 命令字，取值"data"                        | Y      |
| CMethod | ring |                                           |        |
+---------+------+-------------------------------------------+--------+
| MAC     | St   | 组网终端铭牌MAC地址                       | Y      |
|         | ring |                                           |        |
+---------+------+-------------------------------------------+--------+
| ev      | St   | 事件类型，枚举取值：                      | Y      |
| entType | ring |                                           |        |
|         |      | FILE：设                                  |        |
|         |      | 备进行文件操作后触发，至少上报文件传输完  |        |
|         |      | 成、版本升级完成等状态，状态详见附录C-1； |        |
+---------+------+-------------------------------------------+--------+
| ti      | Nu   | 时间戳，单位：毫秒                        | Y      |
| mestamp | mber |                                           |        |
+---------+------+-------------------------------------------+--------+
| data    | Ob   | 解析数据包，FILE事件对应的扩展信息；      | Y      |
|         | ject |                                           |        |
|         |      | FILE事件对应的扩展信息（附录C-1）；       |        |
+---------+------+-------------------------------------------+--------+

示例：

{\"RPCMethod\":\"data\",\"MAC\":\"xxxxxxxx\",\"eventType\":\"FILE\",\"timestamp\":1590274859154,\"data\":{\"respCode\":2002}}

## 响应 {#响应-11 .QB标题5}

表7.2-14 事件上报响应

  --------------------------------------------------------------------------
  参数名      类型     描述                                       是否必须
  ----------- -------- ------------------------------------------ ----------
  respCode    Number   响应码， 0为成功，详见附录B                Y

  respCont    String   接口调用失败时的返回值；                   N
  --------------------------------------------------------------------------

成功示例：{\"respCode\":0}

失败示例：{\"respCode\":1001,\"respCont \":\"XXXXXX\"}

## 周期/上电上报接口 {#周期上电上报接口 .QB标题4}

接口内容：数据采集周期/上电上报的信息都通过HTTPS
POST的方式上报到省级数字家庭管理平台；

> 请求类型：组网终端-\>省级数字家庭管理平台
>
> 请求url：https://SoftProbeServer/rest/softprobe/periodic-message/xxxxxxx
>
> 请求头：Content-Type: application/json
>
> Accept-Charset: utf-8
>
> 注：SoftProbeServer省平台探针模块地址由
> 7.2.2.2.2设备认证接口响应字段提供；

## 请求 {#请求-12 .QB标题5}

表7.2-15 周期上报请求

  ----------------------------------------------------------------------------------------------------------------
  参数名      类型     描述                                                                             是否必须
  ----------- -------- -------------------------------------------------------------------------------- ----------
  MAC         String   组网终端铭牌MAC地址                                                              Y

  timestamp   Number   时间戳，单位：毫秒                                                               Y

  data        Object   解析的数据包，不同的data对应不同的扩展信息，详见7.2.2.7.3周期/上电上报数据类型   Y
  ----------------------------------------------------------------------------------------------------------------

示例：{\"MAC\":\"xxxxxxxx\",\"timestamp\":1590274859154,\"data\":{}}

## 响应 {#响应-12 .QB标题5}

表7.2-16 周期上报响应

  --------------------------------------------------------------------------
  参数名     类型     描述                                        是否必须
  ---------- -------- ------------------------------------------- ----------
  respCode   Number   响应码， 0为成功，详见附录B                 Y

  respCont   String   接口调用失败时的返回值；                    N
  --------------------------------------------------------------------------

成功示例：{\"respCode\":0}

失败示例：{\"respCode\":1001,\"respCont\":\"XXXXX\"}

## 周期/上电上报数据类型 {#周期上电上报数据类型 .QB标题5}

扩展事件上报周期和上报开关由7.2.2.8.9设备信息周期/上电上报配置和7.2.2.8.10业务监测信息周期上报配置接口下发，周期/上电上报数据内容如下表7.2-17所示。

表7.2-17 周期上报数据类型表

  --------------------------------- -------------------------------------
  周期上报data                      功能说明

  UplinkStatus                      设备上行状态

  STAInfo                           下挂设备上报信息

  WiFiStatus                        Wi-Fi状态上报信息

  ServiceDataInfo                   业务监测数据上报信息

  WlanNeighbor                      周边Wi-Fi上报信息
  --------------------------------- -------------------------------------

## 上联状态周期上报 {#上联状态周期上报 .QB标题6}

设备上联状态上报url：https://SoftProbeServer/rest/softprobe/periodic-message/uplinkStatus

设备上联状态信息根据配置周期上报或者通过查询后实时上报，默认周期上报开启。

表7.2-18 上联状态周期上报data

+----------------+------+--------------------------------------+------+
| 参数名         | 类型 | 描述                                 | 是否 |
|                |      |                                      | 必须 |
+================+======+======================================+======+
| UplinkType     | St   | 当前的上行                           | Y    |
|                | ring | 接入方式，采用枚举取值，取值范围为： |      |
|                |      |                                      |      |
|                |      | WLAN、Ethernet、PLC、Cable、Optical  |      |
|                |      | Ethernet、GPON、XGPON、XGSPON、PoE   |      |
+----------------+------+--------------------------------------+------+
| WorkingMode    | Nu   | AP工作模式：                         | Y    |
|                | mber |                                      |      |
|                |      | 0：桥接                              |      |
|                |      |                                      |      |
|                |      | 1：路由                              |      |
|                |      |                                      |      |
|                |      | 2：中继                              |      |
+----------------+------+--------------------------------------+------+
| RunningTime    | St   | 设备运行时长，时间单位：秒           | Y    |
|                | ring |                                      |      |
+----------------+------+--------------------------------------+------+
| CP             | Nu   | CPU占用率，0-100                     | Y    |
| UOccupancyRate | mber |                                      |      |
+----------------+------+--------------------------------------+------+
| CPUTemperature | Nu   | 单位为℃，取值为整数                  | N    |
|                | mber |                                      |      |
+----------------+------+--------------------------------------+------+
| Ra             | Nu   | RAM占用率，0-100                     | Y    |
| mOccupancyRate | mber |                                      |      |
+----------------+------+--------------------------------------+------+
| ipAddress      | St   | 组网终端IPv4地址                     | N    |
|                | ring |                                      |      |
+----------------+------+--------------------------------------+------+
| IPv6Status     | Nu   | 组                                   | N    |
|                | mber | 网终端IPv4/IPv6双栈状态，枚举取值；  |      |
|                |      |                                      |      |
|                |      | 0：关闭IPv4/IPv6双栈                 |      |
|                |      |                                      |      |
|                |      | 1：开启IPv4/IPv6双栈                 |      |
+----------------+------+--------------------------------------+------+
| IPv6IPAddress  | St   | 组网终端IPv6地址                     | N    |
|                | ring |                                      |      |
+----------------+------+--------------------------------------+------+
| apUplinkMac    | St   | 上联网元Mac，非PPPoE拨号时必选       | N    |
|                | ring |                                      |      |
+----------------+------+--------------------------------------+------+
| LockNetStatus  | Nu   | 锁网状态标识，枚举取值；             | N    |
|                | mber |                                      |      |
|                |      | 1为锁网，0为不锁网                   |      |
+----------------+------+--------------------------------------+------+
| userBind       | Nu   | 组                                   | N    |
|                | mber | 网终端用户绑定状态，0未绑定，1绑定； |      |
+----------------+------+--------------------------------------+------+
| Radio          | St   | WLAN上联时使用的频段，取值2.4G或5G   | N    |
|                | ring |                                      |      |
+----------------+------+--------------------------------------+------+
| SSID           | St   | WLAN上联时接入的SSID名称             | N    |
|                | ring |                                      |      |
+----------------+------+--------------------------------------+------+
| Channel        | St   | WLAN上联时的工作信道号，如存在多     | N    |
|                | ring | 个信道，可用","逗号分隔，例如："1,6" |      |
+----------------+------+--------------------------------------+------+
| Noise          | St   | WLAN上联时的噪声强度，单位dBm        | N    |
|                | ring |                                      |      |
+----------------+------+--------------------------------------+------+
| SNR            | St   | WLAN上联时的信噪比，单位dBm          | N    |
|                | ring |                                      |      |
+----------------+------+--------------------------------------+------+
| RSSI           | St   | WLAN上联时上联信号强度，单位为dBm    | N    |
|                | ring |                                      |      |
+----------------+------+--------------------------------------+------+
| ~~             | ~~   | ~~光口上联时发射光                   | ~    |
| FiberTXPower~~ | Stri | 功率，单位dBm；上行光接入时必选；~~  | ~N~~ |
|                | ng~~ |                                      |      |
+----------------+------+--------------------------------------+------+
| ~~             | ~~   | ~~光口上联时接收光                   | ~    |
| FiberRXPower~~ | Stri | 功率，单位dBm；上行光接入时必选；~~  | ~N~~ |
|                | ng~~ |                                      |      |
+----------------+------+--------------------------------------+------+
| RxRate         | St   | 上行协商接收速率，单位Mbps           | Y    |
|                | ring |                                      |      |
+----------------+------+--------------------------------------+------+
| TxRate         | St   | 上行协商发送速率，单位Mbps           | Y    |
|                | ring |                                      |      |
+----------------+------+--------------------------------------+------+
| AverRxRate     | St   | 上行实时接收速率周期均值，单位Mbps   | Y    |
|                | ring |                                      |      |
+----------------+------+--------------------------------------+------+
| AverTxRate     | St   | 上行实时发送速率周期均值，单位Mbps   | Y    |
|                | ring |                                      |      |
+----------------+------+--------------------------------------+------+
| MaxRxRate      | St   | 上行实现接收速率周期最大值，单位Mbps | Y    |
|                | ring |                                      |      |
+----------------+------+--------------------------------------+------+
| MaxTxRate      | St   | 上行实时发送速率周期最大值，单位Mbps | Y    |
|                | ring |                                      |      |
+----------------+------+--------------------------------------+------+

> 请求示例：

{\"MAC\":\"xxxxxxxx\",\"timestamp\":1590274859154,\"data\":{\"UplinkType\":\"WLAN\",\"WorkingMode\":2,\"RunningTime\":\"100\",\"CPUOccupancyRate\":\"30\",\"RamOccupancyRate\":\"50\",\"ipAddress\":\"192.168.10.1\",\"IPv6Status\":1,\"IPv6IPAddress\":\"1050:0:0:0:5:600:300c:326b\",\"apUplinkMac\":\"\*\*\*\*\*\*\*\*\*\*\",\"LockNetStatus\":0,\"userBind\":1,\"Radio\":\"2.4G\",\"SSID\":\"CMCC-12345\",\"Channel\":\"\*\",\"Noise\":\"-80\",\"SNR\":\"35\",\"RSSI\":\"-55\",\"RxRate\":\"100\",\"TxRate\":\"100\",\"AverRXRate\":\"100\",\"AverTXRate\":\"100\",\"MaxRXRate\":\"100\",\"MaxTXRate\":\"100\"}}

## 下挂设备信息周期上报 {#下挂设备信息周期上报 .QB标题6}

下挂设备信息上报url：https://SoftProbeServer/rest/softprobe/periodic-message/staInfo

设备下挂信息根据配置周期上报或者通过查询后实时上报，默认周期上报开启。

表7.2-19 下挂设备信息周期上报data

+---------------+------+--------------------------------------+------+
| 参数名        | 类型 | 描述                                 | 是否 |
|               |      |                                      | 必须 |
+---------------+------+--------------------------------------+------+
| T             | Long | 总发送字节数（上行口数据）           | N    |
| otalBytesSent |      |                                      |      |
+---------------+------+--------------------------------------+------+
| Total         | Long | 总接收字节数（上行口数据）           | N    |
| BytesReceived |      |                                      |      |
+---------------+------+--------------------------------------+------+
| Tot           | Long | 总发送包数（上行口数据）             | N    |
| alPacketsSent |      |                                      |      |
+---------------+------+--------------------------------------+------+
| TotalPa       | Long | 总接收包数（上行口数据）             | N    |
| cketsReceived |      |                                      |      |
+---------------+------+--------------------------------------+------+
| ErrorsSent    | Long | 发送出错的包数（上行口数据）         | N    |
+---------------+------+--------------------------------------+------+
| E             | Long | 接收的错误包数（上行口数据）         | N    |
| rrorsReceived |      |                                      |      |
+---------------+------+--------------------------------------+------+
| Disca         | Long | 发送时丢弃的包数（上行口数据）       | N    |
| rdPacketsSent |      |                                      |      |
+---------------+------+--------------------------------------+------+
| DiscardPa     | Long | 接收时丢弃的包数（上行口数据）       | N    |
| cketsReceived |      |                                      |      |
+---------------+------+--------------------------------------+------+
| Ipv6T         | Long | IPv6总发送字节数（上行口数据）       | N    |
| otalBytesSent |      |                                      |      |
+---------------+------+--------------------------------------+------+
| Ipv6Total     | Long | IPv6总接收字节数（上行口数据）       | N    |
| BytesReceived |      |                                      |      |
+---------------+------+--------------------------------------+------+
| BytesSent2G   | Long | 2.4GHz频段发送字                     | N    |
|               |      | 节数（统计SSID-1及SSID-3的总字节数） |      |
+---------------+------+--------------------------------------+------+
| By            | Long | 2.4GHz频段接收字                     | N    |
| tesReceived2G |      | 节数（统计SSID-1及SSID-3的总字节数） |      |
+---------------+------+--------------------------------------+------+
| BytesSent5G   | Long | 5GHz频段发送字                       | N    |
|               |      | 节数（统计SSID-5及SSID-7的总字节数） |      |
+---------------+------+--------------------------------------+------+
| By            | Long | 5GHz频段接收字                       | N    |
| tesReceived5G |      | 节数（统计SSID-5及SSID-7的总字节数） |      |
+---------------+------+--------------------------------------+------+
| BytesSent5G2  | Long | 5G-2频段发送字节数                   | N    |
|               |      | （统计SSID-9及SSID-11的总字节数）；  |      |
|               |      |                                      |      |
|               |      | 注：对于三频设备，该字段必选；       |      |
|               |      | 5GHz频段表示5.1G频段，5G-2表         |      |
|               |      | 示5.8G频段；双频终端无需上报该字段； |      |
+---------------+------+--------------------------------------+------+
| Byt           | Long | 5G-2频段接收字节                     | N    |
| esReceived5G2 |      | 数（统计SSID-9及SSID-11的总字节数）  |      |
|               |      |                                      |      |
|               |      | 注：对于三频设备，该字段必选；       |      |
|               |      | 5GHz频段表示5.1G频段，5G-2表         |      |
|               |      | 示5.8G频段；双频终端无需上报该字段； |      |
+---------------+------+--------------------------------------+------+
| STANumber     | Nu   | 下挂设                               | Y    |
|               | mber | 备数据，当值为0时，设备信息数组为空  |      |
+---------------+------+--------------------------------------+------+
| Devices       | A    | 连接                                 | N    |
|               | rray | 的设备信息数组，下挂设备数非零时必选 |      |
+---------------+------+--------------------------------------+------+
| IPAddress     | St   | 下挂设备的内                         | N    |
|               | ring | 网地址；该字段在下挂设备数非零时必选 |      |
+---------------+------+--------------------------------------+------+
| STA           | St   | 下挂设备的IPv6地址；该字             | N    |
| IPv6IPAddress | ring | 段在下挂设备数非零，且支持IPv6时必选 |      |
+---------------+------+--------------------------------------+------+
| HostName      | St   | 下挂设备的Ho                         | N    |
|               | ring | stName；该字段在下挂设备数非零时必选 |      |
+---------------+------+--------------------------------------+------+
| MacAddress    | St   | 下挂                                 | N    |
|               | ring | 设备MAC地址，格式为不带冒号且大写；  |      |
|               |      |                                      |      |
|               |      | 该字段在下挂设备数非零时必选         |      |
+---------------+------+--------------------------------------+------+
| VMacAddress   | St   | 下挂设备的虚拟MAC，如果未转          | N    |
|               | ring | 换，则和真实MAC一致。格式为不带冒号  |      |
|               |      | 且大写；该字段在下挂设备数非零时必选 |      |
+---------------+------+--------------------------------------+------+
| STAType       | St   | 下挂设备类型，枚举                   | N    |
|               | ring | 方式；该字段在下挂设备数非零时必选； |      |
|               |      |                                      |      |
|               |      | PC、                                 |      |
|               |      | Phone、TV、Router、IoT、IPC、others  |      |
+---------------+------+--------------------------------------+------+
| UpTime        | St   | 已连接时间，单                       | N    |
|               | ring | 位：秒；该字段在下挂设备数非零时必选 |      |
+---------------+------+--------------------------------------+------+
| Co            | Nu   | 下挂设备连接协议，枚举               | N    |
| nnectProtocol | mber | 取值，下挂设备通过Wi-Fi连接时必选；  |      |
|               |      |                                      |      |
|               |      | 0：非Wi-Fi接入                       |      |
|               |      |                                      |      |
|               |      | 1：11a或11b                          |      |
|               |      |                                      |      |
|               |      | 2：11g                               |      |
|               |      |                                      |      |
|               |      | 3：11n                               |      |
|               |      |                                      |      |
|               |      | 4：11ac                              |      |
|               |      |                                      |      |
|               |      | 5：11ax                              |      |
+---------------+------+--------------------------------------+------+
| Radio         | St   | WLAN下挂设备的接入频段，取值         | N    |
|               | ring | 2.4G、5G或5G-2，对非WLAN下挂设备应填 |      |
|               |      | 空值；该字段在下挂设备数非零时必选;  |      |
|               |      |                                      |      |
|               |      | 注                                   |      |
|               |      | ：对于三频设备，5G表示5.8G频段，5G-2 |      |
|               |      | 表示5.2G频段；双频设备忽略5G-2频段； |      |
+---------------+------+--------------------------------------+------+
| SSID          | St   | WLAN下挂                             | N    |
|               | ring | 设备的接入SSID名称，非WLAN下挂设备应 |      |
|               |      | 填空值；该字段在下挂设备数非零时必选 |      |
+---------------+------+--------------------------------------+------+
| RSSI          | St   | WLAN下挂设备当前的信号               | N    |
|               | ring | 强度，单位：dBm，对非WLAN下挂设备应  |      |
|               |      | 填空值；该字段在下挂设备数非零时必选 |      |
+---------------+------+--------------------------------------+------+
| RxRate        | St   | 下挂设备协商接                       | N    |
|               | ring | 收速率；该字段在下挂设备数非零时必选 |      |
+---------------+------+--------------------------------------+------+
| TxRate        | St   | 下挂设备协商发                       | N    |
|               | ring | 送速率；该字段在下挂设备数非零时必选 |      |
+---------------+------+--------------------------------------+------+
| AverRxRate    | St   | 下                                   | N    |
|               | ring | 挂设备接收流量周期均值，单位：Mbps； |      |
|               |      |                                      |      |
|               |      | 该字段在下挂设备数非零时必选         |      |
+---------------+------+--------------------------------------+------+
| AverTxRate    | St   | 下                                   | N    |
|               | ring | 挂设备发送流量周期均值，单位：Mbps； |      |
|               |      |                                      |      |
|               |      | 该字段在下挂设备数非零时必选         |      |
+---------------+------+--------------------------------------+------+
| MaxRxRate     | St   | 下挂                                 | N    |
|               | ring | 设备接收流量周期最大值，单位：Mbps； |      |
|               |      |                                      |      |
|               |      | 该字段在下挂设备数非零时必选         |      |
+---------------+------+--------------------------------------+------+
| MaxTxRate     | St   | 下挂                                 | N    |
|               | ring | 设备发送流量周期最大值，单位：Mbps； |      |
|               |      |                                      |      |
|               |      | 该字段在下挂设备数非零时必选         |      |
+---------------+------+--------------------------------------+------+
| BytesSent     | Long | 下挂设备发送字节数,                  | N    |
|               |      | 该字段在下挂设备数非零时必选         |      |
+---------------+------+--------------------------------------+------+
| BytesReceived | Long | 下挂设备接收字节数,                  | N    |
|               |      | 该字段在下挂设备数非零时必选         |      |
+---------------+------+--------------------------------------+------+

> 请求示例：
>
> {\"MAC\":\"xxxxxxxx\",\"timestamp\":1590274859154,\"data\":{\"TotalBytesSent\":232343040,\"TotalBytesReceived\":232456790,\"TotalPacketsSent\":346870,\"TotalPacketsReceived\":457321,\"ErrorsSent\":21,\"ErrorsReceived\":0,\"DiscardPacketsSent\":0,\"DiscardPacketsReceived\":0,\"Ipv6TotalBytesSent\":2323430,\"Ipv6TotalBytesReceived\":2324560,\"BytesSent2G\":346870,\"BytesReceived2G\":457321,\"BytesSent5G\":132343040,\"BytesReceived5G\":132456790,\"BytesSent5G2\":0,\"BytesReceived5G2\":0,\"STANumber\":2,\"Devices\":\[{\"IPAddress\":\"192.168.10.1\",\"STAIPv6IPAddress\":\"2001:DA8:1000::F1\",\"HostName\":\"AP1\",\"MacAddress\":\"012233445566\",\"VMacAddress\":\"012233445566\",\"STAType\":\"Phone\",\"UpTime\":\"100\",\"ConnectProtocol\":5,\"Radio\":\"2.4G\",\"SSID\":\"CMCC-12345\",\"RSSI\":\"-55\",\"RxRate\":\"1000\",\"TxRate\":\"1000\",\"AverRxRate\":\"100\",\"AverTxRate\":\"100\",\"MaxRxRate\":\"150\",\"MaxTxRate\":\"150\",\"BytesSent\":23234,\"BytesReceived\":232},{\"IPAddress\":\"192.168.10.3\",\"STAIPv6IPAddress\":\"2001:DA8:1000::F2\",\"HostName\":\"AP2\",\"MacAddress\":\"012233445566\",\"VMacAddress\":\"012233445566\",\"STAType\":\"PC\",\"UpTime\":\"100\",\"ConnectProtocol\":5,\"Radio\":\"5G\",\"SSID\":\"CMCC-12345-5G\",\"RSSI\":\"-55\",\"RxRate\":\"1000\",\"TxRate\":\"1000\",\"AverRXRate\":\"100\",\"AverTxRate\":\"100\",\"MaxRXRate\":\"150\",\"MaxTxRate\":\"150\",\"BytesSent\":23234,\"BytesReceived\":232}\]}}

## Wi-Fi状态周期上报 {#wi-fi状态周期上报 .QB标题6}

> Wi-Fi状态上报url：https://SoftProbeServer/rest/softprobe/periodic-message/WiFiStatus；
>
> 设备Wi-Fi状态信息根据配置周期上报或者通过查询后实时上报，默认周期上报开启。

表7.2-20 Wi-Fi状态周期上报data

+-------------+-------+--------------------------------------+--------+
| 参数名      | 类型  | 描述                                 | 是     |
|             |       |                                      | 否必须 |
+-------------+-------+--------------------------------------+--------+
| Radios      | Array | Wi-Fi射频信息的数组；                | Y      |
|             |       |                                      |        |
|             |       | 包含以下字段：Radio，Enable，T       |        |
|             |       | ransmitPower，Channel，Bandwidth字段 |        |
+-------------+-------+--------------------------------------+--------+
| Radio       | S     | Radios数组之一，频段，枚举取值：     | Y      |
|             | tring |                                      |        |
|             |       | 2.4G                                 |        |
|             |       |                                      |        |
|             |       | 5G                                   |        |
|             |       |                                      |        |
|             |       | 5G-2                                 |        |
|             |       |                                      |        |
|             |       | 注                                   |        |
|             |       | ：对于三频设备，5G表示5.1G频段，5G-2 |        |
|             |       | 表示5.8G频段；双频设备忽略5G-2频段； |        |
+-------------+-------+--------------------------------------+--------+
| Enable      | N     | 频段                                 | Y      |
|             | umber | 是否启用，枚举取值；1为启用，0为禁用 |        |
+-------------+-------+--------------------------------------+--------+
| Tr          | S     | Wi-Fi发射功率级别（百分比）          | Y      |
| ansmitPower | tring |                                      |        |
+-------------+-------+--------------------------------------+--------+
| Channel     | S     | 当前工作信道号，若存在多             | Y      |
|             | tring | 个信道，可用","逗号分隔，例如："1,6" |        |
+-------------+-------+--------------------------------------+--------+
| LoadRate    | N     | 当                                   | N      |
|             | umber | 前信道使用率（%），数据范围：0-100； |        |
|             |       |                                      |        |
|             |       | 说明                                 |        |
|             |       | ：应包含自身数据收发和周边干扰之和； |        |
+-------------+-------+--------------------------------------+--------+
| Bandwidth   | N     | 当前Wi-Fi频宽，采用枚举取值：        | N      |
|             | umber |                                      |        |
|             |       | 0：自动频宽                          |        |
|             |       |                                      |        |
|             |       | 1：20MHz                             |        |
|             |       |                                      |        |
|             |       | 2：40MHz                             |        |
|             |       |                                      |        |
|             |       | 3：80MHz                             |        |
|             |       |                                      |        |
|             |       | 4：160MHz                            |        |
|             |       |                                      |        |
|             |       | 5：80+80MHz                          |        |
|             |       |                                      |        |
|             |       | 说明：对于2.4G频段，自动             |        |
|             |       | 频宽功能为20/40MHz频宽自适应；对于5G |        |
|             |       | 频段，自动频宽功能包含20/40/80/160MH |        |
|             |       | z频宽自适应或20/40/80MHz频宽自适应； |        |
+-------------+-------+--------------------------------------+--------+
| Con         | Array | Wi-Fi信息的数组                      | Y      |
| figurations |       |                                      |        |
+-------------+-------+--------------------------------------+--------+
| Radio       | S     | 频段，枚举取值：                     | Y      |
|             | tring |                                      |        |
|             |       | 2.4G                                 |        |
|             |       |                                      |        |
|             |       | 5G                                   |        |
|             |       |                                      |        |
|             |       | 5G-2                                 |        |
|             |       |                                      |        |
|             |       | 注                                   |        |
|             |       | ：对于三频设备，5G表示5.1G频段，5G-2 |        |
|             |       | 表示5.8G频段；双频设备忽略5G-2频段； |        |
+-------------+-------+--------------------------------------+--------+
| Index       | N     | SSID索引号                           | Y      |
|             | umber |                                      |        |
+-------------+-------+--------------------------------------+--------+
| Enable      | N     | 是否启用，枚举取值；1为启用，0为禁用 | Y      |
|             | umber |                                      |        |
+-------------+-------+--------------------------------------+--------+
| SSID        | S     | SSID名称                             | Y      |
|             | tring |                                      |        |
+-------------+-------+--------------------------------------+--------+
| S           | S     | 认证加密模式，枚举取值：             | Y      |
| ecurityMode | tring |                                      |        |
|             |       | None                                 |        |
|             |       |                                      |        |
|             |       | WEP-64                               |        |
|             |       |                                      |        |
|             |       | WEP-128                              |        |
|             |       |                                      |        |
|             |       | WPA-Personal                         |        |
|             |       |                                      |        |
|             |       | WPA2-Personal                        |        |
|             |       |                                      |        |
|             |       | MIXED-WPAPSK2                        |        |
|             |       |                                      |        |
|             |       | WPA3-SAE                             |        |
|             |       |                                      |        |
|             |       | MIXED-WPA2WPA3                       |        |
+-------------+-------+--------------------------------------+--------+
| Encrypt     | N     | 加密算法，枚举取值：                 | N      |
|             | umber |                                      |        |
|             |       | 0：None:                             |        |
|             |       |                                      |        |
|             |       | 1：AES                               |        |
|             |       |                                      |        |
|             |       | 2：TKIP                              |        |
|             |       |                                      |        |
|             |       | 3：AES+TKIP                          |        |
+-------------+-------+--------------------------------------+--------+
| Pwd         | S     | Wi-Fi密钥，WEP Key或Pre-shared       | Y      |
|             | tring | Key，管理平台不应存储和显示此参数。  |        |
+-------------+-------+--------------------------------------+--------+
| MaxA        | N     | 该S                                  | Y      |
| ssociateNum | umber | SID最大允许接入的用户数，0表示不限制 |        |
+-------------+-------+--------------------------------------+--------+
| SS          | N     | 是否广                               | Y      |
| IDAdvertise | umber | 播SSID，枚举取值；1为广播，0为不广播 |        |
| mentEnabled |       |                                      |        |
+-------------+-------+--------------------------------------+--------+
| S           | S     | WLAN口支持的无线传输标准，枚举取值:  | N      |
| SIDStandard | tring |                                      |        |
|             |       | 11b/g                                |        |
|             |       |                                      |        |
|             |       | 11b/g/n                              |        |
|             |       |                                      |        |
|             |       | 11b/g/n/ax                           |        |
|             |       |                                      |        |
|             |       | 11a/n/ac/ax                          |        |
|             |       |                                      |        |
|             |       | 11a/n/ac                             |        |
|             |       |                                      |        |
|             |       | 11a/n                                |        |
|             |       |                                      |        |
|             |       | 11n                                  |        |
|             |       |                                      |        |
|             |       | 11a                                  |        |
|             |       |                                      |        |
|             |       | 11b                                  |        |
|             |       |                                      |        |
|             |       | 11g                                  |        |
+-------------+-------+--------------------------------------+--------+

> 请求示例：
>
> {\"MAC\":\"xxxxxxxx\",\"timestamp\":1590274859154,\"data\":{\"Radios\":\[{\"Radio\":\"2.4G\",\"Enable\":1,\"TransmitPower\":\"100\",\"Channel\":\"1\",\"LoadRate\":10,\"Bandwidth\":1},{\"Radio\":\"5G\",\"Enable\":1,\"TransmitPower\":\"100\",\"Channel\":\"36\",\"LoadRate\":10,\"Bandwidth\":4}\],\"Configurations\":\[{\"Radio\":\"2.4G\",\"Index\":1,\"Enable\":1,\"SSID\":\"CMCC-2341\",\"SecurityMode\":\"MIXED-WPAPSK2\",\"Encrypt\":1,\"Pwd\":\"\*\*\*\*\*\*\*\",\"MaxAssociateNum\":64,\"SSIDAdvertisementEnabled\":1,\"SSIDStandard\":\"11b/g/n\"},{\"Radio\":\"5G\",\"Index\":5,\"Enable\":1,\"SSID\":\"CMCC-2341-5G\",\"SecurityMode\":\"MIXED-WPAPSK2\",\"Encrypt\":1,\"Pwd\":\"\*\*\*\*\*\*\*\",\"MaxAssociateNum\":64,\"SSIDAdvertisementEnabled\":1,\"SSIDStandard\":\"11a/n/ac/ax\"}\]}}

## 周边Wi-Fi信息上电上报 {#周边wi-fi信息上电上报 .QB标题6}

周边Wi-Fi信息上报url:https://SoftProbeServer/rest/softprobe/periodic-message/wlanNeighbor；

设备首次上电或重启时，查询周边Wi-Fi信息，并上报至平台；或通过平台查询后实时上报。

表7.2-21 周边Wi-Fi信息上电上报data

+---------+----------+---------------------------------------+--------+
| 参数名  | 类型     | 描述                                  | 是     |
|         |          |                                       | 否必须 |
+=========+==========+=======================================+========+
| Number  | Number   | 周边Wi-F                              | Y      |
|         |          | i数量，当值为0时，Wi-Fi信息数组为空； |        |
+---------+----------+---------------------------------------+--------+
| Radios  | Array    | 周边Wi-                               | N      |
|         |          | Fi信息数组，周边Wi-Fi数量非零时必选； |        |
+---------+----------+---------------------------------------+--------+
| Radio   | String   | 频段                                  | N      |
|         |          | ：2.4G、5G；周边Wi-Fi数量非零时必选； |        |
+---------+----------+---------------------------------------+--------+
| SSID    | String   | 周边Wi-Fi                             | N      |
|         |          | 的SSID名称；周边Wi-Fi数量非零时必选； |        |
+---------+----------+---------------------------------------+--------+
| Mac     | String   | 周边Wi-                               | N      |
| Address |          | Fi的MAC地址，格式为不带冒号并且大写； |        |
|         |          |                                       |        |
|         |          | 周边Wi-Fi数量非零时必选；             |        |
+---------+----------+---------------------------------------+--------+
| Channel | String   | 周边Wi-Fi信道                         | N      |
|         |          | ，如存在多个信道，可用","逗号分隔，例 |        |
|         |          | 如："1,6"；周边Wi-Fi数量非零时必选；  |        |
+---------+----------+---------------------------------------+--------+
| Ba      | Number   | 周边Wi-Fi频宽，采                     | N      |
| ndwidth |          | 用枚举取值：周边Wi-Fi数量非零时必选； |        |
|         |          |                                       |        |
|         |          | 1：20MHz                              |        |
|         |          |                                       |        |
|         |          | 2：40MHz                              |        |
|         |          |                                       |        |
|         |          | 3：80MHz                              |        |
|         |          |                                       |        |
|         |          | 4：160MHz                             |        |
|         |          |                                       |        |
|         |          | 5：80+80MHz                           |        |
|         |          |                                       |        |
|         |          | 0：自适应频宽                         |        |
+---------+----------+---------------------------------------+--------+
| RSSI    | String   | 周边Wi-Fi的信号强度，单位dBm；        | N      |
|         |          |                                       |        |
|         |          | 周边Wi-Fi数量非零时必选；             |        |
+---------+----------+---------------------------------------+--------+
| L       | Number   | 信道使用率（%），数据范围：0-100；    | N      |
| oadRate |          |                                       |        |
+---------+----------+---------------------------------------+--------+
| Wifis   | Number   | 周边Wi-Fi使用的无线标准，采           | N      |
| tandard |          | 用枚举取值：周边Wi-Fi数量非零时必选； |        |
|         |          |                                       |        |
|         |          | 0：:802.11a或802.11b                  |        |
|         |          |                                       |        |
|         |          | 1：802.11b/g                          |        |
|         |          |                                       |        |
|         |          | 2：802.11b/g/n                        |        |
|         |          |                                       |        |
|         |          | 3：802.11a/n/ac                       |        |
|         |          |                                       |        |
|         |          | 4：802.11b/g/n/ax                     |        |
|         |          |                                       |        |
|         |          | 5：802.11a/n/ac/ax                    |        |
|         |          |                                       |        |
|         |          | 6：802.11a/n                          |        |
|         |          |                                       |        |
|         |          | 7：802.11n                            |        |
|         |          |                                       |        |
|         |          | 8：802.11g                            |        |
|         |          |                                       |        |
|         |          | 9：802.11g/n                          |        |
+---------+----------+---------------------------------------+--------+

注：

① 当周边Wi-Fi数量超过24时，按RSSI信号强度从大到小上报24个周边Wi-Fi信息；

② 设备上电时，AP默认执行全信道扫描，获取所有信道周边干扰数据；

③ 平台开启周边Wi-Fi
周期上报功能时，仅需获取工作信道周边Wi-Fi数据，并上报到平台；

> 请求示例：

{\"MAC\":\"xxxxxxxx\",\"timestamp\":1590274859154,\"data\":{\"Number\":2,\"Radios\":\[{\"Radio\":\"2.4G\",\"SSID\":\"CMCC-1234\",\"MacAddress\":\"0A2233445568\",\"Channel\":\"1\",\"Bandwidth\":\"1\",\"RSSI\":\"-60\",\"LoadRate\":50,\"Wifistandard\":\"2\"},{\"Radio\":\"5G\",\"SSID\":\"CMCC-1234\",\"MacAddress\":\"0B2233445566\",\"Channel\":\"36\",\"Bandwidth\":\"4\",\"RSSI\":\"-60\",\"LoadRate\":10,\"Wifistandard\":\"4\"}\]}}

## 业务监测数据周期上报 {#业务监测数据周期上报 .QB标题6}

业务监测数据上报url:https://SoftProbeServer/rest/softprobe/periodic-message/serviceDataInfo。

业务监测信息根据配置周期采集上报，默认周期上报关闭。

表7.2-22 业务监测数据周期上报data

+----------------+-------+------------------------------------+-------+
| 参数名         | 类型  | 描述                               | 是否  |
|                |       |                                    | 必须  |
+================+=======+====================================+=======+
| ServiceNumber  | N     | 监测的业务数量                     | Y     |
|                | umber |                                    |       |
+----------------+-------+------------------------------------+-------+
| S              | Array | 业务监测                           | Y     |
| erviceBaseInfo |       | 信息数组，业务监测数量不为0时有效  |       |
+----------------+-------+------------------------------------+-------+
| MacEntries     | S     | 发起业务终端设备MAC，MAC格式为不带 | Y     |
|                | tring | 冒号并且大写，不同组用","逗号分开  |       |
|                |       | ，例如：001111334455,80717A33CCF3  |       |
+----------------+-------+------------------------------------+-------+
| StartTime      | S     | 发起业务时间：年-月-日             | Y     |
|                | tring | 时：分：秒，格式如:2020-01-19      |       |
|                |       | 17:33:26                           |       |
+----------------+-------+------------------------------------+-------+
| RunningTime    | S     | 业务使用时间，单位：秒；           | Y     |
|                | tring |                                    |       |
+----------------+-------+------------------------------------+-------+
| URL            | S     | 业务URL                            | Y     |
|                | tring |                                    |       |
+----------------+-------+------------------------------------+-------+
| Protocol       | S     | 业务协议类型如:TCP                 | Y     |
|                | tring |                                    |       |
+----------------+-------+------------------------------------+-------+
| AverTxRate     | S     | 业务发送速率周期均值，单位：Mbps   | Y     |
|                | tring |                                    |       |
+----------------+-------+------------------------------------+-------+
| AverRxRate     | S     | 业务接收速率周期均值，单位：Mbps   | Y     |
|                | tring |                                    |       |
+----------------+-------+------------------------------------+-------+
| MaxTxRate      | S     | 业务发送速率周期最大值，单位：Mbps | Y     |
|                | tring |                                    |       |
+----------------+-------+------------------------------------+-------+
| MaxRxRate      | S     | 业务接收速率周期最大值，单位：Mbps | Y     |
|                | tring |                                    |       |
+----------------+-------+------------------------------------+-------+
| UpStaticstics  | N     | 该业务上行流量统计，单位byte(字节) | Y     |
|                | umber |                                    |       |
+----------------+-------+------------------------------------+-------+
| D              | N     | 该                                 | Y     |
| ownStaticstics | umber | 业务下行流量统计，单位byte（字节） |       |
+----------------+-------+------------------------------------+-------+
| T              | N     | TCP连接次                          | N     |
| cpConnectTimes | umber | 数；当TCP连接信息开关开启时必选；  |       |
+----------------+-------+------------------------------------+-------+
| TcpSucessTimes | N     | TCP连接成功次                      | N     |
|                | umber | 数；当TCP连接信息开关开启时必选；  |       |
+----------------+-------+------------------------------------+-------+
| TcpAvgTime     | N     | TCP建立连接平均时长，单位：毫秒；  | N     |
|                | umber |                                    |       |
|                |       | 当TCP连接信息开关开启时必选；      |       |
+----------------+-------+------------------------------------+-------+
| Tc             | N     | TCP建立连接重传率，TCP重传率 =     | N     |
| pReconnectRate | umber | TCP重传次数/TCP交互总次数；        |       |
|                |       | TCP连接信息开关开启时必选；        |       |
+----------------+-------+------------------------------------+-------+
| Htt            | N     | http响应时延，单位：毫秒；         | N     |
| pResponseDelay | umber |                                    |       |
|                |       | 当TCP连接信息开关开启时必选；      |       |
+----------------+-------+------------------------------------+-------+
| HttpRe         | S     | http请求错误码                     | N     |
| questErrorList | tring | ，周期内失败错识码列表，中间逗号间 |       |
|                |       | 隔"203,204"，如无失败为"200"或者"  |       |
|                |       | "空；                              |       |
|                |       |                                    |       |
|                |       | 当TCP连接信息开关开启时必选；      |       |
+----------------+-------+------------------------------------+-------+
| Ht             | N     | http请求次                         | N     |
| tpRequestTimes | umber | 数；当TCP连接信息开关开启时必选；  |       |
+----------------+-------+------------------------------------+-------+
| HttpRe         | N     | http请求失败次                     | N     |
| questFailTimes | umber | 数；当TCP连接信息开关开启时必选；  |       |
+----------------+-------+------------------------------------+-------+
| DnsPars        | N     | DNS响应延时，单位：毫              | N     |
| eResponseDelay | umber | 秒；当TCP连接信息开关开启时必选；  |       |
+----------------+-------+------------------------------------+-------+

> 请求示例：

{\"MAC\":\"xxxxxxxx\",\"timestamp\":1590274859154,\"data\":{\"ServiceNumber\":1,\"ServiceBaseInfo\":\[{\"MacEntries\":\"0A2233445568\",\"StartTime\":\"2020-01-19
17:33:26\",\"RunningTime\":\"1000\",\"URL\":\"www.baidu.com\",\"Protocol\":\"TCP\",\"AverTxRate\":\"100\",\"AverRxRate\":\"100\",\"MaxTxRate\":\"-100\",\"MaxRxRate\":\"100\",\"UpStaticstics\":123456,\"DownStaticstics\":3456,\"TcpConnectTimes\":10,\"TcpSucessTimes\":9,\"TcpAvgTime\":10,\"TcpReconnectRate\":10,\"HttpResponseDelay\":5,\"HttpRequestErrorList\":\"203,204\",\"HttpRequestTimes\":10,\"HttpRequestFailTimes\":1,\"DnsParseResponseDelay\":3}\]}}

## 功能控制接口 {#功能控制接口 .QB标题4}

## Wi-Fi参数同步 {#wi-fi参数同步 .QB标题5}

接口说明：通过该消息将Wi-Fi参数配置下发给组网终端。

请求方向：省级数字家庭管理平台---\>组网终端

## 请求 {#请求-13 .QB标题6}

表7.2-23 Wi-Fi参数同步请求

+-------------+-------+--------------------------------------+--------+
| 参数名      | 类型  | 描述                                 | 是     |
|             |       |                                      | 否必须 |
+-------------+-------+--------------------------------------+--------+
| RPCMethod   | S     | 命令字，取值"WiFiParameterSync"      | Y      |
|             | tring |                                      |        |
+-------------+-------+--------------------------------------+--------+
| ID          | S     | 事务ID。                             | Y      |
|             | tring |                                      |        |
+-------------+-------+--------------------------------------+--------+
| data        | O     | 解析数据包                           | Y      |
|             | bject |                                      |        |
+-------------+-------+--------------------------------------+--------+
| Con         | Array | Wi-Fi                                | Y      |
| figurations |       | SSID配置的数组                       |        |
|             |       | ，包含Radio、Index、Enable、SSID、S  |        |
|             |       | ecurityMode、Encrypt、Pwd、MaxAssoci |        |
|             |       | ateNum、SSIDAdvertisementEnabled字段 |        |
+-------------+-------+--------------------------------------+--------+
| Radio       | S     | 待设置的频段，枚举取值：             | Y      |
|             | tring |                                      |        |
|             |       | 2.4G                                 |        |
|             |       |                                      |        |
|             |       | 5G                                   |        |
|             |       |                                      |        |
|             |       | 5G-2                                 |        |
|             |       |                                      |        |
|             |       | 注                                   |        |
|             |       | ：对于三频设备，5G表示5.1G频段，5G-2 |        |
|             |       | 表示5.8G频段；双频设备忽略5G-2频段； |        |
+-------------+-------+--------------------------------------+--------+
| Index       | N     | SSID的索引，2.                       | Y      |
|             | umber | 4G采用1-4，5G采用5-8，5G-2采用9-12； |        |
|             |       |                                      |        |
|             |       | 注：双频设备忽略5G-2频段；           |        |
+-------------+-------+--------------------------------------+--------+
| Enable      | N     | 是否启用，1为启用，0禁用             | Y      |
|             | umber |                                      |        |
+-------------+-------+--------------------------------------+--------+
| SSID        | S     | SSID名称                             | Y      |
|             | tring |                                      |        |
+-------------+-------+--------------------------------------+--------+
| S           | S     | 认证加密模式，枚举取值：             | Y      |
| ecurityMode | tring |                                      |        |
|             |       | None                                 |        |
|             |       |                                      |        |
|             |       | WEP-64                               |        |
|             |       |                                      |        |
|             |       | WEP-128                              |        |
|             |       |                                      |        |
|             |       | WPA-Personal                         |        |
|             |       |                                      |        |
|             |       | WPA2-Personal                        |        |
|             |       |                                      |        |
|             |       | MIXED-WPAPSK2                        |        |
|             |       |                                      |        |
|             |       | WPA3-SAE                             |        |
|             |       |                                      |        |
|             |       | MIXED-WPA2WPA3                       |        |
+-------------+-------+--------------------------------------+--------+
| Encrypt     | N     | 加密算法，枚举取值：                 | N      |
|             | umber |                                      |        |
|             |       | 0：None:                             |        |
|             |       |                                      |        |
|             |       | 1：AES                               |        |
|             |       |                                      |        |
|             |       | 2：TKIP                              |        |
|             |       |                                      |        |
|             |       | 3：AES+TKIP                          |        |
|             |       |                                      |        |
|             |       | 注                                   |        |
|             |       | ：该字段为空时，AP不应修改加密算法； |        |
+-------------+-------+--------------------------------------+--------+
| Pwd         | S     | Wi-Fi密钥，WEP Key或Pre-shared Key   | Y      |
|             | tring |                                      |        |
+-------------+-------+--------------------------------------+--------+
| MaxA        | N     | 该S                                  | Y      |
| ssociateNum | umber | SID最大允许接入的用户数，0表示不限制 |        |
+-------------+-------+--------------------------------------+--------+
| SS          | N     | 是否广播SSID，1为广播，0为不广播     | Y      |
| IDAdvertise | umber |                                      |        |
| mentEnabled |       |                                      |        |
+-------------+-------+--------------------------------------+--------+
| S           | S     | WLAN口支持的无线传输标准，枚举取值:  | N      |
| SIDStandard | tring |                                      |        |
|             |       | 11b/g                                |        |
|             |       |                                      |        |
|             |       | 11b/g/n                              |        |
|             |       |                                      |        |
|             |       | 11b/g/n/ax                           |        |
|             |       |                                      |        |
|             |       | 11a/n/ac/ax                          |        |
|             |       |                                      |        |
|             |       | 11a/n/ac                             |        |
|             |       |                                      |        |
|             |       | 11a/n                                |        |
|             |       |                                      |        |
|             |       | 11n                                  |        |
|             |       |                                      |        |
|             |       | 11a                                  |        |
|             |       |                                      |        |
|             |       | 11b                                  |        |
|             |       |                                      |        |
|             |       | 11g                                  |        |
+-------------+-------+--------------------------------------+--------+

示例：

{\"RPCMethod\":\"WiFiParameterSync\",\"ID\":\"xxxxxxxx\",\"data\":{\"Configurations\":\[{\"Radio\":\"2.4G\",\"Index\":1,\"Enable\":1,\"SSID\":\"CMCC-2341\",\"SecurityMode\":\"MIXED-WPAPSK2\",\"Encrypt\":1,\"Pwd\":\"XXXXXX\",\"MaxAssociateNum\":10,\"SSIDAdvertisementEnabled\":1,\"SSIDStandard\":\"11b/g/n\"},{\"Radio\":\"5G\",\"Index\":5,\"Enable\":1,\"SSID\":\"CMCC-2341-5G\",\"SecurityMode\":\"MIXED-WPAPSK2\",\"Encrypt\":1,\"Pwd\":\"XXXXXX\",\"MaxAssociateNum\":10,\"SSIDAdvertisementEnabled\":1,\"SSIDStandard\":\"11a/n/ac/ax\"}\]}}

## 响应 {#响应-13 .QB标题6}

表7.2-24 Wi-Fi参数同步响应

  ---------- --------- ------------------------------------------ ----------
  参数名     类型      描述                                       是否必须

  ID         String    事务ID。                                   Y

  respCode   Number    响应码， 0为成功，其余code见附录B；        Y

  respCont   String    接口调用失败时的返回值；                   N
  ---------- --------- ------------------------------------------ ----------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## Wi-Fi开关控制 {#wi-fi开关控制 .QB标题5}

接口说明：通过该消息控制组网终端用户侧的Wi-Fi开关。

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-14 .QB标题6}

表7.2-25 Wi-Fi开关控制请求

+----------+-------+-----------------------------------------+--------+
| 参数名   | 类型  | 描述                                    | 是     |
|          |       |                                         | 否必须 |
+==========+=======+=========================================+========+
| R        | S     | 命令字，取值"WiFiSwitch"                | Y      |
| PCMethod | tring |                                         |        |
+----------+-------+-----------------------------------------+--------+
| ID       | S     | 事务ID。                                | Y      |
|          | tring |                                         |        |
+----------+-------+-----------------------------------------+--------+
| data     | O     | 设备解析数据包                          | Y      |
|          | bject |                                         |        |
+----------+-------+-----------------------------------------+--------+
| Radio    | S     | 待设置的频段，枚举取值：                | Y      |
|          | tring |                                         |        |
|          |       | 2.4G                                    |        |
|          |       |                                         |        |
|          |       | 5G                                      |        |
|          |       |                                         |        |
|          |       | 5G-2                                    |        |
|          |       |                                         |        |
|          |       | all （代表所有频段）                    |        |
|          |       |                                         |        |
|          |       | 注：对于三频设备，5G表示5.1G频段，5     |        |
|          |       | G-2表示5.8G频段；双频设备忽略5G-2频段； |        |
+----------+-------+-----------------------------------------+--------+
| Enable   | N     | Wi-Fi开关是否打开：                     | Y      |
|          | umber |                                         |        |
|          |       | 0: 关闭Wi-Fi                            |        |
|          |       |                                         |        |
|          |       | 1: 打开Wi-Fi                            |        |
+----------+-------+-----------------------------------------+--------+

示例：{\"RPCMethod\":\" WiFiSwitch \",\"ID \":\"xxxxxxxx
\",\"data\":{\"Radio\":\"all\",\"Enable\":1}}

## 响应 {#响应-14 .QB标题6}

表7.2-26 Wi-Fi开关控制响应

  ---------------------------------------------------------------------------
  参数名     类型       描述                                       是否必须
  ---------- ---------- ------------------------------------------ ----------
  ID         String     事务ID。                                   Y

  respCode   Number     响应码， 0为成功，详见附录B                Y

  respCont   String     接口调用失败时的返回值；                   N
  ---------------------------------------------------------------------------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## Wi-Fi射频参数配置 {#wi-fi射频参数配置 .QB标题5}

接口说明：通过该消息调整组网终端的Wi-Fi射频参数配置。

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-15 .QB标题6}

表7.2-27 Wi-Fi射频参数配置请求

+----------+------+------------------------------------------+-------+
| 参数名   | 类型 | 描述                                     | 是否  |
|          |      |                                          | 必须  |
+==========+======+==========================================+=======+
| R        | St   | 命令字，取值"RadioConfig"                | Y     |
| PCMethod | ring |                                          |       |
+----------+------+------------------------------------------+-------+
| ID       | St   | 事务ID。                                 | Y     |
|          | ring |                                          |       |
+----------+------+------------------------------------------+-------+
| data     | Ob   | 设备解析数据包                           | Y     |
|          | ject |                                          |       |
+----------+------+------------------------------------------+-------+
| Radio    | St   | 待设置的频段，枚举取值：                 | Y     |
|          | ring |                                          |       |
|          |      | 2.4G                                     |       |
|          |      |                                          |       |
|          |      | 5G                                       |       |
|          |      |                                          |       |
|          |      | 5G-2                                     |       |
|          |      |                                          |       |
|          |      | 注：对于三频设备，5G表示5.1G频段，       |       |
|          |      | 5G-2表示5.8G频段；双频设备忽略5G-2频段； |       |
+----------+------+------------------------------------------+-------+
| Trans    | St   | Wi-Fi发射功率级别（百分比）              | Y     |
| mitPower | ring |                                          |       |
|          |      | 说明：穿墙→100；标准→60；节能→40；       |       |
+----------+------+------------------------------------------+-------+
| Channel  | St   | 工作信道，0代表自动信道；                | N     |
|          | ring |                                          |       |
+----------+------+------------------------------------------+-------+
| B        | Nu   | 当前Wi-Fi频宽，采用枚举取值：            | N     |
| andwidth | mber |                                          |       |
|          |      | 0：自动频宽                              |       |
|          |      |                                          |       |
|          |      | 1：20MHz                                 |       |
|          |      |                                          |       |
|          |      | 2：40MHz                                 |       |
|          |      |                                          |       |
|          |      | 3：80MHz                                 |       |
|          |      |                                          |       |
|          |      | 4：160MHz                                |       |
|          |      |                                          |       |
|          |      | 5：80+80MHz                              |       |
|          |      |                                          |       |
|          |      | 说明：对于2.4G频                         |       |
|          |      | 段，自动频宽功能为20/40MHz频宽自适应；对 |       |
|          |      | 于5G频段，自动频宽功能对应为20/40/80/16  |       |
|          |      | 0MHz（仅支持160MHz频宽终端）频宽自适应； |       |
+----------+------+------------------------------------------+-------+

示例：

{\"RPCMethod\":\"RadioConfig\",\"ID\":\"xxxxxxxx\",\"data\":{\"Radio\":\"2.4G\",\"TransmitPower\":\"70\",\"Channel\":\"1\",\"Bandwidth\":1}}

## 响应 {#响应-15 .QB标题6}

表7.2-28 Wi-Fi射频参数配置响应

  ---------- --------- ------------------------------------------- ----------
  参数名     类型      描述                                        是否必须

  ID         String    事务ID。                                    Y

  respCode   Number    响应码， 0为成功，详见附录B                 Y

  respCont   String    接口调用失败时的返回值；                    N
  ---------- --------- ------------------------------------------- ----------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## Wi-Fi WPS控制 {#wi-fi-wps控制 .QB标题5}

接口说明：通过该消息激活组网终端的WPS过程。

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-16 .QB标题6}

表7.2-29 Wi-Fi WPS控制请求

+--------+-------+------------------------------------------+--------+
| 参数名 | 类型  | 描述                                     | 是     |
|        |       |                                          | 否必须 |
+========+=======+==========================================+========+
| RPC    | S     | 命令字，取值"WPS"                        | Y      |
| Method | tring |                                          |        |
+--------+-------+------------------------------------------+--------+
| ID     | S     | 事务ID。                                 | Y      |
|        | tring |                                          |        |
+--------+-------+------------------------------------------+--------+
| data   | O     | 设备解析数据包                           | Y      |
|        | bject |                                          |        |
+--------+-------+------------------------------------------+--------+
| Radio  | S     | 触发WPS的频段，枚举取值：                | Y      |
|        | tring |                                          |        |
|        |       | 2.4G                                     |        |
|        |       |                                          |        |
|        |       | 5G                                       |        |
|        |       |                                          |        |
|        |       | 5G-2                                     |        |
|        |       |                                          |        |
|        |       | all （代表所有频段）                     |        |
|        |       |                                          |        |
|        |       | 注：对于三频设备，5G表示5.1G频段，       |        |
|        |       | 5G-2表示5.8G频段；双频设备忽略5G-2频段； |        |
+--------+-------+------------------------------------------+--------+

示例：{\"RPCMethod\":\"WPS\",\"ID \":\"xxxxxxxx
\",\"data\":{\"Radio\":\"all\"}}

## 响应 {#响应-16 .QB标题6}

表7.2-30 Wi-Fi WPS控制响应

  ---------------------------------------------------------------------------
  参数名     类型      描述                                        是否必须
  ---------- --------- ------------------------------------------- ----------
  ID         String    事务ID。                                    Y

  respCode   Number    响应码， 0为成功，详见附录B                 Y

  respCont   String    接口调用失败时的返回值；                    N
  ---------------------------------------------------------------------------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 设置黑白名单 {#设置黑白名单 .QB标题5}

接口说明：通过该消息将黑白名单下发给组网终端。

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-17 .QB标题6}

表7.2-31 设置黑白名单请求

  ---------------------------------------------------------------------------------------------------------------------------------------------------
  参数名             类型     描述                                                                                                         是否必须
  ------------------ -------- ------------------------------------------------------------------------------------------------------------ ----------
  RPCMethod          String   命令字，取值"MacFilter"                                                                                      Y

  ID                 String   事务ID。                                                                                                     Y

  data               Object   设备解析数据包                                                                                               Y

  MacFilterEnable    Number   是否使能MAC地址过滤；1为过滤；0为不过滤                                                                      Y

  MacFilterPolicy    Number   MAC地址过滤策略；0为黑名单；1为白名单                                                                        Y

  MacFilterEntries   String   黑白名单信息：包含MAC地址及设备名（最长为64字节），以"/"隔开；两组信息之间以逗号分开，最多支持32组。示例：   Y
                              001111334455/pro,80717a33ccf3/android                                                                        
  ---------------------------------------------------------------------------------------------------------------------------------------------------

示例：

{\"RPCMethod\":\"MacFilter\",\"ID\":\"xxxxxxxx\",\"data\":{\"MacFilterEnable\":1,\"MacFilterPolicy\":0,\"MacFilterEntries\":\"001111334455/pro,80717a33ccf3/android\"}}

## 响应 {#响应-17 .QB标题6}

表7.2-32 设置黑白名单响应

  ---------- ----------- --------------------------------------- ----------
  参数名     类型        描述                                    是否必须

  ID         String      事务ID。                                Y

  respCode   Number      响应码， 0为成功，详见附录B             Y

  respCont   String      接口调用失败时的返回值；                N
  ---------- ----------- --------------------------------------- ----------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 设备重启 {#设备重启 .QB标题5}

接口说明：通过该消息控制组网终端重启，或控制组网终端重新选择下挂Wi-Fi工作信道。

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-18 .QB标题6}

表7.2-33 设备重启请求

+----------+-------+-----------------------------------------+--------+
| 参数名   | 类型  | 描述                                    | 是     |
|          |       |                                         | 否必须 |
+==========+=======+=========================================+========+
| R        | S     | 命令字，取值"Reboot"                    | Y      |
| PCMethod | tring |                                         |        |
+----------+-------+-----------------------------------------+--------+
| ID       | S     | 事务ID。                                | Y      |
|          | tring |                                         |        |
+----------+-------+-----------------------------------------+--------+
| data     | O     | 设备解析数据包                          | Y      |
|          | bject |                                         |        |
+----------+-------+-----------------------------------------+--------+
| Con      | S     | 控制指令的类型：                        | Y      |
| trolType | tring |                                         |        |
|          |       | \"Reboot\"：重启                        |        |
|          |       |                                         |        |
|          |       | \"2.4GChanRe                            |        |
|          |       | Select\"：重新选择2.4G频段Wi-Fi工作信道 |        |
|          |       |                                         |        |
|          |       | \"5GChan                                |        |
|          |       | ReSelect\"：重新选择5G频段Wi-Fi工作信道 |        |
+----------+-------+-----------------------------------------+--------+

示例：{\"RPCMethod\":\"Reboot\",\"ID\":\"xxxxxxxx\",\"data\":{\"ControlType\":\"Reboot\"}}

## 响应 {#响应-18 .QB标题6}

表7.2-34 设备重启响应

  ---------- -------- ---------------------------------------- ----------
  参数名     类型     描述                                     是否必须

  ID         String   事务ID。                                 Y

  respCode   Number   响应码， 0为成功，详见附录B              Y

  respCont   String   接口调用失败时的返回值；                 N
  ---------- -------- ---------------------------------------- ----------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 指示灯开关 {#指示灯开关 .QB标题5}

接口说明：通过该消息控制组网终端开启或关闭指示灯。关闭指示灯时，应关闭全部指示灯。

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-19 .QB标题6}

表7.2-35 指示灯开关请求

  -------------------------------------------------------------------------
  参数名      类型       描述                                    是否必须
  ----------- ---------- --------------------------------------- ----------
  RPCMethod   String     命令字，取值"LEDControl"                Y

  ID          String     事务ID。                                Y

  data        Object     设备要解析的数据包                      Y

  LEDOnOff    Number     指示灯开关，1为On，0为Off               Y
  -------------------------------------------------------------------------

示例：{\"RPCMethod\":\"LEDControl\",\"ID\":\"xxxxxxxx\",\"data\":{\"LEDOnOff\":1}}

## 响应 {#响应-19 .QB标题6}

表7.2-36 指示灯开关响应

  --------------------------------------------------------------------------
  参数名     类型     描述                                        是否必须
  ---------- -------- ------------------------------------------- ----------
  ID         String   事务ID。                                    Y

  respCode   Number   响应码， 0为成功，详见附录B                 Y

  respCont   String   接口调用失败时的返回值；                    N
  --------------------------------------------------------------------------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 工作模式配置 {#工作模式配置 .QB标题5}

接口说明：通过该消息控制家庭组网终端的工作模式，仅对Controller下发该控制接口。

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-20 .QB标题6}

表7.2-37 工作模式配置请求

+--------------+--------+------------------------------------+--------+
| 参数名       | 类型   | 描述                               | 是     |
|              |        |                                    | 否必须 |
+==============+========+====================================+========+
| RPCMethod    | String | 命令字，取值"WorkModelConfig"      | Y      |
+--------------+--------+------------------------------------+--------+
| ID           | String | 事务ID。                           | Y      |
+--------------+--------+------------------------------------+--------+
| data         | Object | 设                                 | Y      |
|              |        | 备解析数据包，包含WorkingMode字段  |        |
+--------------+--------+------------------------------------+--------+
| WorkingMode  | Number | AP工作模式：                       | Y      |
|              |        |                                    |        |
|              |        | 1：路由                            |        |
|              |        |                                    |        |
|              |        | 0：桥接                            |        |
+--------------+--------+------------------------------------+--------+

示例：{\"RPCMethod\":\"WorkModelConfig\",\"ID \":\"xxxxxxxx
\",\"data\":{\"WorkingMode\":0}}

## 响应 {#响应-20 .QB标题6}

表7.2-38 工作模式配置响应

  ---------------------------------------------------------------------------
  参数名     类型       描述                                       是否必须
  ---------- ---------- ------------------------------------------ ----------
  ID         String     事务ID。                                   Y

  respCode   Number     响应码， 0为成功，详见附录B                Y

  respCont   String     接口调用失败时的返回值；                   N
  ---------------------------------------------------------------------------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 设备信息周期/上电上报配置 {#设备信息周期上电上报配置 .QB标题5}

接口说明：通过该消息配置组网终端周期/上电上报设备信息内容。

请求方向：省级数字家庭管理平台-\>组网终端

设备收到平台指令后，应间隔interval，再发起首次周期上报，interval=rand\[0,
300\]，单位秒。

## 请求 {#请求-21 .QB标题6}

表7.2-39 设备信息周期上报配置

+-------------+-------+---------------------------------------+-------+
| 参数名      | 类型  | 描述                                  | 是否  |
|             |       |                                       | 必须  |
+=============+=======+=======================================+=======+
| RPCMethod   | S     | 命令字，取值"ApReportConfig"          | Y     |
|             | tring |                                       |       |
+-------------+-------+---------------------------------------+-------+
| ID          | S     | 事务ID。                              | Y     |
|             | tring |                                       |       |
+-------------+-------+---------------------------------------+-------+
| data        | O     | 终端要解析的数据包                    | Y     |
|             | bject |                                       |       |
+-------------+-------+---------------------------------------+-------+
| StatusRep   | S     | 设备Wi-Fi状态/上联状态/周边Wi-Fi状态  | N     |
| ortInterval | tring | 上报周期，单位s（秒）；周期上报时间设 |       |
|             |       | 备以600秒（10分钟）为增加的基数，例如 |       |
|             |       | 600秒，1                              |       |
|             |       | 200秒，1800秒，默认14400秒（4小时）； |       |
|             |       |                                       |       |
|             |       | 说明：若平台未下发StatusRep           |       |
|             |       | ortInterval信息时，设备Wi-Fi状态/上联 |       |
|             |       | 状态上报周期复用ReportInterval参数；  |       |
+-------------+-------+---------------------------------------+-------+
| Rep         | S     | 下挂设                                | Y     |
| ortInterval | tring | 备上报周期，单位s(秒)；周期上报时间设 |       |
|             |       | 备以600秒（10分钟）为增加的基数，例如 |       |
|             |       | 600秒，                               |       |
|             |       | 1200秒，1800秒，默认1800秒（30分钟）  |       |
+-------------+-------+---------------------------------------+-------+
| Sam         | S     | 数据                                  | Y     |
| pleInterval | tring | 采样间隔，单位s(秒)，间隔时间设置以60 |       |
|             |       | 秒为增加基数（例如：60秒，120秒），默 |       |
|             |       | 认60s，采样间隔只用于统计收发速率信息 |       |
+-------------+-------+---------------------------------------+-------+
| UplinkS     | N     | 设备上行连                            | Y     |
| tatusEnable | umber | 接状态开关，取值为1（True），0(False) |       |
+-------------+-------+---------------------------------------+-------+
| St          | N     | 设备下挂设                            | Y     |
| aInfoEnable | umber | 备信息开关，取值为1（True），0(False) |       |
+-------------+-------+---------------------------------------+-------+
| WlanNei     | N     | 设备周边                              | N     |
| ghborEnable | umber | Wi-Fi信息，取值为1（True），0(False)  |       |
+-------------+-------+---------------------------------------+-------+
| WiFiS       | N     | 设备Wi-                               | Y     |
| tatusEnable | umber | Fi状态信息，取值为1（True），0(False) |       |
+-------------+-------+---------------------------------------+-------+

> 示例：

{\"RPCMethod\":\"ApReportConfig\",\"ID\":\"xxxxxxxx\",\"data\":{\"StatusReportInterval\":\"14400\",\"ReportInterval\":\"1800\",\"SampleInterval\":\"60\",\"UpLinkStatusEnable\":1,\"StaInfoEnable\":1,\"WlanNeighborEnable\":1,\"WiFiStatusEnable\":1}}

## 响应 {#响应-21 .QB标题6}

表7.2-40 设备信息周期上报配置响应

  -------------------------------------------------------------------------
  参数名        类型          描述                               是否必须
  ------------- ------------- ---------------------------------- ----------
  ID            String        事务ID。                           Y

  respCode      Number        见响应码表                         Y

  respCont      String        接口调用失败时的返回值             N
  -------------------------------------------------------------------------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 业务监测信息周期上报配置 {#业务监测信息周期上报配置 .QB标题5}

接口说明：通过该消息配置组网终端监测业务数据信息和周期上报。

请求方向：省级数字家庭管理平台-\>组网终端

设备收到平台配置指令后，组网终端应间隔interval，再发起首次周期上报，interval=rand\[0,
300\]，单位秒。

## 请求 {#请求-22 .QB标题6}

表7.2-41 业务监测信息周期上报配置

  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  参数名                  类型         描述                                                                                                                          是否必须
  ----------------------- ------------ ----------------------------------------------------------------------------------------------------------------------------- ----------
  RPCMethod               String       命令字，取值"ServiceDataConfig"                                                                                               Y

  ID                      String       事务ID。                                                                                                                      Y

  data                    Object       终端要解析的数据包                                                                                                            Y

  ServiceNumber           Number       需要监测的业务数量                                                                                                            Y

  ReportInterval          String       数据上报周期，单位s(秒)，周期上报时间；设备以600秒（10分钟）为增加的基数，例如：600秒，1200秒，1800秒，默认1800秒（30分钟）   Y

  SampleInterval          String       数据采样间隔，单位s(秒)，间隔时间设置以60秒为基数增加（例如：60秒，120秒），默认60s。采样间隔只用于统计收发速率信息           Y

  ServiceConfig           Arrayt       业务服务配置数组，考虑设备性能，最多配置8条                                                                                   Y

  ServiceUrl              String       监测业务Url                                                                                                                   Y

  TcpConnectInfoEnable    Number       Tcp连接信息开关；取值为1（True），0(False)                                                                                    Y

  HttpConnectInfoEnable   Number       http连接信息开关；取值为1（True），0(False)                                                                                   Y

  DnsParseInfoEnable      Number       Dns解析信息开关；取值为1（True），0(False)                                                                                    Y
  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

> 示例：
>
> {\"RPCMethod\":\"ServiceDataConfig\",\"ID\":\"xxxxxxxx\",\"data\":{\"ServiceNumber\":2,\"ReportInterval\":\"600\",\"SampleInterval\":60,\"ServiceConfig\":\[{\"ServiceUrl\":\"www.baidu.com\",\"TcpConnectInfoEnable\":1,\"HttpConnectInfoEnable\":1,\"DnsParseInfoEnable\":1},{\"ServiceUrl\":\"www.taobao.com\",\"TcpConnectInfoEnable\":1,\"HttpConnectInfoEnable
> \":1,\"DnsParseInfoEnable \":1}\]}}

## 响应 {#响应-22 .QB标题6}

表7.2-42 业务监测信息周期上报配置响应

  ------------------------------------------------------------------------
  参数名     类型         描述                                  是否必须
  ---------- ------------ ------------------------------------- ----------
  ID         String       事务ID。                              Y

  respCode   Number       响应码表                              Y

  respCont   String       接口调用失败时的返回值                N
  ------------------------------------------------------------------------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 配置双频合一功能 {#配置双频合一功能 .QB标题5}

接口说明：通过该消息针对双频组网终端配置双频合一功能。

请求方向：省级数字家庭管理平台-\>组网终端

说明：当设备收到开启双频合一指令时，终端应主动将SSID-5的名称（SSID）和密码（key）调整为SSID-1的名称和密码；当设备收到关闭双频合一指令时（已开启双频合一），终端应主动将SSID-5的名称（SSID）在现有名称条件下增加"-5G"，SSID-5的密码保持不变；（例如：双频合一开启时，SSID-1和SSID-5的名称为CMCC-XXXX，关闭双频合一后，调整SSID-5的名称为CMCC-XXXX-5G，密码保持不变）；

## 请求 {#请求-23 .QB标题6}

表7.2-43 双频合一请求

+-----------+-------+----------------------------------------+--------+
| 参数名    | 类型  | 描述                                   | 是     |
|           |       |                                        | 否必须 |
+===========+=======+========================================+========+
| RPCMethod | S     | 命令字，取值"BandSteering"             | Y      |
|           | tring |                                        |        |
+-----------+-------+----------------------------------------+--------+
| ID        | S     | 事务ID。                               | Y      |
|           | tring |                                        |        |
+-----------+-------+----------------------------------------+--------+
| data      | O     | 终端要解析的数据包                     | Y      |
|           | bject |                                        |        |
+-----------+-------+----------------------------------------+--------+
| Enable    | N     | BandSteering开关是否打开：             | Y      |
|           | umber |                                        |        |
|           |       | 0: 关闭                                |        |
|           |       |                                        |        |
|           |       | 1: 打开                                |        |
+-----------+-------+----------------------------------------+--------+
| RSSI      | S     | 接收信                                 | N      |
| Threshold | tring | 号强度阈值，当2.4G频段检测到某一下挂S  |        |
|           |       | TA接收到的信号强度高于此阈值，将当前双 |        |
|           |       | 频STA切换至5G频段。单位：dbm.默认值-60 |        |
|           |       |                                        |        |
|           |       | 取值范围（-100\~0）                    |        |
+-----------+-------+----------------------------------------+--------+
| RSSITh    | S     | 5G接收信号强度阈值，当双频客           | N      |
| reshold5G | tring | 户端首次连接或者当前工作在5G频段时，检 |        |
|           |       | 测到某一下挂双频STA接收到的信号强度低  |        |
|           |       | 于此阈值将下挂双频客户端切换至2.4G频段 |        |
|           |       |                                        |        |
|           |       | 单位：dbm.默认值 -80                   |        |
|           |       |                                        |        |
|           |       | 取值范围（-100\~0）                    |        |
+-----------+-------+----------------------------------------+--------+

示例：{\"RPCMethod\":\"BandSteering\",\"ID\":\"xxxxxxxx
\",\"data\":{\"Enable\":0}}

## 响应 {#响应-23 .QB标题6}

表7.2-44 双频合一响应

  ---------------------------------------------------------------------------
  参数名     类型       描述                                       是否必须
  ---------- ---------- ------------------------------------------ ----------
  ID         String     事务ID。                                   Y

  respCode   Number     响应码， 0为成功，详见附录B                Y

  respCont   String     接口调用失败时的返回值；                   N
  ---------------------------------------------------------------------------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 配置Wi-Fi参数同步状态 {#配置wi-fi参数同步状态 .QB标题5}

接口说明：通过该消息针对组网终端配置Wi-Fi参数同步功能。组网终端默认Wi-Fi参数同步处于开启状态；

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-24 .QB标题6}

表7.2-45 Wi-Fi参数同步状态配置请求

  --------------------------------------------------------------------------------------------------------------------
  参数名        类型     描述                                                                               是否必须
  ------------- -------- ------------------------------------------------------------------------------ --- ----------
  RPCMethod     String   命令字，取值"WiFiSyncControl"                                                      Y

  ID            String   事务ID                                                                             Y

  data          Object   解析的数据包                                                                   Y   

  SyncEnable    Number   Wi-Fi参数同步开关；                                                            Y   
                         1为设备开启同网关的Wi-Fi参数同步功能；0为设备关闭同网关的Wi-Fi参数同步功能；       
  --------------------------------------------------------------------------------------------------------------------

示例：{\"RPCMethod\":\"WiFiSyncControl\",\"ID \":\"xxxxxxxx
\",\"data\":{\"SyncEnable\":0}}

## 响应 {#响应-24 .QB标题6}

表7.2-46 Wi-Fi参数同步状态配置响应

  ---------------------------------------------------------------------------
  参数名     类型       描述                                       是否必须
  ---------- ---------- ------------------------------------------ ----------
  ID         String     事务ID。                                   Y

  respCode   Number     响应码， 0为成功，详见附录B                Y

  respCont   String     接口调用失败时的返回值；                   N
  ---------------------------------------------------------------------------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

##  IPv4/IPv6双栈功能配置 {#ipv4ipv6双栈功能配置 .QB标题5}

接口说明：通过该消息对组网终端配置IPv4/IPv6双栈功能。组网终端默认开启IPv4/IPv6双栈功能；

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-25 .QB标题6}

表7.2-47 IPv4/IPv6双栈功能配置

+------------+-------+---------------------------------------+---+--------+
| 参数名     | 类型  | 描述                                  |   | 是     |
|            |       |                                       |   | 否必须 |
+============+=======+=======================================+===+========+
| RPCMethod  | S     | 命令字，取值"IPv6Control"             |   | Y      |
|            | tring |                                       |   |        |
+------------+-------+---------------------------------------+---+--------+
| ID         | S     | 事务ID。                              |   | Y      |
|            | tring |                                       |   |        |
+------------+-------+---------------------------------------+---+--------+
| data       | O     | 解析的数据包                          | Y |        |
|            | bject |                                       |   |        |
+------------+-------+---------------------------------------+---+--------+
| IPv6Enable | N     | 组网终端IPv4/IPv6双栈状态，枚举取值； | Y |        |
|            | umber |                                       |   |        |
|            |       | 0：关闭IPv4/IPv6双栈                  |   |        |
|            |       |                                       |   |        |
|            |       | 1：开启IPv4/IPv6双栈                  |   |        |
+------------+-------+---------------------------------------+---+--------+

示例：{\"RPCMethod\":\"IPv6Control\",\"ID \":\"xxxxxxxx
\",\"data\":{\"IPv6Enable\":1}}

## 响应 {#响应-25 .QB标题6}

表7.2-48 Wi-Fi参数同步状态配置响应

  ----------------------------------------------------------------------------
  参数名      类型       描述                                       是否必须
  ----------- ---------- ------------------------------------------ ----------
  ID          String     事务ID。                                   Y

  srespCode   Number     响应码， 0为成功，详见附录B                Y

  respCont    String     接口调用失败时的返回值；                   N
  ----------------------------------------------------------------------------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

##  5GHz频段优先配置 {#ghz频段优先配置 .QB标题5}

接口说明：组网终端收到该接口要求时，将指定STA限制接入2.4GHz，限制时间建议为3s，并引导切换到5GHz频段；
省平台下发该接口前，需判断当前STA是否具备连接5GHz频段能力（建议识别标准：STA连接路由器的信号强度
RSSI
\>-70dbm，用户近一周内未修改SSID、KEY参数，且该STA在一周内连接过5GHz频段）；

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-26 .QB标题6}

表1-5 省平台5GHz频段优先接口请求参数表

  ------------------------------------------------------------------------------------------------------------------------------------------
  参数名           类型       描述                                                                                               是否必须
  ---------------- ---------- -------------------------------------------------------------------------------------------------- -----------
  RPCMethod        String     命令字，取值"5GPreferred"                                                                          Y

  ID               String     事务ID。                                                                                           Y

  data             Object     终端待解析数据包                                                                                   Y

  5GPreferredSta   String     名单列表："mac地址/设备名"格式；多信息之间以逗号分开，最多支持32组。示例：\"AABBCCDDEE00/iphone,   Y
                              112233445566/Mi\"                                                                                  

  LimitedTime      Number     限制连接2.4GHz频段的时间，单位毫秒，缺省值为3000；                                                 Y
  ------------------------------------------------------------------------------------------------------------------------------------------

示例：

{\"RPCMethod\":\"5GPreferred\",\"ID\":\"xxxxxxxx\",\"data\":{\"5GPreferredSta\":\"AABBCCDDEE00/iphone,112233445566/Mi\",\"LimitedTime\":3000}}

## 响应 {#响应-26 .QB标题6}

表1-6 省平台5GHz频段优先接口响应

  ---------- ----------- --------------------------------------- ----------
  参数名     类型        描述                                    是否必须

  ID         String      事务ID。                                Y

  respCode   Number      响应码， 0为成功                        Y

  respCont   String      接口调用失败时的返回值；                N
  ---------- ----------- --------------------------------------- ----------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

##  IPTV VLAN配置 {#iptv-vlan配置 .QB标题5}

接口说明：通过该接口实现路由器VLAN配置；①绑定了IPTV业务的有线端口和无线SSID，其下行报文需删除VLAN
tag，其上行报文需添加VLAN
tag后再进行转发。②无论路由器自身工作模式（路由/桥接/中继），IPTV业务都应工作在桥接（或中继）模式；

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-27 .QB标题6}

表1-7 IPTV VLAN配置接口请求参数表

+----------+------+--------------------------------------------+------+
| 参数名   | 类型 | 描述                                       | 是否 |
|          |      |                                            | 必须 |
+==========+======+============================================+======+
| R        | St   | 命令字，取值"IPTV"                         | Y    |
| PCMethod | ring |                                            |      |
+----------+------+--------------------------------------------+------+
| ID       | St   | 事务ID，平台                               | Y    |
|          | ring | 下发给设备的指令都携带事务ID号，要求返回执 |      |
|          |      | 行结果时，必须携带该ID，以便于对设备执行指 |      |
|          |      | 令的管理。使设备能够实现并行任务指行能力。 |      |
+----------+------+--------------------------------------------+------+
| data     | Ob   | 终端待解析数据包                           | Y    |
|          | ject |                                            |      |
+----------+------+--------------------------------------------+------+
| Vl       | Nu   | IPTV业务开关；1：打开，0：关闭             | Y    |
| anEnable | mber |                                            |      |
+----------+------+--------------------------------------------+------+
| VlanId   | Nu   | IPTV业务的VLAN                             | N    |
|          | mber | ID；IPTV业务开关打开时必选；               |      |
+----------+------+--------------------------------------------+------+
| Ip       | A    | 用户                                       | N    |
| tvStatus | rray | 侧接口的VLAN参数；IPTV业务开关打开时必选； |      |
+----------+------+--------------------------------------------+------+
| Radio    | St   | 端口信息，对于WLAN接口的频段，取值2.4G或5G | N    |
|          | ring | 或5G-2，对于以太接口，取值为[LAN]{.mark}； |      |
|          |      |                                            |      |
|          |      | 注：对于三频设备，5G表示5.1G频段           |      |
|          |      | ，5G-2表示5.8G频段；双频设备忽略5G-2频段； |      |
+----------+------+--------------------------------------------+------+
| Index    | Nu   | WLAN接口的SSID索引或LAN接口序号；          | N    |
|          | mber |                                            |      |
+----------+------+--------------------------------------------+------+

示例：

{\"RPCMethod\":\"IPTV\",\"ID\":\"xxxxxxxx\",\"data\":{\"VlanEnable\":1,\"VlanId\":46,\"IptvStatus\":\[{\"Radio\":\"5G\",\"Index\":5},{\"Radio\":\"2.4G\",\"Index\":1},{\"Radio\":\"LAN\",\"Index\":1},{\"Radio\":\"LAN\",\"Index\":3}\]}}

## 响应 {#响应-27 .QB标题6}

表1-8 IPTV VLAN配置接口响应参数表

  ---------- ----------- -------------------------------------------------------------------------------------------------------------------------------------------- ----------
  参数名     类型        描述                                                                                                                                         是否必须

  ID         String      事务ID，平台下发给设备的指令都携带事务ID号，要求返回执行结果时，必须携带该ID，以便于对设备执行指令的管理。使设备能够实现并行任务指行能力。   Y

  respCode   Number      响应码， 0为成功，详见附录B                                                                                                                  Y

  respCont   String      接口调用失败时的返回值；                                                                                                                     N
  ---------- ----------- -------------------------------------------------------------------------------------------------------------------------------------------- ----------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

##  QoS优先级配置 {#qos优先级配置 .QB标题5}

接口说明：通过该接口实现路由器QoS优先级配置，组网终端应支持通过MAC（包含源MAC和目的MAC）或五元组信息（包含源IP地址、目的IP地址、协议号、源端口、目的端口）对相关业务进行优先级调度。该接口仅需AP工作在路由模式下支持；

平台调用该接口配置业务优先级时，需在WLAN空口进行WMM队列的映射，支持WMM定义的四中流类型（VOICE/VIDEO/BEST
EFORT/BACKGROUND）及其优先级调度规则，支持基于优先级的数据处理和转发。WMM
和 DSCP 的映射关系如下表所示：

表1-1WMM和DSCP映射关系

  ----------------------- ----------------------- -----------------------
  QoS范围                 DSCP范围                WMM流类型

  0                       0\~7                    AC_BE

  1\~2                    8\~23                   AC_BK

  3                       24\~31                  AC_BE

  4\~5                    32\~47                  AC_VI

  6\~7                    48\~63                  AC_VO
  ----------------------- ----------------------- -----------------------

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-28 .QB标题6}

请求方向：省级数字家庭管理平台---\>组网终端

表1-9 QoS优先级配置接口请求参数表

  ----------------------------------------------------------------------------------------------------------
  参数名            类型      描述                                                               是否必须
  ----------------- --------- ------------------------------------------------------------------ -----------
  RPCMethod         String    命令字，取值"QoS"                                                  Y

  ID                String    事务ID，平台下发给设备的指令都携带事务ID号。                       Y

  data              Object    终端待解析数据包                                                   Y

  QosEnable         Number    QoS开关；1：打开，0：关闭                                          Y

  QosParameter      Array     QoS分类规则，最大下发8个实例；                                     N

  QosPriority       Number    QoS优先级；取值范围：0-7；数值越大优先级越高；                     N

  DscpEnable        Number    DSCP优先级开关；1：打开，0：关闭                                   N

  DscpPriority      Number    DSCP优先级；取值范围：0-63；数值越大优先级越高；                   N

  Vlan8021pEnable   Number    802.1P启用开关；1：打开，0关闭                                     N

  Vlan8021p         Number    VLAN优先级；取值范围：0-7；数值越大优先级越高；                    N

  SourceIp          String    源IP                                                               N

  SourcePort        String    源端口                                                             N

  DestinationIp     String    目的地IP                                                           N

  DestinationPort   String    目的地端口                                                         N

  Protocol          String    传输协议列表，多种协议时使用逗号进行分割；取值为：TCP，UDP，ICMP   N

  SourceMac         String    源MAC（一般指路由器铭牌MAC）                                       N

  DestinationMac    String    目的MAC（一般指下挂设备MAC）                                       N
  ----------------------------------------------------------------------------------------------------------

示例：

{\"RPCMethod\":\"QoS\",\"ID\":\"xxxxxxxx\",\"data\":{\"QosEnable\":1,\"QosParameter\":\[{\"QosPriority\":5,\"DscpEnable\":1,\"DscpPriority\":45,\"SourceMac\":\"\*\*\*\*\*\*\*\*\*\*\*\*\",\"DestinationMac\":\"\*\*\*\*\*\*\*\*\*\*\*\*\"},{\"QosPriority\":7,\"DscpEnable\":1,\"DscpPriority\":57,\"SourceIp\":\"224.xx.xx.xx\",\"SourcePort\":\"\*\*\*\*\",\"DestinationIp\":\"xx.xx.xx.xx\",\"DestinationPort\":\"\*\*\*\*\",\"Protocol\":\"TCP\"},{\"QosPriority\":6,\"Vlan8021pEnable\":1,\"Vlan8021p\":6,\"SourceIp\":\"224.xx.xx.xx\",\"SourcePort\":\"\*\*\*\*\",\"DestinationIp\":\"xx.xx.xx.xx\",\"DestinationPort\":\"\*\*\*\*\",\"Protocol\":\"ICMP\"}\]}}

## 响应 {#响应-28 .QB标题6}

表1-10 QoS优先级配置接口响应

  ---------- ----------- -------------------------------------------- ----------
  参数名     类型        描述                                         是否必须

  ID         String      事务ID，平台下发给设备的指令都携带事务ID号   Y

  respCode   Number      响应码， 0为成功，详见附录B                  Y

  respCont   String      接口调用失败时的返回值；                     N
  ---------- ----------- -------------------------------------------- ----------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

##  DNS配置 {#dns配置 .QB标题5}

## 接口描述 {#接口描述-1 .QB标题6}

接口内容：通过该接口实现组网终端的DNS配置。缺省或手动设置开关关闭时，采用自动获取方式。

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-29 .QB标题6}

表7.2-56 DNS配置请求

  ---------------------------------------------------------------------------------------
  参数名         类型     描述                                                 是否必须
  -------------- -------- ---------------------------------------------------- ----------
  RPCMethod      String   命令字，取值"DNS"                                    Y

  ID             String   事务ID。                                             Y

  data           Object   终端待解析数据包                                     Y

  DnsSetEnable   Number   DNS Server手动设置开关；1：打开，0：关闭             Y

  PreDnsServer   String   首选DNS服务器地址，若DnsSetEnable为1，则此项必选。   N

  AltDnsServer   String   备选DNS服务器地址                                    N
  ---------------------------------------------------------------------------------------

示例：

{\"RPCMethod\":\"DNS\",\"ID\":\"xxxxxxxx\",\"data\":{\"DnsSetEnable\":1,\"PreDnsServer\":\"xx.xx.xx.xx\",\"AltDnsServe\":\"xx.xx.xx.xx\"}}

## 响应 {#响应-29 .QB标题6}

表7.2-57 DNS配置响应

  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  参数名      类型      描述                                                                                                                                         是否必须
  ----------- --------- -------------------------------------------------------------------------------------------------------------------------------------------- ----------
  ID          String    事务ID，平台下发给设备的指令都携带事务ID号，要求返回执行结果时，必须携带该ID，以便于对设备执行指令的管理。使设备能够实现并行任务指行能力。   Y

  respCode    Number    响应码， 0为成功，详见附录B                                                                                                                  Y

  respCont    String    接口调用失败时的返回值；                                                                                                                     N
  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 信息查询接口 {#信息查询接口-1 .QB标题4}

## 信息查询 {#信息查询 .QB标题5}

接口说明：通过该消息查询组网终端的配置信息。

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-30 .QB标题6}

表7.2-49 信息查询请求

  -------------------------------------------------------------------------
  参数名      类型      描述                                     是否必须
  ----------- --------- ---------------------------------------- ----------
  RPCMethod   String    命令字，取值"ApConfigInfo"               Y

  ID          String    事务ID。                                 Y
  -------------------------------------------------------------------------

## 响应 {#响应-30 .QB标题6}

表7.2-50 配置信息查询响应

+---------------+-------+------------------------------------+--------+
| 参数名        | 类型  | 描述                               | 是     |
|               |       |                                    | 否必须 |
+===============+=======+====================================+========+
| ID            | S     | 事务ID。                           | Y      |
|               | tring |                                    |        |
+---------------+-------+------------------------------------+--------+
| respCode      | N     | 接口调用失败时的响应码             | N      |
|               | umber |                                    |        |
+---------------+-------+------------------------------------+--------+
| respCont      | S     | 接口调用失败时的返回值             | N      |
|               | tring |                                    |        |
+---------------+-------+------------------------------------+--------+
| data          | O     | 响应数据                           | Y      |
|               | bject |                                    |        |
+---------------+-------+------------------------------------+--------+
| ha            | S     | 硬件版本                           | Y      |
| rdwareVersion | tring |                                    |        |
+---------------+-------+------------------------------------+--------+
| so            | S     | 软件版本                           | Y      |
| ftwareVersion | tring |                                    |        |
+---------------+-------+------------------------------------+--------+
| WorkingMode   | N     | AP工作模式：                       | Y      |
|               | umber |                                    |        |
|               |       | 0：桥接                            |        |
|               |       |                                    |        |
|               |       | 1：路由                            |        |
|               |       |                                    |        |
|               |       | 2: 中继                            |        |
+---------------+-------+------------------------------------+--------+
| FlashSize     | N     | Flash大小，单位Mbytes              | Y      |
|               | umber |                                    |        |
+---------------+-------+------------------------------------+--------+
| RamSize       | N     | Ram大小，单位Mbytes                | Y      |
|               | umber |                                    |        |
+---------------+-------+------------------------------------+--------+
| CPU           | N     | 0-100 (CPU占用率)                  | Y      |
| OccupancyRate | umber |                                    |        |
+---------------+-------+------------------------------------+--------+
| C             | N     | 单位为℃，取值为整数                | N      |
| PUTemperature | umber |                                    |        |
+---------------+-------+------------------------------------+--------+
| Ram           | N     | 0-100（RAM占用率）                 | Y      |
| OccupancyRate | umber |                                    |        |
+---------------+-------+------------------------------------+--------+
| UpTime        | S     | 在线时长，单位：秒                 | Y      |
|               | tring |                                    |        |
+---------------+-------+------------------------------------+--------+
| Ma            | N     | 是否使                             | Y      |
| cFilterEnable | umber | 能MAC地址过滤，1为过滤，0为不过滤  |        |
+---------------+-------+------------------------------------+--------+
| Ma            | N     | MAC地址过滤策略：                  | Y      |
| cFilterPolicy | umber |                                    |        |
|               |       | 0: 黑名单                          |        |
|               |       |                                    |        |
|               |       | 1: 白名单                          |        |
+---------------+-------+------------------------------------+--------+
| Mac           | S     | 黑白名单信息：包含MAC地址及设备名  | Y      |
| FilterEntries | tring | （最长为64字节），以"/"隔开；两组  |        |
|               |       | 信息之间以逗号分开，最多支持32组。 |        |
+---------------+-------+------------------------------------+--------+
| LEDOnOff      | N     | 指示灯开关，1为On，0为Off          | Y      |
|               | umber |                                    |        |
+---------------+-------+------------------------------------+--------+
| BandS         | N     | 双频合一开关状态：                 | N      |
| teeringStatus | umber |                                    |        |
|               |       | 0: 关闭                            |        |
|               |       |                                    |        |
|               |       | 1: 打开                            |        |
+---------------+-------+------------------------------------+--------+
| RoamingSwitch | N     | 是否开                             | Y      |
|               | umber | 启Wi-Fi漫游控制，1为启用，0为关闭  |        |
+---------------+-------+------------------------------------+--------+
| LowRSSI2.4G   | N     | 弱信号阈值（2.4G），单位dBm        | Y      |
|               | umber |                                    |        |
|               |       | 当STA接                            |        |
|               |       | 入当前组网终端的RSSI小于该阈值时， |        |
|               |       | 组网终端需对该STA执行漫游切换控制  |        |
+---------------+-------+------------------------------------+--------+
| LowRSSI5G     | N     | 弱信号阈值（5G），单位dBm          | Y      |
|               | umber |                                    |        |
|               |       | 当STA接                            |        |
|               |       | 入当前组网终端的RSSI小于该阈值时， |        |
|               |       | 组网终端需对该STA执行漫游切换控制  |        |
+---------------+-------+------------------------------------+--------+
| IPv6Status    | N     | 组网                               | N      |
|               | umber | 终端IPv4/IPv6双栈状态，枚举取值；  |        |
|               |       |                                    |        |
|               |       | 0：关闭IPv4/IPv6双栈               |        |
|               |       |                                    |        |
|               |       | 1：开启IPv4/IPv6双栈               |        |
+---------------+-------+------------------------------------+--------+
| I             | S     | IPv6协议的连接状态，枚举取值：     | Y      |
| Pv6ConnStatus | tring |                                    |        |
|               |       | Connected                          |        |
|               |       |                                    |        |
|               |       | Unconnected                        |        |
+---------------+-------+------------------------------------+--------+
| IPv6IP        | S     | IPv6地址分配机制，枚举取值：       | Y      |
| AddressOrigin | tring |                                    |        |
|               |       | AutoConfigured                     |        |
|               |       |                                    |        |
|               |       | DHCPv6                             |        |
|               |       |                                    |        |
|               |       | Static                             |        |
+---------------+-------+------------------------------------+--------+
| IPv6IPAddress | S     | WAN连接的IPv6地址；                | Y      |
|               | tring |                                    |        |
+---------------+-------+------------------------------------+--------+
| I             | S     | DNS Server地址。                   | Y      |
| Pv6DNSServers | tring |                                    |        |
+---------------+-------+------------------------------------+--------+
| I             | S     | Prefix Delegation使能状态；        | Y      |
| Pv6PrefixDele | tring |                                    |        |
| gationEnabled |       | TRUE表示启用，FALSE表示禁用。      |        |
+---------------+-------+------------------------------------+--------+
| IPv           | S     | 前缀地址分配机制，枚举取值：       | Y      |
| 6PrefixOrigin | tring |                                    |        |
|               |       | PrefixDelegation                   |        |
|               |       |                                    |        |
|               |       | Static                             |        |
+---------------+-------+------------------------------------+--------+
| IPv6Prefix    | S     | 前缀地址。                         | Y      |
|               | tring |                                    |        |
+---------------+-------+------------------------------------+--------+
| IPv           | N     | 公告前缀的preferred                | Y      |
| 6PrefixPltime | umber | lifetime，单位：秒 ；              |        |
+---------------+-------+------------------------------------+--------+
| IPv           | N     | 公告前缀的valid lifetime，单位：秒 | Y      |
| 6PrefixVltime | umber | ；                                 |        |
+---------------+-------+------------------------------------+--------+
| Defau         | S     | IPv6默认网关 ；                    | Y      |
| ltIPv6Gateway | tring |                                    |        |
+---------------+-------+------------------------------------+--------+
| Dslite_Enable | S     | 是否启用DS-lite功能。              | Y      |
|               | tring |                                    |        |
|               |       | TRUE表示启用，FALSE表示禁用。      |        |
+---------------+-------+------------------------------------+--------+
| SyncStatus    | N     | Wi-Fi参数同步状态；                | **N**  |
|               | umber | 1为设备开启                        |        |
|               |       | 同网关的Wi-Fi参数同步功能；0为设备 |        |
|               |       | 关闭同网关的Wi-Fi参数同步功能；组  |        |
|               |       | 网终端默认关闭Wi-Fi参数同步功能；  |        |
+---------------+-------+------------------------------------+--------+
| Radios        | Array | Wi-Fi射                            | Y      |
|               |       | 频信息的数组，包含以下字段：Radio  |        |
|               |       | ，Enable，TransmitPower，Channel， |        |
|               |       | SSIDStandard，NoiseLevel，Interfer |        |
|               |       | encePercent，Bandwidth、LoadRate； |        |
+---------------+-------+------------------------------------+--------+
| Radio         | S     | Radios数组之一，频段，枚举取值：   | Y      |
|               | tring |                                    |        |
|               |       | 2.4G                               |        |
|               |       |                                    |        |
|               |       | 5G                                 |        |
|               |       |                                    |        |
|               |       | 5G-2                               |        |
|               |       |                                    |        |
|               |       | 注：对                             |        |
|               |       | 于三频设备，5G表示5.1G频段，5G-2表 |        |
|               |       | 示5.8G频段；双频设备忽略5G-2频段； |        |
+---------------+-------+------------------------------------+--------+
| Enable        | N     | Radios数组之一，该频段是否启用；   | Y      |
|               | umber |                                    |        |
|               |       | 1为启用，0为禁用                   |        |
+---------------+-------+------------------------------------+--------+
| TransmitPower | S     | Radios数组                         | Y      |
|               | tring | 之一，Wi-Fi发射功率级别（百分比）  |        |
+---------------+-------+------------------------------------+--------+
| SSIDStandard  | S     | WLAN口支持的无                     | Y      |
|               | tring | 线传输标准，取值802.11a/802.11b/8  |        |
|               |       | 02.11g/802.11n/802.11ac/802.11ax等 |        |
+---------------+-------+------------------------------------+--------+
| NoiseLevel    | S     | 当前信道底噪                       | Y      |
|               | tring |                                    |        |
+---------------+-------+------------------------------------+--------+
| Interf        | N     | 当前信道干扰信号的占空比           | Y      |
| erencePercent | umber |                                    |        |
+---------------+-------+------------------------------------+--------+
| Channel       | S     | WLAN工作信道号                     | Y      |
|               | tring |                                    |        |
+---------------+-------+------------------------------------+--------+
| Bandwidth     | N     | 当前Wi-Fi频宽，采用枚举取值：      | N      |
|               | umber |                                    |        |
|               |       | 0：自动频宽                        |        |
|               |       |                                    |        |
|               |       | 1：20MHz                           |        |
|               |       |                                    |        |
|               |       | 2：40MHz                           |        |
|               |       |                                    |        |
|               |       | 3：80MHz                           |        |
|               |       |                                    |        |
|               |       | 4：160MHz                          |        |
|               |       |                                    |        |
|               |       | 5：80+80MHz                        |        |
|               |       |                                    |        |
|               |       | 说明：对于                         |        |
|               |       | 2.4G频段，自动频宽功能为20/40MHz频 |        |
|               |       | 宽自适应；对于5G频段，自动频宽功能 |        |
|               |       | 对应为20/40/80/160MHz频宽自适应；  |        |
+---------------+-------+------------------------------------+--------+
| LoadRate      | N     | 无线信道负载率（包含自身           | N      |
|               | umber | 传输数据及周边干扰数据），百分比； |        |
+---------------+-------+------------------------------------+--------+
| C             | Array | Wi-Fi配置的数组，                  | Y      |
| onfigurations |       | 包含以下字段：Radio，Index，Enable |        |
|               |       | ，SSID，SecurityMode，Pwd，MaxAsso |        |
|               |       | ciateNum，SSIDAdvertisementEnabled |        |
+---------------+-------+------------------------------------+--------+
| Radio         | S     | 频段，枚举取值：                   | Y      |
|               | tring |                                    |        |
|               |       | 2.4G                               |        |
|               |       |                                    |        |
|               |       | 5G                                 |        |
|               |       |                                    |        |
|               |       | 5G-2                               |        |
|               |       |                                    |        |
|               |       | 注：对                             |        |
|               |       | 于三频设备，5G表示5.1G频段，5G-2表 |        |
|               |       | 示5.8G频段；双频设备忽略5G-2频段； |        |
+---------------+-------+------------------------------------+--------+
| Index         | N     | SSID的索引                         | Y      |
|               | umber |                                    |        |
+---------------+-------+------------------------------------+--------+
| Enable        | N     | 是否启用，1为启用，0为禁用         | Y      |
|               | umber |                                    |        |
+---------------+-------+------------------------------------+--------+
| SSID          | S     | SSID名称                           | Y      |
|               | tring |                                    |        |
+---------------+-------+------------------------------------+--------+
| SecurityMode  | S     | 认证加密模式，枚举取值：           | Y      |
|               | tring |                                    |        |
|               |       | None                               |        |
|               |       |                                    |        |
|               |       | WEP-64                             |        |
|               |       |                                    |        |
|               |       | WEP-128                            |        |
|               |       |                                    |        |
|               |       | WPA-Personal                       |        |
|               |       |                                    |        |
|               |       | WPA2-Personal                      |        |
|               |       |                                    |        |
|               |       | MIXED-WPAPSK2                      |        |
|               |       |                                    |        |
|               |       | WPA3-SAE                           |        |
|               |       |                                    |        |
|               |       | MIXED-WPA2WPA3                     |        |
+---------------+-------+------------------------------------+--------+
| Encrypt       | N     | 加密算法，枚举取值：               | N      |
|               | umber |                                    |        |
|               |       | 0：None:                           |        |
|               |       |                                    |        |
|               |       | 1：AES                             |        |
|               |       |                                    |        |
|               |       | 2：TKIP                            |        |
|               |       |                                    |        |
|               |       | 3：AES+TKIP                        |        |
+---------------+-------+------------------------------------+--------+
| Pwd           | S     | Wi-Fi密钥，WEP Key或Pre-shared     | Y      |
|               | tring | K                                  |        |
|               |       | ey。管理平台不应存储和显示此参数。 |        |
+---------------+-------+------------------------------------+--------+
| Ma            | N     | 该SSI                              | Y      |
| xAssociateNum | umber | D最大允许接入的用户数，0表示不限制 |        |
+---------------+-------+------------------------------------+--------+
| SSIDAdverti   | N     | 是否广播SSID，1为广播，0为不广播   | Y      |
| sementEnabled | umber |                                    |        |
+---------------+-------+------------------------------------+--------+
| SSIDStandard  | S     | W                                  | N      |
|               | tring | LAN口支持的无线传输标准，枚举取值: |        |
|               |       |                                    |        |
|               |       | 11b/g                              |        |
|               |       |                                    |        |
|               |       | 11b/g/n                            |        |
|               |       |                                    |        |
|               |       | 11b/g/n/ax                         |        |
|               |       |                                    |        |
|               |       | 11a/n/ac/ax                        |        |
|               |       |                                    |        |
|               |       | 11a/n/ac                           |        |
|               |       |                                    |        |
|               |       | 11a/n                              |        |
|               |       |                                    |        |
|               |       | 11n                                |        |
|               |       |                                    |        |
|               |       | 11a                                |        |
|               |       |                                    |        |
|               |       | 11b                                |        |
|               |       |                                    |        |
|               |       | 11g                                |        |
+---------------+-------+------------------------------------+--------+

成功示例：

{\"ID\":\"xxxxxxxx\",\"data\":{\"hardwareVersion\":\"1.0.1\",\"softwareVersion\":\"3.2\",\"WorkingMode\":0,\"FlashSize\":32,\"RamSize\":64,\"CPUOccupancyRate\":49,\"CPUTemperature\":40,\"RamOccupancyRate\":26,\"UpTime\":\"650\",\"MacFilterEnable\":1,\"MacFilterPolicy\":0,\"MacFilterEntries\":\"001111334455/pro,80717a33ccf3/android\",\"LEDOnOff\":1,\"BandSteeringStatus\":0,\"RoamingSwitch\":1,\"LowRSSI2.4G\":-50,\"LowRSSI5G\":-60,
\"IPv6Status\":1,\"IPv6ConnStatus\":\"Connected\",\"IPv6IPAddressOrigin\":\"Static\",\"IPv6IPAddress\":\"2001:DA8:1000::F1\",\"IPv6DNSServers\":\"2001:DA8:6000::F1\",\"IPv6PrefixDelegationEnabled\":\"FALSE\",\"IPv6PrefixOrigin\":\"Static\",\"IPv6Prefix\":\"2001:1:2:3::/48\",\"IPv6PrefixPltime\":86400,\"IPv6PrefixVltime\":86400,\"DefaultIPv6Gateway\":\"2001:DA8:6000::F2\",\"Dslite_Enable\":\"TRUE\",\"SyncStatus\":0,\"Radios\":\[{\"Radio\":\"2.4G\",\"Enable\":1,\"TransmitPower\":\"100\",\"SSIDStandard\":\"-70\",\"NoiseLevel\":80,\"InterferencePercent\":10,\"Channel\":\"6\",\"Bandwidth\":1,\"LoadRate\":40},{\"Radio\":\"5G\",\"Enable\":1,\"TransmitPower\":\"100\",\"SSIDStandard\":\"-70\",\"NoiseLevel\":80,\"InterferencePercent\":10,\"Channel\":\"36\",\"Bandwidth\":4,\"LoadRate\":10}\],\"Configurations\":\[{\"Radio\":\"2.4G\",\"Index\":1,\"Enable\":1,\"SSID\":\"CMCC-2341\",\"SecurityMode\":\"MIXED-WPAPSK2\",\"Encrypt\":1,\"Pwd\":\"\*\*\*\*\*\*\*\",\"MaxAssociateNum\":10,\"SSIDAdvertisementEnabled\":1,\"SSIDStandard\":\"11b/g/n\"},{\"Radio\":\"5G\",\"Index\":5,\"Enable\":1,\"SSID\":\"CMCC-2341-5G\",\"SecurityMode\":\"MIXED-WPAPSK2\",\"Encrypt\":1,\"Pwd\":\"\*\*\*\*\*\*\*\",\"MaxAssociateNum\":10,\"SSIDAdvertisementEnabled\":1,\"SSIDStandard\":\"11a/n/ac/ax\"}\]}}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 上联状态 {#上联状态 .QB标题5}

接口说明：通过该消息查询组网终端的上联状态。

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-31 .QB标题6}

表7.2-51 上联状态请求

  --------------------------------------------------------------------------
  参数名      类型     描述                                       是否必须
  ----------- -------- ------------------------------------------ ----------
  RPCMethod   String   命令字，取值"UplinkStatus"                 Y

  ID          String   事务ID。                                   Y
  --------------------------------------------------------------------------

## 响应 {#响应-31 .QB标题6}

表7.2-52 上联状态响应

+-----------+------+----------------------------------------+----------+
| 参数名    | 类型 | 描述                                   | 是否必须 |
+===========+======+========================================+==========+
| ID        | St   | 事务ID。                               | Y        |
|           | ring |                                        |          |
+-----------+------+----------------------------------------+----------+
| respCode  | Nu   | 接口调用失败时的响应码                 | N        |
|           | mber |                                        |          |
+-----------+------+----------------------------------------+----------+
| respCont  | St   | 接口调用失败时的返回值                 | N        |
|           | ring |                                        |          |
+-----------+------+----------------------------------------+----------+
| data      | Ob   | 响应数据                               | Y        |
|           | ject |                                        |          |
+-----------+------+----------------------------------------+----------+
| U         | St   | 当前的上行接入方式：                   | Y        |
| plinkType | ring |                                        |          |
|           |      | WLAN、Ethernet、PLC、Cable、Optical    |          |
|           |      | Ethernet、GPON、XGPON、PoE             |          |
+-----------+------+----------------------------------------+----------+
| M         | St   | 上联使用的管理MAC地址                  | Y        |
| acAddress | ring |                                        |          |
+-----------+------+----------------------------------------+----------+
| Radio     | St   | WLAN上联时使用的频段，取值2.4G或5G     | N        |
|           | ring |                                        |          |
+-----------+------+----------------------------------------+----------+
| SSID      | St   | WLAN上联时接入的SSID名称               | N        |
|           | ring |                                        |          |
+-----------+------+----------------------------------------+----------+
| Channel   | St   | WLAN上联时的工作信道号                 | N        |
|           | ring |                                        |          |
+-----------+------+----------------------------------------+----------+
| Noise     | St   | WLAN上联时的噪声强度，单位dBm          | N        |
|           | ring |                                        |          |
+-----------+------+----------------------------------------+----------+
| SNR       | St   | WLAN上联时的信噪比，单位dB             | N        |
|           | ring |                                        |          |
+-----------+------+----------------------------------------+----------+
| RSSI      | St   | WLAN上联时的上联信号强度，单位为dBm    | N        |
|           | ring |                                        |          |
+-----------+------+----------------------------------------+----------+
| ~~Fiber   | ~~   | ~~光口上联时发射                       | ~~N~~    |
| TXPower~~ | Stri | 光功率，单位dBm；上行光接入时必选；~~  |          |
|           | ng~~ |                                        |          |
+-----------+------+----------------------------------------+----------+
| ~~Fiber   | ~~   | ~~光口上联时接收                       | ~~N~~    |
| RXPower~~ | Stri | 光功率，单位dBm；上行光接入时必选；~~  |          |
|           | ng~~ |                                        |          |
+-----------+------+----------------------------------------+----------+
| RxRate    | St   | 上行的协商接收速率(Mbps)               | Y        |
|           | ring |                                        |          |
+-----------+------+----------------------------------------+----------+
| TxRate    | St   | 上行的协商发送速率(Mbps)               | Y        |
|           | ring |                                        |          |
+-----------+------+----------------------------------------+----------+
| RxRate_rt | St   | 上行的实时接收速率(Mbps)               | Y        |
|           | ring |                                        |          |
+-----------+------+----------------------------------------+----------+
| TxRate_rt | St   | 上行的实时发送速率(Mbps)               | Y        |
|           | ring |                                        |          |
+-----------+------+----------------------------------------+----------+

成功示例：

{\"ID\":\"xxxxxxxx\",\"data\":{\"UplinkType\":\"WLAN\",\"MacAddress\":\"012233445566\",\"Radio\":\"2.4G\",\"SSID\":\"CMCC-1234\",\"Channel\":\"6\",\"Noise\":\"-90\",\"SNR\":\"35\",\"RSSI\":\"-55\",\"RxRate\":\"144\",\"TxRate\":\"144\",\"RxRate_rt\":\"0\",\"TxRate_rt\":\"0\"}}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 下挂设备信息 {#下挂设备信息-1 .QB标题5}

接口说明：通过该消息查询组网终端当前下挂的设备信息。

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-32 .QB标题6}

表7.2-53 下挂设备信息请求

  -------------------------------------------------------------------------
  参数名      类型      描述                                     是否必须
  ----------- --------- ---------------------------------------- ----------
  RPCMethod   String    命令字，取值"STAInfo"                    Y

  ID          String    事务ID。                                 Y
  -------------------------------------------------------------------------

## 响应 {#响应-32 .QB标题6}

表7.2-54 下挂设备信息响应

+-------------+------+----------------------------------------+-------+
| 参数名      | 类型 | 描述                                   | 是否  |
|             |      |                                        | 必须  |
+=============+======+========================================+=======+
| ID          | St   | 事务ID。                               | Y     |
|             | ring |                                        |       |
+-------------+------+----------------------------------------+-------+
| respCode    | Nu   | 接口调用失败时的响应码                 | N     |
|             | mber |                                        |       |
+-------------+------+----------------------------------------+-------+
| respCont    | St   | 接口调用失败时的返回值                 | N     |
|             | ring |                                        |       |
+-------------+------+----------------------------------------+-------+
| data        | Ob   | 响应数据                               | Y     |
|             | ject |                                        |       |
+-------------+------+----------------------------------------+-------+
| Devices     | A    | 连接的设备信                           | N     |
|             | rray | 息数组；该字段在下挂设备数非零时必选； |       |
+-------------+------+----------------------------------------+-------+
| IPAddress   | St   | 下挂设备的I                            | N     |
|             | ring | PAddress；该字段在下挂设备数非零时必选 |       |
+-------------+------+----------------------------------------+-------+
| STAIP       | St   | 下挂设备的IPV6地址；                   | N     |
| v6IPAddress | ring |                                        |       |
|             |      | 该字段在下                             |       |
|             |      | 挂设备数非零，且下挂设备支持IPv6时必选 |       |
+-------------+------+----------------------------------------+-------+
| MacAddress  | St   | 下挂设备的MAC地址；                    | N     |
|             | ring |                                        |       |
|             |      | 该字段在下挂设备数非零时必选；         |       |
+-------------+------+----------------------------------------+-------+
| VMacAddress | St   | 下挂设备在组网终端下的                 | N     |
|             | ring | 虚拟MAC，如果未转换，则和真实MAC一致。 |       |
|             |      |                                        |       |
|             |      | 该字段在下挂设备数非零时必选；         |       |
+-------------+------+----------------------------------------+-------+
| HostName    | St   | 下挂设备的名称；                       | N     |
|             | ring |                                        |       |
|             |      | 该字段在下挂设备数非零时必选；         |       |
+-------------+------+----------------------------------------+-------+
| STAType     | St   | 下挂设备类型；                         | N     |
|             | ring |                                        |       |
|             |      | 该字段在下挂设备数非零时必选；         |       |
+-------------+------+----------------------------------------+-------+
| UpTime      | St   | 已连接时间，单位：秒；                 | N     |
|             | ring |                                        |       |
|             |      | 该字段在下挂设备数非零时必选；         |       |
+-------------+------+----------------------------------------+-------+
| Conn        | Nu   | 下挂设备连接协议，枚                   | N     |
| ectProtocol | mber | 举取值，下挂设备通过Wi-Fi连接时必选；  |       |
|             |      |                                        |       |
|             |      | 0：非Wi-Fi接入                         |       |
|             |      |                                        |       |
|             |      | 1：11a或11b                            |       |
|             |      |                                        |       |
|             |      | 2：11g                                 |       |
|             |      |                                        |       |
|             |      | 3：11n                                 |       |
|             |      |                                        |       |
|             |      | 4：11ac                                |       |
|             |      |                                        |       |
|             |      | 5：11ax                                |       |
+-------------+------+----------------------------------------+-------+
| Radio       | St   | WLAN下挂设备的接入频段，               | N     |
|             | ring | 取值2.4G、5G或5G-2，对非WLAN下挂设备应 |       |
|             |      | 填空值；该字段在下挂设备数非零时必选;  |       |
|             |      |                                        |       |
|             |      | 注：对于三频设备，5G表示5.1G频段，5G   |       |
|             |      | -2表示5.8G频段；双频设备忽略5G-2频段； |       |
+-------------+------+----------------------------------------+-------+
| SSID        | St   | WLAN下挂设备的接入                     | N     |
|             | ring | SSID名称，对非WLAN下挂设备应填空值""； |       |
|             |      |                                        |       |
|             |      | 该字段在下挂设备数非零时必选；         |       |
+-------------+------+----------------------------------------+-------+
| RSSI        | St   | WLAN下挂设备当前的信号强度，单         | N     |
|             | ring | 位为dBm，对非WLAN下挂设备应填空值""；  |       |
|             |      |                                        |       |
|             |      | 该字段在下挂设备数非零时必选；         |       |
+-------------+------+----------------------------------------+-------+
| RxRate      | St   | 当前的协商接收速率(Mbps)；             | N     |
|             | ring |                                        |       |
|             |      | 该字段在下挂设备数非零时必选；         |       |
+-------------+------+----------------------------------------+-------+
| TxRate      | St   | 当前的协商发送速率(Mbps) ；            | N     |
|             | ring |                                        |       |
|             |      | 该字段在下挂设备数非零时必选；         |       |
+-------------+------+----------------------------------------+-------+
| RxRate_rt   | St   | 上行的实时接收速率(Mbps)；             | N     |
|             | ring |                                        |       |
|             |      | 该字段在下挂设备数非零时必选；         |       |
+-------------+------+----------------------------------------+-------+
| TxRate_rt   | St   | 上行的实时发送速率(Mbps) ；            | N     |
|             | ring |                                        |       |
|             |      | 该字段在下挂设备数非零时必选；         |       |
+-------------+------+----------------------------------------+-------+

成功示例：

{\"ID\":\"xxxxxxxx\",\"data\":{\"Devices\":\[{\"IPAddress\":\"192.168.10.1\",\"STAIPv6IPAddress\":\"2001:DA8:1000::F1\",\"MacAddress\":\"012233445566\",\"VMacAddress\":\"012233445566\",\"HostName\":\"huawei\",\"STAType\":\"phone\",\"UpTime\":\"650\",\"ConnectProtocol\":5,\"Radio\":\"2.4G\",\"SSID\":\"CMCC-1234\",\"RSSI\":\"-60\",\"RxRate\":\"144\",\"TxRate\":\"144\",\"RxRate_rt\":\"0\",\"TxRate_rt\":\"0\"},{\"IPAddress\":\"192.168.10.1\",\"STAIPv6IPAddress\":\"2001:DA8:1000::F1\",\"MacAddress\":\"0a2233445568\",\"VMacAddress\":\"0a2233445568\",\"DeviceName\":\"huawei\",\"STAType\":\"phone\",\"UpTime\":\"880\",\"ConnectProtocol\":5,\"Radio\":\"2.4G\",\"SSID\":\"CMCC-1234\",\"RSSI\":\"-56\",\"RxRate\":\"144\",\"TxRate\":\"144\",\"RxRate_rt\":\"0\",\"TxRate_rt\":\"0\"}\]}}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 收发报文统计 {#收发报文统计 .QB标题5}

接口说明：通过该消息查询组网终端当前的报文收发统计信息。

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-33 .QB标题6}

表7.2-55 收发报文统计请求

  --------------------------------------------------------------------------
  参数名      类型     描述                                       是否必须
  ----------- -------- ------------------------------------------ ----------
  RPCMethod   String   命令字，取值"WiFiStats"                    Y

  ID          String   事务ID。                                   Y
  --------------------------------------------------------------------------

## 响应 {#响应-33 .QB标题6}

表7.2-56 收发报文统计响应

+----------------+--------+------------------------------------+------+
| 参数名         | 类型   | 描述                               | 是否 |
|                |        |                                    | 必须 |
+================+========+====================================+======+
| ID             | String | 事务ID。                           | Y    |
+----------------+--------+------------------------------------+------+
| respCode       | Number | 接口调用失败时的响应码             | N    |
+----------------+--------+------------------------------------+------+
| respCont       | String | 接口调用失败时的返回值             | N    |
+----------------+--------+------------------------------------+------+
| data           | Object | 响应数据                           | Y    |
+----------------+--------+------------------------------------+------+
| Stats          | Array  | 每个用户侧接口的报文统             | Y    |
|                |        | 计数组（WLAN接口基于SSID统计；以太 |      |
|                |        | 网接口基于端口统计，并按接口序号从 |      |
|                |        | 小到大的次序依次出现在响应消息中） |      |
+----------------+--------+------------------------------------+------+
| Radio          | String | WLAN接口的频段                     | Y    |
|                |        | ，取值2.4G或5G或5G-2，以太接口填0  |      |
|                |        |                                    |      |
|                |        | 注：对                             |      |
|                |        | 于三频设备，5G表示5.1G频段，5G-2表 |      |
|                |        | 示5.8G频段；双频设备忽略5G-2频段； |      |
+----------------+--------+------------------------------------+------+
| Index          | Number | WLAN接口的SSID索引和以太接口序号   | Y    |
+----------------+--------+------------------------------------+------+
| SSID           | String | WL                                 | Y    |
|                |        | AN接口的SSID名称，非WLAN接口填空值 |      |
+----------------+--------+------------------------------------+------+
| TotalBytesSent | Long   | 总发送字节数                       | Y    |
+----------------+--------+------------------------------------+------+
| Tota           | Long   | 总接收字节数                       | Y    |
| lBytesReceived |        |                                    |      |
+----------------+--------+------------------------------------+------+
| To             | Long   | 总发送包数                         | Y    |
| talPacketsSent |        |                                    |      |
+----------------+--------+------------------------------------+------+
| TotalP         | Long   | 总接收包数                         | Y    |
| acketsReceived |        |                                    |      |
+----------------+--------+------------------------------------+------+
| ErrorsSent     | Long   | 发送出错的包数                     | Y    |
+----------------+--------+------------------------------------+------+
| ErrorsReceived | Long   | 接收的错误包数                     | Y    |
+----------------+--------+------------------------------------+------+
| Disc           | Long   | 发送时丢弃的包数                   | Y    |
| ardPacketsSent |        |                                    |      |
+----------------+--------+------------------------------------+------+
| DiscardP       | Long   | 接收时丢弃的包数                   | Y    |
| acketsReceived |        |                                    |      |
+----------------+--------+------------------------------------+------+

成功示例：

{\"ID\":\"xxxxxxxx\",\"data\":{\"Stats\":\[{\"Radio\":\"2.4G\",\"Index\":1,\"SSID\":\"CMCC-1234\",\"TotalBytesSent\":232343040,\"TotalBytesReceived\":232456790,\"TotalPacketsSent\":346870,\"TotalPacketsReceived\":457321,\"ErrorsSent\":21,\"ErrorsReceived\":0,\"DiscardPacketsSent\":0,\"DiscardPacketsReceived\":0},{\"Radio\":\"5G\",\"Index\":5,\"SSID\":\"CMCC-1234-5G\",\"TotalBytesSent\":232343040,\"TotalBytesReceived\":232456790,\"TotalPacketsSent\":346870,\"TotalPacketsReceived\":457321,\"ErrorsSent\":21,\"ErrorsReceived\":0,\"DiscardPacketsSent\":0,\"DiscardPacketsReceived\":0},{\"Radio\":\"0\",\"Index\":1,\"SSID\":\"\",\"TotalBytesSent\":232343040,\"TotalBytesReceived\":232456790,\"TotalPacketsSent\":346870,\"TotalPacketsReceived\":457321,\"ErrorsSent\":21,\"ErrorsReceived\":0,\"DiscardPacketsSent\":0,\"DiscardPacketsReceived\":0},{\"Radio\":\"0\",\"Index\":2,\"SSID\":\"\",\"TotalBytesSent\":0,\"TotalBytesReceived\":0,\"TotalPacketsSent\":0,\"TotalPacketsReceived\":0,\"ErrorsSent\":0,\"ErrorsReceived\":0,\"DiscardPacketsSent\":0,\"DiscardPacketsReceived\":0}\]}}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 设备信息周期/上电上报配置查询 {#设备信息周期上电上报配置查询 .QB标题5}

接口说明：省级数字家庭管理平台查询组网终端设备信息周期/上电上报配置信息。

请求方向：省级数字家庭管理平台 -\>组网终端

## 请求 {#请求-34 .QB标题6}

表7.2-57 设备信息周期/上电上报配置查询

  --------------------------------------------------------------------------
  参数名          类型     描述                                   是否必须
  --------------- -------- -------------------------------------- ----------
  RPCMethod       String   命令字，取值"ApReportConfigInfo"       Y

  ID              String   事务ID。                               Y
  --------------------------------------------------------------------------

## 响应 {#响应-34 .QB标题6}

表7.2-58 设备信息周期/上电上报配置查询响应

+--------------+------+-------------------------------------+---------+
| 参数名       | 类型 | 描述                                | 是      |
|              |      |                                     | 否必须  |
+==============+======+=====================================+=========+
| ID           | St   | 事务ID。                            | Y       |
|              | ring |                                     |         |
+--------------+------+-------------------------------------+---------+
| respCode     | Nu   | 接口调用失败时的响应码              | N       |
|              | mber |                                     |         |
+--------------+------+-------------------------------------+---------+
| respCont     | St   | 接口调用失败时的返回值              | N       |
|              | ring |                                     |         |
+--------------+------+-------------------------------------+---------+
| data         | Ob   | 响应数据                            | Y       |
|              | ject |                                     |         |
+--------------+------+-------------------------------------+---------+
| StatusRe     | St   | 设备W                               | N       |
| portInterval | ring | i-Fi状态/上联状态/周边Wi-Fi状态上报 |         |
|              |      | 周期，单位s（秒）；周期上报时间设备 |         |
|              |      | 以600秒（10分钟）为增加的基数，例如 |         |
|              |      | 600秒，1                            |         |
|              |      | 200秒，1800秒，默认14400秒（4小时） |         |
+--------------+------+-------------------------------------+---------+
| Re           | St   | 下挂设备上                          | Y       |
| portInterval | ring | 报周期，单位s(秒)；周期上报时间设备 |         |
|              |      | 以600秒（10分钟）为增加的基数，例如 |         |
|              |      | 600秒，1                            |         |
|              |      | 200秒，1800秒，默认1800秒（30分钟） |         |
+--------------+------+-------------------------------------+---------+
| Sa           | St   | 数据采样间                          | Y       |
| mpleInterval | ring | 隔，单位s(秒)，间隔时间设置以60秒为 |         |
|              |      | 基数增加（例如：60秒，120秒），默认 |         |
|              |      | 60s。采样间隔只用于统计收发速率信息 |         |
+--------------+------+-------------------------------------+---------+
| Uplink       | Nu   | 设备上行连接状态开关，              | Y       |
| StatusEnable | mber |                                     |         |
|              |      | 取值为1（True），0(False)           |         |
+--------------+------+-------------------------------------+---------+
| S            | Nu   | 设备下挂设备信息开关，              | Y       |
| taInfoEnable | mber |                                     |         |
|              |      | 取值为1（True），0(False)           |         |
+--------------+------+-------------------------------------+---------+
| WlanNe       | Nu   | 设备周边Wi-Fi信息，                 | Y       |
| ighborEnable | mber |                                     |         |
|              |      | 取值为1（True），0(False)           |         |
+--------------+------+-------------------------------------+---------+
| WiFi         | Nu   | 设备Wi-Fi状态信息，                 | Y       |
| StatusEnable | mber |                                     |         |
|              |      | 取值为1（True），0(False)           |         |
+--------------+------+-------------------------------------+---------+

成功示例：

{\"ID\":\"xxxxxxxx\",\"data\":{\"StatusReportInterval\":\"14400\",\"ReportInterval\":\"1800\",\"SampleInterval\":60,\"UpLinkStatusEnable\":1,\"StaInfoEnable\":1,\"WlanNeighborEnable\":1,\"WiFiStatusEnable\":1}}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 业务监测周期上报配置查询 {#业务监测周期上报配置查询 .QB标题5}

> 接口说明：省级数字家庭管理平台查询组网终端业务监测周期上报配置信息。
>
> 请求方向：省级数字家庭管理平台 -\>组网终端

## 请求 {#请求-35 .QB标题6}

表7.2-59 业务监测周期上报配置查询

  --------------------------------------------------------------------------
  参数名           类型     描述                                  是否必须
  ---------------- -------- ------------------------------------- ----------
  RPCMethod        String   命令字，取值"ServiceDataConfigInfo"   Y

  ID               String   事务ID。                              Y
  --------------------------------------------------------------------------

## 响应 {#响应-35 .QB标题6}

表7.2-60 业务监测周期上报配置查询响应

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  参数名                  类型     描述                                                                                                                          是否必须
  ----------------------- -------- ----------------------------------------------------------------------------------------------------------------------------- ----------
  ID                      String   事务ID。                                                                                                                      Y

  respCode                Number   接口调用失败时的响应码                                                                                                        N

  respCont                String   接口调用失败时的返回值                                                                                                        N

  data                    Object   响应数据                                                                                                                      Y

  ServiceNumber           Number   需要监测的业务数量                                                                                                            Y

  ReportInterval          String   数据上报周期，单位s(秒)，周期上报时间；设备以600秒（10分钟）为增加的基数，例如：600秒，1200秒，1800秒，默认1800秒（30分钟）   Y

  SampleInterval          String   数据采样间隔，单位s(秒)，间隔时间设置以60秒为基数增加（例如：60秒，120秒），默认60s。采样间隔只用于统计收发速率信息           Y

  ServiceConfig           Array    业务服务配置数组，考虑设备性能，最多配置8条                                                                                   Y

  ServiceUrl              String   监测业务Url                                                                                                                   Y

  TcpConnectInfoEnable    Number   TCP连接信息开关，取值为1（True），0(False)                                                                                    Y

  HttpConnectInfoEnable   Number   HTTP连接信息开关，取值为1（True），0(False)                                                                                   Y

  DnsParseInfoEnable      Number   DNS解析信息开关，取值为1（True），0(False)                                                                                    Y
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------

成功示例：

{\"ID\":\"xxxxxxxx\",\"data\":{\"ServiceNumber\":2,\"ReportInterval\":\"600\",\"SampleInterval\":\"60\",\"ServiceConfig\":\[{\"ServiceUrl\":\"www.baidu.com\",\"TcpConnectInfoEnable\":1,\"HttpConnectInfoEnable\":1,\"DnsParseInfoEnable\":1},{\"ServiceUrl\":\"www.taobao.com\",\"TcpConnectInfoEnable\":1,\"HttpConnectInfoEnable\":1,\"DnsParseInfoEnable
\":1}\]}}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 周边Wi-Fi信息 {#周边wi-fi信息-1 .QB标题5}

> 接口说明：省级数字家庭管理平台查询组网终端周边Wi-Fi信息。
>
> 请求方向：省级数字家庭管理平台 -\>组网终端

## 请求 {#请求-36 .QB标题6}

表7.2-61 周边Wi-Fi信息请求

+---------------+--------+----------------------------------+--------+
| 参数名        | 类型   | 描述                             | 是     |
|               |        |                                  | 否必须 |
+===============+========+==================================+========+
| RPCMethod     | String | 命令字，取值"WlanNeighborInfo"   | Y      |
+---------------+--------+----------------------------------+--------+
| ID            | String | 事务ID。                         | Y      |
+---------------+--------+----------------------------------+--------+
| data          | Object | 终端要解析的数据包               | Y      |
+---------------+--------+----------------------------------+--------+
| [WlanNeighbo  | [Nu    | [周边W                           | N      |
| rType]{.mark} | mber]{ | i-Fi扫描类型；枚举取值；]{.mark} |        |
|               | .mark} |                                  |        |
|               |        | [取值为                          |        |
|               |        | 1（全信道扫描），0(工作信道监测) |        |
|               |        | ；]{.mark}                       |        |
|               |        |                                  |        |
|               |        | 说明：                           |        |
|               |        | 该值缺失时，默认执行工作信道监测 |        |
+---------------+--------+----------------------------------+--------+

## 响应 {#响应-36 .QB标题6}

表7.2-62 周边Wi-Fi信息响应

+--------+------+--------------------------------------------+--------+
| 参数名 | 类型 | 描述                                       | 是     |
|        |      |                                            | 否必须 |
+========+======+============================================+========+
| ID     | St   | 事务ID。                                   | Y      |
|        | ring |                                            |        |
+--------+------+--------------------------------------------+--------+
| re     | Nu   | 接口调用失败时的响应码                     | N      |
| spCode | mber |                                            |        |
+--------+------+--------------------------------------------+--------+
| re     | St   | 接口调用失败时的返回值                     | N      |
| spCont | ring |                                            |        |
+--------+------+--------------------------------------------+--------+
| data   | Ob   | 响应数据                                   | Y      |
|        | ject |                                            |        |
+--------+------+--------------------------------------------+--------+
| Number | Nu   | 周                                         | Y      |
|        | mber | 边Wi-Fi数量，当值为0时，Wi-Fi信息数组为空  |        |
+--------+------+--------------------------------------------+--------+
| Radios | A    | 周边Wi-Fi信息数组，当周边Wi-Fi不为0时有效  | N      |
|        | rray |                                            |        |
+--------+------+--------------------------------------------+--------+
| Radio  | St   | 频段：2.4G、5G                             | N      |
|        | ring |                                            |        |
+--------+------+--------------------------------------------+--------+
| SSID   | St   | 周边Wi-Fi的SSID名称                        | N      |
|        | ring |                                            |        |
+--------+------+--------------------------------------------+--------+
| MacA   | St   | 周边Wi-Fi的MAC地址，格式为不带冒号并且大写 | N      |
| ddress | ring |                                            |        |
+--------+------+--------------------------------------------+--------+
| C      | St   | 周边Wi-Fi信道，如                          | N      |
| hannel | ring | 存在多个信道，可用","逗号分隔，例如："1,6" |        |
+--------+------+--------------------------------------------+--------+
| Ban    | Nu   | 周边Wi-Fi频宽                              | N      |
| dwidth | mber | ，采用枚举取值：周边Wi-Fi数量非零时必选；  |        |
|        |      |                                            |        |
|        |      | 1：20MHz                                   |        |
|        |      |                                            |        |
|        |      | 2：40MHz                                   |        |
|        |      |                                            |        |
|        |      | 3：80MHz                                   |        |
|        |      |                                            |        |
|        |      | 4：160MHz                                  |        |
|        |      |                                            |        |
|        |      | 5：80+80MHz                                |        |
|        |      |                                            |        |
|        |      | 0：自适应频宽                              |        |
+--------+------+--------------------------------------------+--------+
| RSSI   | St   | 周边Wi-Fi的信号强度值                      | N      |
|        | ring |                                            |        |
+--------+------+--------------------------------------------+--------+
| Lo     | Nu   | 信道使用率（%），数据范围：0-100；         | N      |
| adRate | mber |                                            |        |
+--------+------+--------------------------------------------+--------+
| Wifist | Nu   | 周边Wi-Fi使用的无线标准                    | N      |
| andard | mber | ，采用枚举取值：周边Wi-Fi数量非零时必选；  |        |
|        |      |                                            |        |
|        |      | 0：:802.11a或802.11b                       |        |
|        |      |                                            |        |
|        |      | 1：802.11b/g                               |        |
|        |      |                                            |        |
|        |      | 2：802.11b/g/n                             |        |
|        |      |                                            |        |
|        |      | 3：802.11a/n/ac                            |        |
|        |      |                                            |        |
|        |      | 4：802.11b/g/n/ax                          |        |
|        |      |                                            |        |
|        |      | 5：802.11a/n/ac/ax                         |        |
|        |      |                                            |        |
|        |      | 6：802.11a/n                               |        |
|        |      |                                            |        |
|        |      | 7：802.11n                                 |        |
|        |      |                                            |        |
|        |      | 8：802.11g                                 |        |
|        |      |                                            |        |
|        |      | 9：802.11g/n                               |        |
+--------+------+--------------------------------------------+--------+

注：

① 当周边Wi-Fi数量超过24时，按RSSI信号强度从大道小上报24个周边Wi-Fi信息；

②当平台下发扫描指令时，AP按平台下发扫描要求（全信道或工作信道）进行扫描；当平台未下发扫描范围或扫描方案的参数错误时，默认执行工作信道扫描。

成功示例：

{\"ID\":\"xxxxxxxx\",\"data\":{\"Number\":2,\"Radios\":\[{\"Radio\":\"2.4G\",\"SSID\":\"CMCC-1234\",\"MacAddress\":\"0A2233445568\",\"Channel\":2,\"Bandwidth\":1,\"RSSI\":\"-60\",\"LoadRate\":50,\"Wifistandard\":4},{\"Radio\":\"5G\",\"SSID\":\"CMCC-1234\",\"MacAddress\":\"0B2233445566\",\"Channel\":4,\"Bandwidth\":4,\"RSSI\":\"-60\",\"LoadRate\":10,\"Wifistandard\":4}\]}}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## Ping测试 {#ping测试 .QB标题5}

> 接口说明：通过该消息组网终端进行Ping测试并响应测试结果。
>
> 请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-37 .QB标题6}

表7.2-63 Ping测试

  --------------------------------------------------------------------------
  参数名      类型     描述                                       是否必须
  ----------- -------- ------------------------------------------ ----------
  RPCMethod   String   命令字，取值"PingTest"                     Y

  ID          String   事务ID。                                   Y

  data        Object   终端要解析的数据包                         Y

  PingHost    String   Ping 诊断测试目标服务器IP或域名            Y

  PingSize    Number   Ping 发包字节大小（默认32）                Y

  PingCount   Number   Ping发包数（默认4次）                      Y
  --------------------------------------------------------------------------

> 示例：

{\"RPCMethod\":\"PingTest\",\"ID\":\"xxxxxxxx\",\"data\":{\"PingHost\":\"www.baidu.com\",\"PingSize\":32,\"PingCount\":4}}

## 响应 {#响应-37 .QB标题6}

表7.2-64 Ping测试响应

  ------------------------------------------------------------------------------
  参数名             类型       描述                                  是否必须
  ------------------ ---------- ------------------------------------- ----------
  ID                 String     事务ID。                              Y

  respCode           Number     接口调用失败时的响应码                N

  respCont           String     接口调用失败时的返回值，              N

  data               Object     响应数据                              Y

  HostIp             String     Ping目标地址响应服务器IP地址          Y

  AverResponseTime   Number     Ping平均返回时间，单位：毫秒          Y

  MaxResponseTime    Number     Ping最大返回时间，单位：毫秒          Y

  MinResponseTime    Number     Ping最小返回时间，单位：毫秒          Y

  MTU                Number     Ping包数据块大小，单位bytes           Y

  PingNumber         Number     Ping总次数                            Y

  PingSucessNumber   Number     Ping成功次数                          Y
  ------------------------------------------------------------------------------

> 成功示例：

{\"ID\":\"xxxxxxxx\",\"data\":{\"HostIp\":\"www.baidu.com\",\"AverResponseTime\":5,\"MaxResponseTime\":8,\"MinResponseTime
\":2,\"MTU\":32,\"PingNumber\":4,\"PingSucessNumber\":4}}

> 失败示例：{\"ID \":\"xxxxxxxx
> \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## Traceroute测试 {#traceroute测试 .QB标题5}

> 接口说明：通过该消息组网终端进行路由路径追踪测试并响应测试结果。
>
> 请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-38 .QB标题6}

表7.2-65 Traceroute测试

  -------------------------------------------------------------------------------
  参数名           类型     描述                                       是否必须
  ---------------- -------- ------------------------------------------ ----------
  RPCMethod        String   命令字，取值"TracerouteTest"               Y

  ID               String   事务ID。                                   Y

  data             Object   终端要解析的数据包                         Y

  TracerouteHost   String   Traceroute目标IP或者域名                   Y

  Maxhops          Number   路由诊断目标最大跃点数                     Y

  Timeout          Number   等待回复的超时时间，单位ms(毫秒)           Y
  -------------------------------------------------------------------------------

> 示例：

{\"RPCMethod\":\"TracerouteTest\",\"ID\":\"xxxxxxxx\",\"data\":{\"TracerouteHost\":\"www.baidu.com\",\"Maxhops\":10,\"Timeout\":30}}

## 响应 {#响应-38 .QB标题6}

表7.2-66 Traceroute测试响应

  --------------------------------------------------------------------------------------
  参数名          类型       描述                                             是否必须
  --------------- ---------- ------------------------------------------------ ----------
  ID              String     事务ID                                           Y

  respCode        Number     接口调用失败时的响应码                           N

  respCont        String     接口调用失败时的返回值                           N

  data            Object     响应数据                                         Y

  HostIp          String     路由诊断目标主机Ip地址                           Y

  HopsNumber      Number     总跳数                                           Y

  RouteHopsInfo   Array      诊断记录列表                                     Y

  HopCount        Number     跃点                                             Y

  HopHostIp       String     跃点主机IP地址，成功返回跃点IP，失败返回错识码   Y

  HopRTTimes1     Number     跃点往返时间1                                    Y

  HopRTTimes2     Number     跃点往返时间2                                    Y

  HopRTTimes3     Number     跃点往返时间3                                    Y
  --------------------------------------------------------------------------------------

> 成功示例：

{\"ID\":\"xxxxxxxx\",\"data\":{\"HostIp\":\"47.252.33.193\",\"HopsNumber\":10,\"RouteHopsInfo\":\[{\"HopCount\":1,\"HopHostIp\":\"172.20.0.1\",\"HopRTTimes1\":2,\"HopRTTimes2\":1,\"HopRTTime3\":2},{\"HopCount\":2,\"HopHostIp\":\"10.164.0.1\",\"HopRTTimes1\":44,\"HopRTTimes2\":53,\"HopRTTime3\":41},{\"HopCount\":3,\"HopHostIp\":\"192.168.13.69\",\"HopRTTimes1\":67,\"HopRTTimes2\":0,\"
HopRTTime3\":0}\]}}

> 失败示例：{\"ID \":\"xxxxxxxx
> \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## HTTP下载测试 {#http下载测试 .QB标题5}

> 接口说明：通过该消息组网终端进行Http下载测试并响应测试结果。
>
> 请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-39 .QB标题6}

表7.2-67 HTTP下载测试

  ------------------------------------------------------------------------------
  参数名                类型     描述                                 是否必须
  --------------------- -------- ------------------------------------ ----------
  RPCMethod             String   命令字，取值"HttpDownloadTest"       Y

  ID                    String   事务ID。                             Y

  data                  Object   终端要解析的数据包                   Y

  HttpDownloadUrl       String   Http下载url地址                      Y

  HttpDownloadTimeout   Number   Http下载超时时间，单位：毫秒         Y
  ------------------------------------------------------------------------------

> 示例：

{\"RPCMethod\":\"HttpDowloadTest\",\"ID\":\"xxxxxxxx\",\"data\":{\"HttpDownloadUrl\":\"http://httpsdownloadtest/test\",\"HttpDownloadTimeout\":100}}

## 响应 {#响应-39 .QB标题6}

表7.2-68 HTTP下载测试响应

  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  参数名         类型     描述                                                                                                                                                                       是否必须
  -------------- -------- -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------
  ID             String   事务ID。                                                                                                                                                                   Y

  respCode       Number   接口调用失败时的响应码                                                                                                                                                     N

  respCont       String   接口调用失败时的返回值                                                                                                                                                     N

  data           Object   响应数据                                                                                                                                                                   Y

  DownloadRate   String   Http下载速率，建议选择大小为10MB左右文件进行测试，当下载超时时，下载速率=当前下载完成文件大小/超时时间。当在超时时间内完成下传，下载速率=文件大小/下载完成时间，单位Mbps   Y
  -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

> 成功示例：{\"ID\":\"xxxxxxxx\",\"data\":{\"DownloadRate\":\"1000\"}}
>
> 失败示例：{\"ID \":\"xxxxxxxx
> \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## Web访问测试 {#web访问测试 .QB标题5}

> 接口说明：通过该消息组网终端进行web访问测试并响应测试结果。
>
> 请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-40 .QB标题6}

表7.2-69 web访问测试

  ---------------------------------------------------------------------------
  参数名      类型     描述                                        是否必须
  ----------- -------- ------------------------------------------- ----------
  RPCMethod   String   命令字，取值"WebTest"                       Y

  ID          String   事务ID。                                    Y

  data        Object   终端要解析的数据包                          Y

  WebUrl      String   Web访问Url地址                              Y
  ---------------------------------------------------------------------------

示例：{\"RPCMethod\":\"WebTest\",\"ID\":\"xxxxxxxx\",\"data\":{\"WebUrl\":\"http://www.baidu.com\"}}

## 响应 {#响应-40 .QB标题6}

表7.2-70 Web访问测试响应

  -------------------------------------------------------------------------------
  参数名               类型      描述                                  是否必须
  -------------------- --------- ------------------------------------- ----------
  ID                   String    事务ID。                              Y

  respCode             Number    接口调用失败时的响应码                N

  respCont             String    接口调用失败时的返回值                N

  data                 Object    响应数据                              Y

  URL                  String    访问网页地址                          Y

  ConnectDelay         Number    建立连接时延，单位：毫秒              Y

  FirstResponseDelay   Number    首次响应时延，单位：毫秒              Y

  FirstPageTime        Number    首屏下载时长，单位：毫秒              Y

  PingDelay            Number    Ping时延                              Y

  DnsParseDelay        Number    DNS解析时长                           Y

  DnsParseResult       String    DNS解析结果                           Y
  -------------------------------------------------------------------------------

> 成功示例：

{\"ID\":\"xxxxxxxx\",\"data\":{\"URL\":\"http://www.baidu.com\",\"ConnectDelay\":10,\"FirstResponseDelay\":10,\"FirstPageTime\":10,\"PingDelay\":\"10\",\"DnsParseDelay\":10,\"DnsParseResult\":\"XX.XX.XX.XX\"}}

> 失败示例：{\"ID \":\"xxxxxxxx
> \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 视频网络质量测试 {#视频网络质量测试 .QB标题5}

> 接口说明：通过该消息组网终端进行视频网络质量测试并响应测试结果。
>
> 请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-41 .QB标题6}

表7.2-71 视频网络质量测试

  --------------------------------------------------------------------------
  参数名        类型       描述                                   是否必须
  ------------- ---------- -------------------------------------- ----------
  RPCMethod     String     命令字，取值"VideoQualityTest"         Y

  ID            String     事务ID。                               Y

  data          Object     终端要解析的数据包                     Y

  VideoServer   String     视频质量测试服务器地址IP或域名         Y
  --------------------------------------------------------------------------

> 示例：
>
> {\"RPCMethod\":\"VideQualityTest\",\"ID\":\"xxxxxxxx\",\"data\":{\"VideoServer\":\"http://www.iqiyi.com\"}}

## 响应 {#响应-41 .QB标题6}

表7.2-72 视频网络质量测试响应

  ---------------------------------------------------------------------------
  参数名         类型     描述                                     是否必须
  -------------- -------- ---------------------------------------- ----------
  ID             String   事务ID。                                 Y

  respCode       Number   接口调用失败时的响应码                   N

  respCont       String   接口调用失败时的返回值                   N

  data           Object   响应数据                                 Y

  VideoServer    String   视频服务器地址                           Y

  ResponseTime   Number   视频服务器响应时长，单位：毫秒           Y
  ---------------------------------------------------------------------------

> 成功示例：
>
> {\"ID\":\"xxxxxxxx\",\"data\":{\"VideoServer\":\"http://www.iqiyi.com\",\"ResponseTime
> \":10}}
>
> 失败示例：{\"ID \":\"xxxxxxxx
> \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 游戏网络质量测试 {#游戏网络质量测试 .QB标题5}

> 接口说明：通过该消息组网终端进行游戏网络质量测试并响应测试结果。
>
> 请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-42 .QB标题6}

表7.2-73 游戏网络质量测试

  ------------------------------------------------------------------------
  参数名       类型       描述                                  是否必须
  ------------ ---------- ------------------------------------- ----------
  RPCMethod    String     命令字，取值"GameQualityTest"         Y

  ID           String     事务ID。                              Y

  data         Object     终端要解析的数据包                    Y

  GameServer   String     游戏质量测试服务器地址IP或者域名      Y
  ------------------------------------------------------------------------

> 示例：
>
> {\"RPCMethod\":\"GameQualityTest\",\"ID\":\"xxxxxxxx\",\"data\":{\"GameServer\":\"http://www.XXXX.com\"}}

## 响应 {#响应-42 .QB标题6}

表7.2-74 游戏网络质量测试响应

  -------------------------------------------------------------------------------
  参数名           类型      描述                                      是否必须
  ---------------- --------- ----------------------------------------- ----------
  ID               String    事务ID。                                  Y

  respCode         Number    接口调用失败时的响应码                    N

  respCont         String    接口调用失败时的返回值                    N

  data             Object    响应数据                                  Y

  GameServer       String    游戏服务器地址                            Y

  NetDelay         Number    游戏服务器网络时延，单位：毫秒            Y

  JitterDelay      Number    时延抖动，单位：毫秒                      Y

  PacketLostRate   Number    丢包率，单位%                             Y
  -------------------------------------------------------------------------------

> 成功示例：

{\"ID\":\"xxxxxxxx\",\"data\":{\"GameServer\":\"http://www.XXXX.com\",\"NetDelay\":10,\"JitterDelay\":10,\"PacketLostRate\":1}}

> 失败示例：{\"ID \":\"xxxxxxxx
> \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 网络拓扑查询 {#网络拓扑查询 .QB标题5}

> 接口说明：通过该消息组网终端进行家庭网络拓扑结构查询并响应查询结果。
>
> 请求方向：省级数字家庭管理平台-\>组网终端
>
> 说明：该接口仅要求Controller或AC终端支持；

## 请求 {#请求-43 .QB标题6}

表7.2-75 家庭网络拓扑结构查询

  -------------------------------------------------------------------------
  参数名       类型       描述                                   是否必须
  ------------ ---------- -------------------------------------- ----------
  RPCMethod    String     命令字，取值"MAPTopology"              Y

  ID           String     事务ID。                               Y
  -------------------------------------------------------------------------

> 示例：{\"RPCMethod \":\"MAPTopology\",\"ID \":\"xxxxxxxx\"}

## 响应 {#响应-43 .QB标题6}

表7.2-76 家庭网络拓扑结构查询响应

+------------+-------+----------------------------------------+-------+
| 参数名     | 类型  | 描述                                   | 是否  |
|            |       |                                        | 必须  |
+============+=======+========================================+=======+
| ID         | S     | 事务ID。                               | Y     |
|            | tring |                                        |       |
+------------+-------+----------------------------------------+-------+
| respCode   | N     | 接口调用失败时的响应码                 | N     |
|            | umber |                                        |       |
+------------+-------+----------------------------------------+-------+
| respCont   | S     | 接口调用失败时的返回值                 | N     |
|            | tring |                                        |       |
+------------+-------+----------------------------------------+-------+
| data       | O     | 响应数据                               | Y     |
|            | bject |                                        |       |
+------------+-------+----------------------------------------+-------+
| Devices    | Array | 家庭拓扑网络信息                       | Y     |
+------------+-------+----------------------------------------+-------+
| meshRole   | N     | Mesh角色（枚举）：                     | Y     |
|            | umber |                                        |       |
|            |       | 0：非mesh终端；                        |       |
|            |       |                                        |       |
|            |       | 1：controller；                        |       |
|            |       |                                        |       |
|            |       | 2：agent；                             |       |
|            |       |                                        |       |
|            |       | 3：AC；                                |       |
|            |       |                                        |       |
|            |       | 4：AP                                  |       |
|            |       |                                        |       |
|            |       | 说明：AP专指面板式AP；                 |       |
+------------+-------+----------------------------------------+-------+
| MacAddress | S     | 拓扑终端                               | Y     |
|            | tring | 自身MAC地址，应同终端铭牌MAC保持一致； |       |
+------------+-------+----------------------------------------+-------+
| UpTime     | S     | 在线时长，单位：秒                     | Y     |
|            | tring |                                        |       |
+------------+-------+----------------------------------------+-------+
| IPAddress  | S     | 拓扑终端IPv4地址；                     | N     |
|            | tring |                                        |       |
+------------+-------+----------------------------------------+-------+
| IPv        | S     | 拓扑终端IPv6地址；                     | N     |
| 6IPAddress | tring |                                        |       |
+------------+-------+----------------------------------------+-------+
| STANumber  | N     | 下挂设备数量                           | Y     |
|            | umber |                                        |       |
+------------+-------+----------------------------------------+-------+
| Ba         | O     | MA                                     | Y     |
| ckhaulinfo | bject | P设备的上联backhaul信息，包含UplinkTyp |       |
|            |       | e、Radio、MapAlmac、RxRate、TxRate字段 |       |
+------------+-------+----------------------------------------+-------+
| UplinkType | S     | 拓扑终端上行接入方式                   | Y     |
|            | tring | ：WLAN、Ethernet、PLC、Cable、Optical  |       |
|            |       | Ethernet、GPON、XGPON、PoE             |       |
+------------+-------+----------------------------------------+-------+
| Radio      | S     | 拓扑终端WLAN                           | N     |
|            | tring | 上联时使用的频段，取值2.4G、5G或5G-2； |       |
|            |       |                                        |       |
|            |       | 注：对于三频设备，5G表示5.1G频段，5G   |       |
|            |       | -2表示5.8G频段；双频设备忽略5G-2频段； |       |
+------------+-------+----------------------------------------+-------+
| MapAlmac   | S     | 拓扑终端上联使用的管理Almac地址，如果  | Y     |
|            | tring | meshRole取值为controller或AC           |       |
|            |       | 时，则该字段表示上联设备的链路MAC地址; |       |
|            |       |                                        |       |
|            |       | 说明：拓扑终端MapAl                    |       |
|            |       | mac应同拓扑上联终端的铭牌MAC保持一致； |       |
+------------+-------+----------------------------------------+-------+
| RxRate     | S     | 拓扑终端上行协商接收速率(Mbps)         | Y     |
|            | tring |                                        |       |
+------------+-------+----------------------------------------+-------+
| TxRate     | S     | 拓扑终端上行协商发送速率(Mbps)         | Y     |
|            | tring |                                        |       |
+------------+-------+----------------------------------------+-------+

> 成功示例：

{\"ID\":\"xxxxxxxx\",\"data\":{\"Devices\":\[{\"MacAddress\":\"11223344AABB\",\"meshRole\":1,\"UpTime\":\"500\",\"IPAddress\":\"192.168.10.1\",\"IPv6IPAddress\":\"2001:DA8:1000::F1\",\"STANumber\":2,\"Backhaulinfo\":{\"UplinkType\":\"Ethernet\",\"MapAlmac\":\"AABBCCDD0123\",\"RxRate\":\"1000\",\"TxRate\":\"1000\"}},{\"MacAddress\":\"11223344AACC\",\"meshRole\":2,\"UpTime\":\"400\",\"IPAddress\":\"192.168.10.2\",\"IPv6IPAddress\":\"2001:DA8:1000::F5\",\"STANumber\":3,\"Backhaulinfo\":{\"UplinkType\":\"Ethernet\",\"MapAlmac\":\"11223344AABB\",\"RxRate\":\"1000\",\"TxRate\":\"1000\"}},{\"MacAddress\":\"11223344AADD\",\"meshRole\":2,\"UpTime\":\"300\",\"IPAddress\":\"192.168.10.3\",\"IPv6IPAddress\":\"2001:DA8:1000::FA\",\"STANumber\":4,\"Backhaulinfo\":{\"UplinkType\":\"WLAN\",\"MapAlmac\":\"11223344AACC\",\"RxRate\":\"2401\",\"TxRate\":\"2401\"}}\]}}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

##  端口参数查询 {#端口参数查询 .QB标题5}

接口说明：通过该接口实现路由器端口参数（包含有线端口、无线端口）信息获取，并上报省级组网管理平台；

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-44 .QB标题6}

表7.2-77 端口参数查询

  -------------------------------------------------------------------------
  参数名       类型       描述                                   是否必须
  ------------ ---------- -------------------------------------- ----------
  RPCMethod    String     命令字，取值"InternetAccessInfo"       Y

  ID           String     事务ID。                               Y
  -------------------------------------------------------------------------

示例： {\"RPCMethod\":\"InternetAccessInfo\",\"ID\":\"xxxxxxxx\"}

## 响应 {#响应-44 .QB标题6}

表1-12 端口参数查询接口响应参数表

  ---------------- --------- ------------------------------------- ----------
  参数名           类型      描述                                  是否必须

  ID               String    事务ID。                              Y

  respCode         Number    响应码，0为成功，详见附录B            Y

  respCont         String    接口调用失败时的返回值；              N

  data             Object    响应数据                              Y

  portInfoList     Array     端口号信息的数组                      Y

  portType         Number    端口类型：0：WAN，1：LAN              Y

  portRate         String    端口速率(百兆、千兆)，协商速率        Y

  portMac          String    端口MAC                               Y

  portConnection   Number    端口连接情况：0：已连接，1：未连接    Y
  ---------------- --------- ------------------------------------- ----------

成功示例：

{\"ID\":\"xxxxxxxx\",\"respCode\":0,\"data\":{\"portInfoList\":\[{\"portType\":0,\"portRate\":\"XXXX\",\"portMac\":\"XXXX\",\"portConnection\":0},{\"portType\":1,\"portRate\":\"XXXX\",\"portMac\":\"XXXX\",\"portConnection\":0},{\"portType\":1,\"portRate
\":\"XXXX\",\"portMac \":\"XXXX\",\"portConnection\":1}\]}}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

##  扩展信息查询 {#扩展信息查询 .QB标题5}

接口说明：通过该消息查询组网终端的扩展配置信息，包含VLAN配置信息查询和QoS配置信息查询；

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-45 .QB标题6}

表7.2-77 端口参数查询

  -------------------------------------------------------------------------
  参数名       类型       描述                                   是否必须
  ------------ ---------- -------------------------------------- ----------
  RPCMethod    String     命令字，取值"ApConfigInfo2"            Y

  ID           String     事务ID。                               Y
  -------------------------------------------------------------------------

示例： {\"RPCMethod\":\" ApConfigInfo2\",\"ID\":\"xxxxxxxx\"}

## 响应 {#响应-45 .QB标题6}

表1-14 信息查询接口响应参数表

+---------------+-------+------------------------------------+--------+
| 参数名        | 类型  | 描述                               | 是     |
|               |       |                                    | 否必须 |
+===============+=======+====================================+========+
| ID            | S     | 事                                 | Y      |
|               | tring | 务ID，平台下发给设备的指令都携带事 |        |
|               |       | 务ID号，要求返回执行结果时，必须携 |        |
|               |       | 带该ID，以便于对设备执行指令的管理 |        |
|               |       | 。使设备能够实现并行任务指行能力。 |        |
+---------------+-------+------------------------------------+--------+
| respCode      | N     | 响应码， 0为成功，详见附录B        | Y      |
|               | umber |                                    |        |
+---------------+-------+------------------------------------+--------+
| respCont      | S     | 接口调用失败时的返回值             | N      |
|               | tring |                                    |        |
+---------------+-------+------------------------------------+--------+
| data          | O     | 响应数据                           | Y      |
|               | bject |                                    |        |
+---------------+-------+------------------------------------+--------+
| VlanEnable    | N     | IPTV业务开关；1：打开，0：关闭     | Y      |
|               | umber |                                    |        |
+---------------+-------+------------------------------------+--------+
| VlanId        | N     | IPTV业务的VLAN                     | N      |
|               | umber | ID；IPTV业务开关打开时必选；       |        |
+---------------+-------+------------------------------------+--------+
| [MulticastE   | [Numb | [组播转单播开关；0: 关闭，1:       | [N]{   |
| nable]{.mark} | er]{. | 开启]{.mark}                       | .mark} |
|               | mark} |                                    |        |
+---------------+-------+------------------------------------+--------+
| IptvStatus    | Array | 用户侧接口的                       | N      |
|               |       | VLAN参数；IPTV业务开关打开时必选； |        |
+---------------+-------+------------------------------------+--------+
| Radio         | S     | 端口信息，对于WLAN接口的频段，取   | N      |
|               | tring | 值2.4G或5G或5G-2，对于以太接口，取 |        |
|               |       | 值为LAN；IPTV业务开关打开时必选；  |        |
|               |       |                                    |        |
|               |       | 注：对                             |        |
|               |       | 于三频设备，5G表示5.1G频段，5G-2表 |        |
|               |       | 示5.8G频段；双频设备忽略5G-2频段； |        |
+---------------+-------+------------------------------------+--------+
| Index         | N     | WLAN接口的SSID索引或以太           | N      |
|               | umber | 接口序号；IPTV业务开关打开时必选； |        |
+---------------+-------+------------------------------------+--------+
| QosEnable     | N     | QoS开关；1：打开，0：关闭          | Y      |
|               | umber |                                    |        |
+---------------+-------+------------------------------------+--------+
| QosParameter  | Array | QoS分类规则                        | N      |
+---------------+-------+------------------------------------+--------+
| QosPriority   | N     | QoS优先级；取                      | N      |
|               | umber | 值范围：0-7；数值越大优先级越高；  |        |
+---------------+-------+------------------------------------+--------+
| DscpEnable    | N     | DSCP优先级开关；1：打开，0：关闭   | N      |
|               | umber |                                    |        |
+---------------+-------+------------------------------------+--------+
| DscpPriority  | N     | DSCP优先级；取                     | N      |
|               | umber | 值范围：0-63；数值越大优先级越高； |        |
+---------------+-------+------------------------------------+--------+
| Vl            | N     | 802.1P启用开关；1：打开，0关闭     | N      |
| an8021pEnable | umber |                                    |        |
+---------------+-------+------------------------------------+--------+
| Vlan8021p     | N     | VLAN优先级；取                     | N      |
|               | umber | 值范围：0-7；数值越大优先级越高；  |        |
+---------------+-------+------------------------------------+--------+
| SourceIp      | S     | 源IP                               | N      |
|               | tring |                                    |        |
+---------------+-------+------------------------------------+--------+
| SourcePort    | S     | 源端口                             | N      |
|               | tring |                                    |        |
+---------------+-------+------------------------------------+--------+
| DestinationIp | S     | 目的地IP                           | N      |
|               | tring |                                    |        |
+---------------+-------+------------------------------------+--------+
| De            | S     | 目的地端口                         | N      |
| stinationPort | tring |                                    |        |
+---------------+-------+------------------------------------+--------+
| Protocol      | S     | 传输协议列表，多种协议时使用逗     | N      |
|               | tring | 号进行分割；取值为：TCP，UDP，ICMP |        |
+---------------+-------+------------------------------------+--------+
| SourceMac     | S     | 源MAC（一般指路由器铭牌MAC）       | N      |
|               | tring |                                    |        |
+---------------+-------+------------------------------------+--------+
| D             | S     | 目的MAC（一般指下挂设备MAC）       | N      |
| estinationMac | tring |                                    |        |
+---------------+-------+------------------------------------+--------+
| DnsSetEnable  | N     | DNS                                | Y      |
|               | umber | Se                                 |        |
|               |       | rver手动设置开关；1：打开，0：关闭 |        |
+---------------+-------+------------------------------------+--------+
| PreDnsServer  | S     | 首选DNS服务器地址                  | N      |
|               | tring | ，若DnsSetEnable为1，则此项必选。  |        |
+---------------+-------+------------------------------------+--------+
| AltDnsServer  | S     | 备选DNS服务器地址                  | N      |
|               | tring |                                    |        |
+---------------+-------+------------------------------------+--------+

成功示例：

{\"ID\":\"xxxxxxxx\",\"respCode\":0,\"data\":{\"VlanEnable\":1,\"VlanId\":46,[\"MulticastEnable\":1]{.mark},\"IptvStatus\":\[{\"Radio\":\"5G\",\"Index\":5},{\"Radio\":\"2.4G\",\"Index\":1},{\"Radio\":\"0\",\"Index\":1},{\"Radio\":\"0\",\"Index\":3}\],\"QosEnable\":1,\"QosParameter\":\[{\"QosPriority\":5,\"DscpEnable\":1,\"DscpPriority\":45,\"SourceMac\":\"AABBCCDDEEFF\",\"DestinationMac\":\"\*\*\*\*\*\*\*\*\*\*\*\*\"},{\"QosPriority\":6,\"Vlan8021pEnable\":1,\"Vlan8021p\":6,\"SourceIp\":\"224.xx.xx.xx\",\"SourcePort\":\"\*\*\*\*\",\"DestinationIp\":\"xx.xx.xx.xx\",\"DestinationPort\":\"\*\*\*\*\",\"Protocol\":\"ICMP\"}\],\"DnsSetEnable\":1,\"PreDnsServer\":\"xx.xx.xx.xx\",\"AltDnsServe\":\"xx.xx.xx.xx\"}}

##  日志查询 {#日志查询 .QB标题5}

> 接口说明：通过该消息组网终端进行日志查询并响应查询结果。
>
> 请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-46 .QB标题6}

表7.2-77 终端日志查询

  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  参数名       类型       描述                                                                                                                                                        是否必须
  ------------ ---------- ----------------------------------------------------------------------------------------------------------------------------------------------------------- ----------
  RPCMethod    String     命令字，取值"logReport"                                                                                                                                     Y

  ID           String     事务ID。                                                                                                                                                    Y

  TimeOut      Number     收集日志的超时时间，单位秒。从起点日志收集开始，收集TimeOut时长日志信息，同时把生成的日志文件上传到平台；若下发TimeOut参数为"0"，则上报插件存储日志信息；   Y

  LogUrl       String     上报日志的HTTP URL地址，举例：https://server:port/rest/logreport/1.0?access_token=keisda73nc6hn234k5kj6j78k1j34n5n4n6n7l9f&mac=22-33-44-55-66-77;           Y

  LogLevel     Number     日志级别，0表示DEBUG，1表示INFO, 2表示ERROR；                                                                                                               Y
  ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

> 示例：{\"RPCMethod\":\"logReport\",\"ID\":\"xxxxxxxx\",\"TimeOut\":100,\"LogUrl\":\"https://xxxxxx\",\"LogLevel\":1}

## 响应 {#响应-46 .QB标题6}

表7.2-78 终端日志查询响应

  ---------------------------------------------------------------------------
  参数名        类型     描述                                      是否必须
  ------------- -------- ----------------------------------------- ----------
  ID            String   事务ID。                                  Y

  respCode      Number   接口调用失败时的响应码                    N

  respCont      String   接口调用失败时的返回值                    N
  ---------------------------------------------------------------------------

成功示例：{\"ID\":\"xxxxxxxx\",\"respCode\":0}}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

设备完成日志上报接口响应后，向LogUrl地址发起日志上报，日志上报要求如下：

区分插件日志和设备日志进行上报，插件日志上报文件命名规则为：MAC-timestamp-
TimeOut- LogLevel-Plugin.log，设备日志上报文件命名规则为：MAC-timestamp-
TimeOut- LogLevel-Device.log

插件日志命名示例：MAC为AABBCCDD0123组网终端于1635760833000（2021-11-01
18:00:33）发起日志上报，收集日志的超时时间（TimeOut）为100秒，日志级别（LogLevel）为0（DEBUG）时，插件(plugin)日志的名称为：AABBCCDD0123-1635760833000-100-0-Plugin.log

## 设备升级 {#设备升级 .QB标题4}

接口说明：通过该消息控制组网终端的升级。

请求方向：省级数字家庭管理平台-\>组网终端

## 请求 {#请求-47 .QB标题5}

表7.2-79 升级管理请求

+---------+--------+-----------------------------------------+--------+
| 参数名  | 类型   | 描述                                    | 是     |
|         |        |                                         | 否必须 |
+---------+--------+-----------------------------------------+--------+
| RP      | String | 命令字，取值"file"                      | Y      |
| CMethod |        |                                         |        |
+---------+--------+-----------------------------------------+--------+
| ID      | String | 事务ID。                                | Y      |
+---------+--------+-----------------------------------------+--------+
| f       | String | DOWN下载文件，UP上传文件，缺省为DOWN    | Y      |
| ileMode |        |                                         |        |
+---------+--------+-----------------------------------------+--------+
| f       | String | FIRM固件/                               | Y      |
| ileType |        | APP应用/LOG日志文件/CFG配置文件等，缺省 |        |
|         |        | 为FIRM，组网终端设备应对此字段进行校验  |        |
+---------+--------+-----------------------------------------+--------+
| fileUrl | String | 程序升级的URL，用于下载升级文件         | Y      |
+---------+--------+-----------------------------------------+--------+
| d       | Number | 升                                      | Y      |
| ownMode |        | 级后组网终端是否立即重启生效，取值为：  |        |
|         |        |                                         |        |
|         |        | 0: 不立即重启，等待下次重启后生效，     |        |
|         |        |                                         |        |
|         |        | 1: 立即重启生效                         |        |
+---------+--------+-----------------------------------------+--------+

示例：

{\"RPCMethod\":\"file\",\"ID\":\"xxxxxxxx\",\"fileMode\":\"DOWN\",\"fileType\":\"FIRM\",\"fileUrl\":\"XXXXXX\",\"downMode\":1}

## 响应 {#响应-47 .QB标题5}

表7.1-80 设备升级响应

  ---------- -------- ---------------------------------------------------------------------------------------------------------------------------- ----------
  参数名     类型     描述                                                                                                                         是否必须

  ID         String   事务ID。                                                                                                                     Y

  respCode   Number   响应码，0为成功接收到升级指令，其余code见附录B响应码表，通过事件上报接口上报升级过程，至少上报文件传输完成、版本升级完成。   Y

  respCont   String   接口调用失败时的返回值                                                                                                       N
  ---------- -------- ---------------------------------------------------------------------------------------------------------------------------- ----------

成功示例{\"ID \":\"xxxxxxxx \",\"respCode\":\"0\"}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

在文件传输和升级过程中可以多次发送状态信息

## 云漫游接口流程 {#云漫游接口流程 .QB标题4}

该接口功能默认不启用，当省平台监测用户安装多台中国移动组网终端，且各组网终端具有相同SSID和密码（包含2.4G和5G），但各组网终端间无法实现Mesh漫游时，省平台通过下发指令，开启云漫游接口，为用户提供漫游；具体流程详见5.3.10；

## STA漫游配置 {#sta漫游配置 .QB标题5}

接口说明：通过该消息控制组网终端的STA漫游功能。

请求方向：省级数字家庭管理平台\>组网终端

## 请求 {#请求-48 .QB标题6}

表7.2-81 STA漫游请求

+------------+-------+---------------------------------------+--------+
| 参数名     | 类型  | 描述                                  | 是     |
|            |       |                                       | 否必须 |
+============+=======+=======================================+========+
| RPCMethod  | S     | 命令字，取值"RoamingConfig2"          | Y      |
|            | tring |                                       |        |
+------------+-------+---------------------------------------+--------+
| ID         | S     | 事务ID。                              | Y      |
|            | tring |                                       |        |
+------------+-------+---------------------------------------+--------+
| data       | O     | 终端要解析的数据包                    | Y      |
|            | bject |                                       |        |
+------------+-------+---------------------------------------+--------+
| Roa        | N     | 是否启用Wi-Fi漫游控制，默认关闭       | Y      |
| mingSwitch | umber |                                       |        |
|            |       | 0: 关闭                               |        |
|            |       |                                       |        |
|            |       | 1: 启用                               |        |
+------------+-------+---------------------------------------+--------+
| StaOn      | N     | 是否启用STA上下线监测，默认开启；     | N      |
| lineSwitch | umber |                                       |        |
|            |       | 0: 关闭                               |        |
|            |       |                                       |        |
|            |       | 1: 启用                               |        |
+------------+-------+---------------------------------------+--------+
| L          | N     | 弱信号阈值（2.4G），单位dBm。         | Y      |
| owRSSI2.4G | umber |                                       |        |
|            |       | 当STA接入当                           |        |
|            |       | 前组网终端2.4G频段的RSSI小于该阈值时  |        |
|            |       | ，组网终端需对该STA执行漫游切换控制。 |        |
+------------+-------+---------------------------------------+--------+
| LowRSSI5G  | N     | 弱信号阈值（5G），单位dBm。           | Y      |
|            | umber |                                       |        |
|            |       | 当STA接入                             |        |
|            |       | 当前组网终端5G频段的RSSI小于该阈值时  |        |
|            |       | ，组网终端需对该STA执行漫游切换控制。 |        |
+------------+-------+---------------------------------------+--------+
| LowQOS     | O     | 弱QOS阀值，包含丢包和重传比率指标     | N      |
|            | bject |                                       |        |
+------------+-------+---------------------------------------+--------+
| PacketLoss | N     | 丢包比率，缺省值为10(%)               | N      |
|            | umber |                                       |        |
+------------+-------+---------------------------------------+--------+
| RetryRatio | N     | 重传比率，缺省值为10(%)               | N      |
|            | umber |                                       |        |
+------------+-------+---------------------------------------+--------+
| Low        | N     | 触发弱信号                            | Y      |
| RSSIPeriod | umber | 上报时延，单位：毫秒，缺省值为20000； |        |
|            |       |                                       |        |
|            |       | 举例：对于连接5                       |        |
|            |       | G频段的STA，组网终端监测STA的RSSI强度 |        |
|            |       | 持续低于LowRSSI5G的时间超过20秒时，发 |        |
|            |       | 起7.2.2.11.2接口，同步该STA网络质量； |        |
+------------+-------+---------------------------------------+--------+
| De         | N     | 同步网络质量接                        | Y      |
| tectPeriod | umber | 口上报间隔，单位毫秒，缺省值为60000； |        |
|            |       |                                       |        |
|            |       | 举例：对                              |        |
|            |       | 于连接5G频段的STA，组网终端监测STA的  |        |
|            |       | RSSI强度持续低于LowRSSI5G，且组网终端 |        |
|            |       | 发起7.2.2.11.2接口上报后未收到平台7.  |        |
|            |       | 2.2.11.4接口指令，终端应间隔DetectPer |        |
|            |       | iod时间，继续发起7.2.2.11.2接口上报； |        |
+------------+-------+---------------------------------------+--------+

示例：

{\"RPCMethod\":\"RoamingConfig2\",\"ID\":\"xxxxxxxx\",\"data\":{\"RoamingSwitch\":1,\"StaOnlineSwitch\":1,\"LowRSSI2.4G\":-80,\"LowRSSI5G\":-75,\"LowRSSIPeriod\":20000,\"DetectPeriod\":60000}}

## 响应 {#响应-48 .QB标题6}

表7.2-82 STA漫游响应

  ---------- -------- ------------------------------------------ ----------
  参数名     类型     描述                                       是否必须

  ID         String   事务ID。                                   Y

  respCode   Number   响应码， 0为成功，详见附录B                Y

  respCont   String   接口调用失败时的返回值；                   N
  ---------- -------- ------------------------------------------ ----------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

##  同步网络质量接口  {#同步网络质量接口 .QB标题5}

接口说明：当云漫游功能开启时，组网终端AP2检测到关联的STA的网络质量连续低于预设的阀值时长超过LowRSSIPeriod时，通过本接口主动上报给平台。

请求方向： 组网终端 → 省级数字家庭管理平台

## 请求 {#请求-49 .QB标题6}

表7.2-83 同步网络质量接口请求

+------------+-------+---------------------------------------+--------+
| 参数名     | 类型  | 描述                                  | 是     |
|            |       |                                       | 否必须 |
+============+=======+=======================================+========+
| RPCMethod  | S     | 命令字，取值\"data\"                  | Y      |
|            | tring |                                       |        |
+------------+-------+---------------------------------------+--------+
| eventType  | S     | 事件类型，本事件名\"RoamingDetect\"   | Y      |
|            | tring |                                       |        |
+------------+-------+---------------------------------------+--------+
| deviceMac  | S     | 组网终端铭牌MAC地址，推荐             | Y      |
|            | tring | 使用WAN口MAC，格式为不带冒号且大写；  |        |
+------------+-------+---------------------------------------+--------+
| timestamp  | N     | 时间戳                                | Y      |
|            | umber |                                       |        |
+------------+-------+---------------------------------------+--------+
| data       | O     | 要解析的数据包                        | Y      |
|            | bject |                                       |        |
+------------+-------+---------------------------------------+--------+
| STA        | O     | 检测到                                | Y      |
|            | bject | 的待漫游客户端信息，每次上报一个设备  |        |
+------------+-------+---------------------------------------+--------+
| MacAddress | S     | 下挂设备的MAC地址；                   | Y      |
|            | tring |                                       |        |
+------------+-------+---------------------------------------+--------+
| Radio      | S     | STA接入频段，取值2.4G、5G或5G-2;;     | Y      |
|            | tring |                                       |        |
|            |       | 注：对于三频设备，5G表示5.1G频段，5G- |        |
|            |       | 2表示5.8G频段；双频设备忽略5G-2频段； |        |
+------------+-------+---------------------------------------+--------+
| RSSI       | S     | STA的上联信号强度，单位为dBm          | Y      |
|            | tring |                                       |        |
+------------+-------+---------------------------------------+--------+
| RxRate     | S     | 当前的协商接收速率(Mbps)；            | Y      |
|            | tring |                                       |        |
+------------+-------+---------------------------------------+--------+
| TxRate     | S     | 当前的协商发送速率(Mbps) ；           | Y      |
|            | tring |                                       |        |
+------------+-------+---------------------------------------+--------+

示例：

{\"RPCMethod\":\"data\",\"eventType\":\"RoamingDetect\",\"deviceMac\":\"AABBCCDDEEFF\",\"data\":{\"STA\":{\"MacAddress\":\"00BBCCDDEEFF\",\"Radio\":\"5G\",\"RSSI\":\"-82\",\"RxRate\":\"36\",\"TxRate\":\"36\"}}}

## 响应 {#响应-49 .QB标题6}

表7.2-84 STA漫游响应

  ---------- -------- ------------------------------------------ ----------
  参数名     类型     描述                                       是否必须

  ID         String   事务ID。                                   Y

  respCode   Number   响应码， 0为成功，详见附录B                Y

  respCont   String   接口调用失败时的返回值；                   N
  ---------- -------- ------------------------------------------ ----------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 查询非关联STA网络质量  {#查询非关联sta网络质量 .QB标题5}

接口说明：当云漫游功能开启时，组网省平台接收AP2主动上报的网络质量数据，主动对AP1发起非关联STA网络质量查询，获取同网络下可漫游AP对该STA的网络质量；

请求方向：省级数字家庭管理平台 → 组网终端

## 请求 {#请求-50 .QB标题6}

表7.2-85 非关联STA网络质量查询接口请求

  --------------------------------------------------------------------------
  参数名        类型     描述                                     是否必须
  ------------- -------- ---------------------------------------- ----------
  RPCMethod     String   命令字，取值\" StaRssi \"                Y

  ID            String   事务ID。                                 Y

  data          Object   终端要解析的数据包                       Y

  MacAddress    String   非关联STA的MAC地址；                     Y
  --------------------------------------------------------------------------

示例：{\"RPCMethod\":\"StaRssi\",\"ID\":\"xxxxxxxx\",\"data\":{\"MacAddress\":\"00BBCCDDEEFF\"}}

## 响应 {#响应-50 .QB标题6}

表7.2-86 非关联STA网络质量查询接口响应

  ------------ --------- ------------------------------------------------------------------------------------------------- ----------
  参数名       类型      描述                                                                                              是否必须

  ID           String    事务ID。                                                                                          Y

  respCode     Number    响应码， 0为成功，详见附录B                                                                       Y

  respCont     String    接口调用失败时的返回值                                                                            N

  data         Object    响应数据                                                                                          Y

  STA          Object    待漫游客户端信息；若未检测到该STA的网络质量信息，则上报内容为空；优先监测并上报5GHz频段信号强度   Y

  deviceMac    String    组网终端铭牌MAC地址，推荐使用WAN口MAC，格式为不带冒号并且大写                                     Y

  MacAddress   String    非关联STA使用的MAC地址                                                                            Y

  Radio        String    非关联STA被检测到的频段，取值2.4G或5G                                                             Y

  RSSI         String    非关联STA被检测到的信号强度，单位为dBm                                                            Y
  ------------ --------- ------------------------------------------------------------------------------------------------- ----------

成功示例：

{\"ID\":\"xxxxxxxx\",\"respCode\":0,\"data\":{\"STA\":{\"deviceMac\":\"AABBCCDDEEFF\",\"MacAddress\":\"00BBCCDDEEFF\",\"Radio\":\"5G\",\"RSSI\":\"-50\"}}}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 断开STA连接接口  {#断开sta连接接口 .QB标题5}

接口说明：当平台决定启动无线漫游后，下发断开STA连接接口到AP2，AP2收到该接口后，断开相关STA连接，并限制该STA接入一段时间；

请求方向：省级数字家庭管理平台 → 组网终端

## 请求 {#请求-51 .QB标题6}

表7.2-87 非关联STA网络质量查询接口请求

  --------------------------------------------------------------------------
  参数名        类型     描述                                     是否必须
  ------------- -------- ---------------------------------------- ----------
  RPCMethod     String   命令字，取值 \"StaDisconnect\"           Y

  ID            String   事务ID。                                 Y

  data          Object   终端要解析的数据包                       Y

  MacAddress    String   非关联STA的MAC地址；                     Y

  DismissTime   Number   限制接入的最长时间(毫秒)，缺省5000毫秒   Y
  --------------------------------------------------------------------------

示例：

{\"RPCMethod\":\"StaDisconnect\",\"ID\":\"xxxxxxxx\",\"data\":{\"MacAddress\":\"00BBCCDDEEFF\",\"DismissTime\":5000}}

## 响应 {#响应-51 .QB标题6}

表7.2-88 非关联STA网络质量查询接口响应

  ---------- --------- --------------------------------------- ----------
  参数名     类型      描述                                    是否必须

  ID         String    事务ID。                                Y

  respCode   Number    响应码， 0为成功，详见附录B             Y

  respCont   String    接口调用失败时的返回值；                N
  ---------- --------- --------------------------------------- ----------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 上报STA连接状态  {#上报sta连接状态 .QB标题5}

接口说明：

1\.
若平台通过7.2.2.11.1配置开启Wi-Fi漫游功能（RoamingSwitch=1）且打开STA上下线监测（StaOnlineSwitch=1）时，当STA出现上线/离线时，主动调用该接口进行状态信息上报；

2\.
若平台通过7.2.2.11.1配置开启Wi-Fi漫游功能（RoamingSwitch=1）且关闭STA上下线监测（StaOnlineSwitch=0）时，当组网终端AP1接收7.2.2.11.3查询非关联STA网络质量接口后，启动对该STA上线监测，监测周期2mins。若2分钟时间内，监测到该STA连接到AP1，则AP1按本接口发起主动上报；若2mins监测周期到后，该STA接入时，无需发起主动上报；

请求方向： 组网终端 → 省级数字家庭管理平台

## 请求 {#请求-52 .QB标题6}

表7.2-89 上报STA连接状态接口

+------------+-------+---------------------------------------+--------+
| 参数名     | 类型  | 描述                                  | 是     |
|            |       |                                       | 否必须 |
+============+=======+=======================================+========+
| RPCMethod  | S     | 命令字，取值\"data\"                  | Y      |
|            | tring |                                       |        |
+------------+-------+---------------------------------------+--------+
| eventType  | S     | 事件类型，本事件名\"StaConnect\"      | Y      |
|            | tring |                                       |        |
+------------+-------+---------------------------------------+--------+
| deviceMac  | S     | 组网终端铭牌MAC地址；                 | Y      |
|            | tring |                                       |        |
+------------+-------+---------------------------------------+--------+
| timestamp  | N     | 时间戳                                | Y      |
|            | umber |                                       |        |
+------------+-------+---------------------------------------+--------+
| data       | O     | 要解析的数据包                        | Y      |
|            | bject |                                       |        |
+------------+-------+---------------------------------------+--------+
| STA        | O     | 检测到                                | Y      |
|            | bject | 的待漫游客户端信息，每次上报一个设备  |        |
+------------+-------+---------------------------------------+--------+
| MacAddress | S     | 下挂设备的MAC地址；                   | Y      |
|            | tring |                                       |        |
+------------+-------+---------------------------------------+--------+
| HostName   | S     | 下挂设备的HostName；                  | N      |
|            | tring |                                       |        |
+------------+-------+---------------------------------------+--------+
| StaStatus  | N     | STA状态，采用枚举取值；               | N      |
|            | umber |                                       |        |
|            |       | 0：STA离线；                          |        |
|            |       |                                       |        |
|            |       | 1：STA上线                            |        |
+------------+-------+---------------------------------------+--------+
| Radio      | S     | STA接入频段，取值2.4G、5G或5G-2;      | Y      |
|            | tring |                                       |        |
|            |       | 注：对于三频设备，5G表示              |        |
|            |       | 5.1G频段，5G-2表示5.8G频段；双频设备  |        |
|            |       | 忽略5G-2频段；有线接入时，取值为空；  |        |
+------------+-------+---------------------------------------+--------+
| RSSI       | S     | STA的上联信号强度，单位为dBm；        | Y      |
|            | tring |                                       |        |
|            |       | 说明：有线接入时，取值为空；          |        |
+------------+-------+---------------------------------------+--------+
| RxRate     | S     | 当前的协商接收速率(Mbps)；            | Y      |
|            | tring |                                       |        |
+------------+-------+---------------------------------------+--------+
| TxRate     | S     | 当前的协商发送速率(Mbps) ；           | Y      |
|            | tring |                                       |        |
+------------+-------+---------------------------------------+--------+

示例：

{\"RPCMethod\":\"data\",\"eventType\":\"StaConnect\",\"deviceMac\":\"AABBCCDDEEFF\",\"data\":{\"STA\":{\"MacAddress\":\"00BBCCDDEEFF\",\"HostName\":\"XXXXXXXX\",\"StaStatus\":1,\"Radio\":\"5G\",\"RSSI\":\"-45\",\"RxRate\":\"2401\",\"TxRate\":\"2401\"}}}

## 响应 {#响应-52 .QB标题6}

表7.2-90 上报STA连接状态接口

  ---------- -------- ------------------------------------------ ----------
  参数名     类型     描述                                       是否必须

  ID         String   事务ID。                                   Y

  respCode   Number   响应码， 0为成功，详见附录B                Y

  respCont   String   接口调用失败时的返回值；                   N
  ---------- -------- ------------------------------------------ ----------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 暂停STA漫游策略接口  {#暂停sta漫游策略接口 .QB标题5}

接口说明：平台多次（建议≥5次）无法获取非关联STA网络质量数据，或非关联STA网络质量数据无法匹配漫游阈值时，暂停该STA漫游；组网终端AP2无需持续监测网络质量，待StopDetectTime
时间到达或AP2重启后，恢复对该STA监测；

请求方向：省级数字家庭管理平台 → 组网终端

## 请求 {#请求-53 .QB标题6}

表7.2-91 暂停STA漫游策略接口请求

  -----------------------------------------------------------------------------
  参数名           类型     描述                                     是否必须
  ---------------- -------- ---------------------------------------- ----------
  RPCMethod        String   命令字，取值 \"StopRoaming\"             Y

  ID               String   事务ID。                                 Y

  data             Object   终端要解析的数据包                       Y

  MacAddress       String   无需漫游STA的MAC地址；                   Y

  StopDetectTime   Number   暂停该STA漫游监测时间，单位秒；          Y
  -----------------------------------------------------------------------------

示例：

{\"RPCMethod\":\"StopRoaming\",\"ID\":\"xxxxxxxx\",\"data\":{\"MacAddress\":\"00BBCCDDEEFF\",\"StopDetectTime\":86400}

## 响应 {#响应-53 .QB标题6}

表7.2-92 暂停STA漫游策略接口响应

  ---------- --------- --------------------------------------- ----------
  参数名     类型      描述                                    是否必须

  ID         String    事务ID。                                Y

  respCode   Number    响应码， 0为成功，详见附录B             Y

  respCont   String    接口调用失败时的返回值；                N
  ---------- --------- --------------------------------------- ----------

成功示例：{\"ID \":\"xxxxxxxx \",\"respCode\":0}

失败示例：{\"ID \":\"xxxxxxxx \",\"respCode\":X,\"respCont\":\"XXXXXX\"}

## 组网终端与一级家庭开放平台交互接口定义（IF5） {#组网终端与一级家庭开放平台交互接口定义if5 .QB标题2}

## 接口描述 {#接口描述-2 .QB标题3}

对组网终端注册、上线、离线、数据上报、下发、文件操作、解绑等具体接口进行了实现接口定义。同时对异常情况下的出错上报及下发进行了相应要求。

> MQTT上行消息发送时，Qos:1，Retain:false。

表7.4-1 组网终端与一级平台交互接口汇总

+----+----------------+-----+------+---------------------------------+
| 接 | 接口说明       | 接  | 接口 | 接口URL/Topic                   |
| 口 |                | 口  | 类型 |                                 |
| ID |                | 方  |      |                                 |
|    |                | 向  |      |                                 |
+----+----------------+-----+------+---------------------------------+
| 7. | 省             | 设  | H    | 主url：https://a                |
| 4. | 份编码配置接口 | 备  | TTPS | pconfig.networkorder.komect.com |
| 2. |                | →平 |      |                                 |
| 17 |                | 台  | (P   | 备url：https://apco             |
|    |                |     | OST) | nfigbak.networkorder.komect.com |
+----+----------------+-----+------+---------------------------------+
| 7  | 组网终端注册   |     |      | https://gw                      |
| .4 |                |     |      | Ip:port/device/inform/bootstrap |
| .2 |                |     |      |                                 |
| .2 |                |     |      |                                 |
+----+----------------+-----+------+---------------------------------+
| 7  | 组网终端上线   |     |      | https                           |
| .4 |                |     |      | ://gwIp:port/device/inform/boot |
| .2 |                |     |      |                                 |
| .3 |                |     |      |                                 |
+----+----------------+-----+------+---------------------------------+
| 7  | 周期/上电上报  |     |      | httpsUrl/xxxx                   |
| .4 |                |     |      |                                 |
| .2 |                |     |      |                                 |
| .5 |                |     |      |                                 |
+----+----------------+-----+------+---------------------------------+
| 7. | 终             |     |      | [https://{gwIp:port             |
| 4. | 端管理数据上报 |     |      | }/device/inform/znzwdmReport]() |
| 2. |                |     |      |                                 |
| 16 |                |     |      |                                 |
+----+----------------+-----+------+---------------------------------+
| 7  | 组网终端连接   |     | MQTT | /device/{deviceId}/upward       |
| .4 |                |     | 上行 |                                 |
| .2 |                |     |      |                                 |
| .4 |                |     |      |                                 |
+----+----------------+-----+------+---------------------------------+
| 7  | 数据上报       |     |      |                                 |
| .4 |                |     |      |                                 |
| .2 |                |     |      |                                 |
| .6 |                |     |      |                                 |
+----+----------------+-----+------+---------------------------------+
| 7  | 出错上报       |     |      |                                 |
| .4 |                |     |      |                                 |
| .2 |                |     |      |                                 |
| .7 |                |     |      |                                 |
+----+----------------+-----+------+---------------------------------+
| 7  | 组网终端控制   |     |      |                                 |
| .4 |                |     |      |                                 |
| .2 |                |     |      |                                 |
| .8 |                |     |      |                                 |
+----+----------------+-----+------+---------------------------------+
| 7  | 数据查询       | 平  | MQTT | /device/{deviceId}/downward     |
| .4 |                | 台  | 下行 |                                 |
| .2 |                | →设 |      |                                 |
| .9 |                | 备  |      |                                 |
+----+----------------+-----+------+---------------------------------+
| 7. | 组网终端解绑   |     |      |                                 |
| 4. |                |     |      |                                 |
| 2. |                |     |      |                                 |
| 10 |                |     |      |                                 |
+----+----------------+-----+------+---------------------------------+
| 7. | 文件操作       |     |      |                                 |
| 4. |                |     |      |                                 |
| 2. |                |     |      |                                 |
| 11 |                |     |      |                                 |
+----+----------------+-----+------+---------------------------------+
| 7. | 应用发现设备   |     |      |                                 |
| 4. |                |     |      |                                 |
| 2. |                |     |      |                                 |
| 12 |                |     |      |                                 |
+----+----------------+-----+------+---------------------------------+
| 7. | 设备入网       |     |      |                                 |
| 4. |                |     |      |                                 |
| 2. |                |     |      |                                 |
| 13 |                |     |      |                                 |
+----+----------------+-----+------+---------------------------------+

## 接口详细定义 {#接口详细定义-1 .QB标题3}

## 设备获取一级数字家庭管理平台地址接口 {#设备获取一级数字家庭管理平台地址接口 .QB标题4}

组网终端上电并联网后，执行该接口获取一级平台地址，并注册上线。

请求url： https://open.home.komect.com/espapi/m2m/rest/devices/cgw

请求头：Content-Type: application/json

> Accept-Charset: utf-8

请求类型：POST，组网终端-\>家开平台

说明：

1)  组网终端调用接口后收不到响应，应重试，建议5s一次重试3次

2)  若3次重试均失败时，使用AOS-NET插件预置的一级平台地址，执行注册上线流程。

3)  

## 请求 {#请求-54 .QB标题5}

表7.4-2 组网终端获取一级平台地址请求参数表

  -------------- -------- --------------------------------------- ----------
  参数名         类型     描述                                    是否必须

  deviceType     String   产品类型，数字家庭合作伙伴门户申请      Y

  productToken   String   设备在开发者门户注册的产品类型Token     Y
  -------------- -------- --------------------------------------- ----------

请求示例：{\"deviceType\":\"30103\",\"productToken\":\"\*\*\*\*\*\"}

## 响应 {#响应-54 .QB标题5}

表7.4-3 组网终端获取一级平台地址响应参数表

  ------------ -------- -------------------------------------------- ----------
  参数名       类型     描述                                         是否必须

  resultCode   Number   响应结果码                                   Y

  gwAddress    String   预留地址，组网终端无关                       Y

  gwAddress2   String   组网终端连接地址，格式为https://\*\*\*\*\*   Y
  ------------ -------- -------------------------------------------- ----------

成功回复：{\"resultCode\":0,\"gwAddress\":\"\*\*\*\*\*\*\*\",\"gwAddress2\":\"\*\*\*\*\*\*\*\"}

失败回复：

表7.4-4 组网终端获取一级平台地址失败回复参数表

  -------------- ------------- ------------------------------- ----------
  参数名         类型          描述                            是否必须

  respCode       Number        响应码                          Y

  respCont       String        响应计数                        Y
  -------------- ------------- ------------------------------- ----------

失败示例：{\"respCode\":X,\"respCont\":\"\*\*\*\*\*\"}

## 组网终端注册 {#组网终端注册 .QB标题4}

## 接口描述 {#接口描述-3 .QB标题5}

> 组网终端首次开机联网，检测到没有deviceId和deviceToken，则执行7.4.2.1接口获取一级平台地址（gwAddress2）后调用本接口进行注册，默认User-Key值见下文说明；
>
> APP发现组网终端并绑定时，组网终端使用来自APP的User-Key、gwIp（家开平台IP或域名）和port向平台重新发起注册、上线，并将来自APP的User-Key、gwIp（家开平台IP或域名）和port存在本地，后续组网终端重启均默认使用该信息向平台发起上线请求。

请求url：https://gwIp:port/device/inform/bootstrap

请求头：Content-Type: application/json

> Accept-Charset: utf-8
>
> User-Key: \*\*\*\*\*

请求类型：POST，组网终端-\>家开平台

说明：User-Key、gwIp（家开平台IP或域名）和port来自配网过程

User-Key: \*\*\*\*\*//默认为
厂商编码-设备型号编码（一级家开合作伙伴门户申请）
例如杭研AN1202L为：03-3087，如APP发现绑定后发起的注册，值为netinfo接口的userkey。

## 请求 {#请求-55 .QB标题5}

表7.4-5 组网终端注册请求参数表

+------------+---------+-------------------------------------+--------+
| 参数名     | 类型    | 描述                                | 是     |
|            |         |                                     | 否必须 |
+------------+---------+-------------------------------------+--------+
| deviceMac  | String  | 组网终端铭牌MAC地址，推荐使         | Y      |
|            |         | 用WAN口MAC，格式为不带冒号并且大写  |        |
+------------+---------+-------------------------------------+--------+
| pr         | String  | 组网终端在开发者门户注册的产品类型  | Y      |
| oductToken |         | Token，平台会                       |        |
|            |         | 检查该值的合法性，非法则不允许注册  |        |
+------------+---------+-------------------------------------+--------+
| alsecCode  | Number  | authMode为1时必填。端侧一机一密     | N      |
|            |         | SDK基于认证ID和秘钥执行解密的响应码 |        |
+------------+---------+-------------------------------------+--------+
| deviceType | String  | 产品类型，数字家庭合作伙伴门户申请  | Y      |
+------------+---------+-------------------------------------+--------+
| timestamp  | Number  | 时间戳                              | Y      |
+------------+---------+-------------------------------------+--------+
| dev        | Object  | 组网终端扩展属性                    | Y      |
| iceExtInfo |         |                                     |        |
+------------+---------+-------------------------------------+--------+
| cmei       | String  | 组网终端唯一标识                    | Y      |
+------------+---------+-------------------------------------+--------+
| cpuType    | String  | 组网终端CPU型号                     | N      |
+------------+---------+-------------------------------------+--------+
| FlashSize  | Number  | 组网终端Flash容量，单位MB           | N      |
+------------+---------+-------------------------------------+--------+
| RamSize    | Number  | 组网终端RAM容量，单位MB             | N      |
+------------+---------+-------------------------------------+--------+
| authMode   | Number  | 0代                                 | Y      |
|            |         | 表类型认证，1代表设备认证，认证ID和 |        |
|            |         | 密钥分别为SN和productToken，必填。  |        |
+------------+---------+-------------------------------------+--------+
| authId     | String  | 认证唯                              | N      |
|            |         | 一标识，数字家庭合作伙伴门户申请。  |        |
+------------+---------+-------------------------------------+--------+
| deviceSn   | String  | 组                                  | Y      |
|            |         | 网终端SN，按组网技术规范要求生成。  |        |
+------------+---------+-------------------------------------+--------+
| reserve    | String  | 厂商特殊标识字段,可选               | N      |
+------------+---------+-------------------------------------+--------+
| de         | String  | 组网终端                            | Y      |
| viceVendor |         | 厂商编码，数字家庭合作伙伴门户申请  |        |
+------------+---------+-------------------------------------+--------+
| d          | String  | 组网终端                            | Y      |
| eviceModel |         | 型号编码，数字家庭合作伙伴门户申请  |        |
+------------+---------+-------------------------------------+--------+
| firmw      | String  | 固件版本                            | Y      |
| areVersion |         |                                     |        |
+------------+---------+-------------------------------------+--------+
| softw      | String  | 软件版本                            | Y      |
| areVersion |         |                                     |        |
+------------+---------+-------------------------------------+--------+
| pr         | String  | 省份信息，省份编码详见技术规范      | Y      |
| ovinceCode |         |                                     |        |
+------------+---------+-------------------------------------+--------+
| networkPlu | String  | 组网中间件                          | N      |
| ginVersion |         | 版本；若未集成组网中间件，上报空值  |        |
+------------+---------+-------------------------------------+--------+
| radio5     | Number  | 组网终端支持频段信息：              | N      |
|            |         |                                     |        |
|            |         | 0：单频组网终端；                   |        |
|            |         |                                     |        |
|            |         | 1：双频组网终端；                   |        |
|            |         |                                     |        |
|            |         | 2：三频组网终端；                   |        |
+------------+---------+-------------------------------------+--------+

示例：

{\"deviceMac\":\"\*\*\*\*\*\",\"productToken\":\"\*\*\*\*\*\",\"deviceType\":\"30103\",\"timestamp\":1626948825804,\"deviceExtInfo\":{\"cmei\":\"\*\*\*\*\*\",\"cpuType\":\"MT7621DA\",\"FlashSize\":\"128\",\"RamSize\":\"256\",\"authMode\":1,\"authId\":\"\*\*\*\*\*\",\"deviceSn\":\"011101\*\*\*\*\*\",\"reserve\":\"\*\*\*\*\*\",\"deviceVendor\":\"01\",\"deviceModel\":\"1101\",\"firmwareVersion\":\"\*\*\*\*\*\",\"softwareVersion\":\"\*\*\*\*\*\",\"provinceCode\":\"\*\*\*\*\*\",\"networkPluginVersion\":\"1.5.0\",\"radio5\":\"1\"}}

## 响应 {#响应-55 .QB标题5}

表7.4-6 组网终端注册响应参数表

  -------------- ---------- ---------------------------------------------- ----------
  参数名         类型       描述                                           是否必须

  deviceId       String     组网终端 ID                                    Y

  deviceToken    String     组网终端密钥，目前暂不定义用途                 Y

  andlinkToken   String     组网终端在开发者门户注册的产品类型对应的平台   Y
                            Token，设备应检查 AndlinkToken 的合法性        

  gwToken        String     一级平台动态生成Token，用于后续接口加密；      Y

  dmToken        String     终端管理数据上报接口鉴权Token，由平台返回      Y
  -------------- ---------- ---------------------------------------------- ----------

成功回复：

{\"deviceId\":\"\*\*\*\*\*\*\*\",\"deviceToken\":\"\*\*\*\*\*\*\*\",\"andlinkToken\":\"\*\*\*\*\*\*\*\",\"gwToken\":\"\*\*\*\*\*\",\"dmToken\":\"\*\*\*\*\*\*\"}

失败回复：{\"respCode\":X,\"respCont\":\"\*\*\*\*\*\"}

## 组网终端上线 {#组网终端上线 .QB标题4}

## 接口描述 {#接口描述-4 .QB标题5}

组网终端每次上电，若检测到已注册，则执行上线请求，当响应的userBind状态与当前绑定状态不符时，更新绑定状态。

请求url：[https://gwIp:port/device/inform/boot](https://gwIp:port/device/inform/boot_x0005_)

请求头：Content-Type: application/json

> Accept-Charset: utf-8
>
> *User-Key: \*\*\*\*\**

请求类型：POST，组网终端-\>家开平台

## 请求 {#请求-56 .QB标题5}

表7.4-7 组网终端上线请求参数表

+------------+-------+----------------------------------------+-------+
| 参数名     | 类型  | 描述                                   | 是否  |
|            |       |                                        | 必须  |
+------------+-------+----------------------------------------+-------+
| deviceId   | S     | 组网终端 ID                            | Y     |
|            | tring |                                        |       |
+------------+-------+----------------------------------------+-------+
| pr         | S     | 组网终端在开发者门户注册的产品类型     | Y     |
| oductToken | tring | Token；                                |       |
+------------+-------+----------------------------------------+-------+
| alsecCode  | N     | authMode为1时必填。端侧一机一          | N     |
|            | umber | 密SDK基于认证ID和秘钥执行解密的响应码  |       |
+------------+-------+----------------------------------------+-------+
| deviceType | S     | 产品名称码，默认为30103                | Y     |
|            | tring |                                        |       |
+------------+-------+----------------------------------------+-------+
| deviceMac  | S     | 组网终端铭牌MAC地址，推                | Y     |
|            | tring | 荐使用WAN口MAC，格式为不带冒号并且大写 |       |
+------------+-------+----------------------------------------+-------+
| firmw      | S     | 硬件版本                               | Y     |
| areVersion | tring |                                        |       |
+------------+-------+----------------------------------------+-------+
| softw      | S     | 软件版本                               | Y     |
| areVersion | tring |                                        |       |
+------------+-------+----------------------------------------+-------+
| userBind   | N     | 组网终端用户绑定状态，0：              | Y     |
|            | umber | 未绑定，1：绑定；当组网终端由绑定状态  |       |
|            |       | 变为未绑定状态时需关闭CMCC-GUIDE-LINK  |       |
+------------+-------+----------------------------------------+-------+
| bootType   | N     | boot触发类型，1为上电触发，0为重试触发 | Y     |
|            | umber |                                        |       |
+------------+-------+----------------------------------------+-------+
| PPPOEuser  | S     | PPPO                                   | Y     |
|            | tring | E账号信息（当7.1.1.2上联网关查询接口获 |       |
|            |       | 取成功时，上报网关PPPoE账号；当终端工  |       |
|            |       | 作在PPPOE拨号上网时，填写AP自身的PPPoE |       |
|            |       | 账号；除上述两种情况外，该值为空值）） |       |
+------------+-------+----------------------------------------+-------+
| ipAddress  | S     | 组网终端IP                             | Y     |
|            | tring |                                        |       |
+------------+-------+----------------------------------------+-------+
| IPv6Status | N     | 组网终端IPv4/IPv6双栈状态，枚举取值；  | N     |
|            | umber |                                        |       |
|            |       | 0：关闭IPv4/IPv6双栈                   |       |
|            |       |                                        |       |
|            |       | 1：开启IPv4/IPv6双栈                   |       |
+------------+-------+----------------------------------------+-------+
| IPv        | S     | 组网终端IPv6地址                       | Y     |
| 6IPAddress | tring |                                        |       |
+------------+-------+----------------------------------------+-------+
| timestamp  | N     | 时间戳，单位：毫秒                     | Y     |
|            | umber |                                        |       |
+------------+-------+----------------------------------------+-------+
| XData      | O     | 组网终端扩展属性                       | Y     |
|            | bject |                                        |       |
+------------+-------+----------------------------------------+-------+
| cmei       | S     | 组网终端唯一标识                       | Y     |
|            | tring |                                        |       |
+------------+-------+----------------------------------------+-------+
| deviceSn   | S     | 组网终端SN，按组网技术规范要求生成     | Y     |
|            | tring |                                        |       |
+------------+-------+----------------------------------------+-------+
| networkPlu | S     | 组网中间                               | Y     |
| ginVersion | tring | 件版本；若未集成组网中间件，则上报为空 |       |
+------------+-------+----------------------------------------+-------+
| pr         | S     | 省份信息，省份编码详见技术规范         | Y     |
| ovinceCode | tring |                                        |       |
+------------+-------+----------------------------------------+-------+
| ap         | S     | 上行接入方式                           | N     |
| UplinkType | tring | ：WLAN、Ethernet、PLC、Cable、Optical  |       |
|            |       | Ethernet、GPON、XGPON、PoE             |       |
+------------+-------+----------------------------------------+-------+
| radio5     | N     | 终端支持频段信息：                     | N     |
|            | umber |                                        |       |
|            |       | 0：单频组网终端                        |       |
|            |       |                                        |       |
|            |       | 1：双频组网终端                        |       |
|            |       |                                        |       |
|            |       | 2：三频组网终端                        |       |
+------------+-------+----------------------------------------+-------+
| a          | S     | 上联网元Mac，非PPPoE拨号时必选         | N     |
| pUplinkMac | tring |                                        |       |
+------------+-------+----------------------------------------+-------+
| andl       | S     | 网关插件版本，内容可变，在7.1.1        | N     |
| inkVersion | tring | .1上联网关查询接口获取成功的情况下必选 |       |
+------------+-------+----------------------------------------+-------+
| Loc        | N     | 锁网状态标识，                         | Y     |
| kNetStatus | umber | 表示当前的锁网状态：1为锁网，0为不锁网 |       |
+------------+-------+----------------------------------------+-------+
| WifiSen    | N     | Wi-Fi感知功能标识；1：具备             | N     |
| singEnable | umber | Wi-Fi感知能力；0：不具备Wi-Fi感知能力  |       |
+------------+-------+----------------------------------------+-------+
| meshRole   | N     | Mesh角色，枚举取值：                   | N     |
|            | umber |                                        |       |
|            |       | 0：非mesh终端；                        |       |
|            |       |                                        |       |
|            |       | 1：controller；                        |       |
|            |       |                                        |       |
|            |       | 2：agent；                             |       |
|            |       |                                        |       |
|            |       | 3：AC；                                |       |
|            |       |                                        |       |
|            |       | 4：AP；（专指面板式AP）                |       |
+------------+-------+----------------------------------------+-------+
| wifiSpe    | N     | Wi-Fi无线规格，采用枚举取值：          | Y     |
| cification | umber |                                        |       |
|            |       | 1：AC12                                |       |
|            |       | 00（空间流：2.4G：2×2，5G：2×2@80MHz） |       |
|            |       |                                        |       |
|            |       | 2：AC19                                |       |
|            |       | 00（空间流：2.4G：3×3，5G：3×3@80MHz） |       |
|            |       |                                        |       |
|            |       | 3：AC21                                |       |
|            |       | 00（空间流：2.4G：2×2，5G：4×4@80MHz） |       |
|            |       |                                        |       |
|            |       | 4：AC210                               |       |
|            |       | 0（空间流：2.4G：2×2，5G：2×2@160MHz） |       |
|            |       |                                        |       |
|            |       | 5：AC26                                |       |
|            |       | 00（空间流：2.4G：4×4，5G：4×4@80MHz） |       |
|            |       |                                        |       |
|            |       | 6：AX15                                |       |
|            |       | 00（空间流：2.4G：2×2，5G：2×2@80MHz） |       |
|            |       |                                        |       |
|            |       | 7：AX18                                |       |
|            |       | 00（空间流：2.4G：2×2，5G：2×2@80MHz） |       |
|            |       |                                        |       |
|            |       | 8：AX300                               |       |
|            |       | 0（空间流：2.4G：2×2，5G：2×2@160MHz） |       |
|            |       |                                        |       |
|            |       | 9：AX30                                |       |
|            |       | 00（空间流：2.4G：2×2，5G：4×4@80MHz） |       |
|            |       |                                        |       |
|            |       | 10：AX36                               |       |
|            |       | 00（空间流：2.4G：4×4，5G：4×4@80MHz） |       |
|            |       |                                        |       |
|            |       | 11：AX540                              |       |
|            |       | 0（空间流：2.4G：2×2，5G：4×4@160MHz） |       |
|            |       |                                        |       |
|            |       | 12：AX600                              |       |
|            |       | 0（空间流：2.4G：4×4，5G：4×4@160MHz） |       |
|            |       |                                        |       |
|            |       | 13：AX4200（空间流：2.4G：2×           |       |
|            |       | 2，5.2G：2×2@160MHz，5.8G：2×2@80MHz） |       |
+------------+-------+----------------------------------------+-------+
| apType     | N     | 终端类型，枚举取值；                   | Y     |
|            | umber |                                        |       |
|            |       | 0：常规路由器（DC12供电）              |       |
|            |       |                                        |       |
|            |       | 1：AP面板（PoE供电）                   |       |
|            |       |                                        |       |
|            |       | 2：AC控制器                            |       |
|            |       |                                        |       |
|            |       | 3：PLC终端                             |       |
|            |       |                                        |       |
|            |       | 4：FTTR-光网关                         |       |
|            |       |                                        |       |
|            |       | 5：FTTR-光路由（DC12供电）             |       |
|            |       |                                        |       |
|            |       | 6：FTTR-光路由（光电混合缆供电）       |       |
|            |       |                                        |       |
|            |       | 7：FTTR-光交换机                       |       |
+------------+-------+----------------------------------------+-------+

示例：

{\"deviceId\":\"CMCC-30103-AABBCCDDEEFF\",\"productToken\":\"\*\*\*\*\*\",\"alsecCode\":200,\"deviceMac\":\"AABBCCDDEEFF\",\"deviceType\":\"30103\",\"firmwareVersion\":\"V1.0\",\"softwareVersion\":\"\*\*\*\*\*\",\"userBind\":0,\"bootType\":1,\"PPPOEuser\":\"\*\*\*\*\*\",\"ipAddress\":\"192.168.10.1\",\"IPv6Status\":1,\"IPv6IPAddress\":\"2001:DA8:1000::F1\",\"timestamp\":1626948825804,\"XData\":{\"cmei\":\"0101\*\*\*\*\*\*\*\*\*\*\",\"deviceSn\":\"011101\*\*\*\*\*\*\*\*\*\",\"networkPluginVersion\":\"V1.6.0\",\"provinceCode\":\"ZHJ\",\"apUplinkType\":\"WLAN\",\"radio5\":1,\"apUplinkMac\":\"\*\*\*\*\*\*\",\"andlinkVersion\":\"V2\",\"LockNetStatus\":0,\"WifiSensingEnable\":1,\"meshRole\":1,\"wifiSpecification\":8,\"apType\":0}}

## 响应 {#响应-56 .QB标题5}

表7.4-8 组网终端上线响应参数表

+------------+--------+------------------------------------+---------+
| 参数名     | 类型   | 描述                               | 是      |
|            |        |                                    | 否必须  |
+------------+--------+------------------------------------+---------+
| respCode   | Number | 失败时回复；                       | N       |
+------------+--------+------------------------------------+---------+
| respCont   | String | 失败时回复；                       | N       |
+------------+--------+------------------------------------+---------+
| timestamp  | Number | 一级家开                           | Y       |
|            |        | 平台时间戳，组网终端可用于时钟同步 |         |
+------------+--------+------------------------------------+---------+
| mqttUrl    | String | Mqtt连接地址                       | Y       |
+------------+--------+------------------------------------+---------+
| mq         | String | Mqtt分配的客户端id                 | Y       |
| ttClientId |        |                                    |         |
+------------+--------+------------------------------------+---------+
| mqttUser   | String | Mqtt鉴权信息                       | Y       |
+------------+--------+------------------------------------+---------+
| mq         | String | Mqtt鉴权信息                       | Y       |
| ttPassword |        |                                    |         |
+------------+--------+------------------------------------+---------+
| mqt        | Number | Mqtt心跳周期，单位秒               | Y       |
| tKeepalive |        |                                    |         |
+------------+--------+------------------------------------+---------+
| mqttRetry  | Array  | mqtt重试策略，单位秒，MQTT重试时间 | Y       |
|            |        | 间隔需满足![](media/image41.wmf);  |         |
+------------+--------+------------------------------------+---------+
| httpsUrl   | String | HTTP 周期上报URL地址，成功响应必选 | N       |
+------------+--------+------------------------------------+---------+
| userBind   | Number | 可选，设备侧用户绑定状态；         | N       |
|            |        |                                    |         |
|            |        | 0：已解绑；1：已绑定；             |         |
|            |        | 2：已注册未绑定                    |         |
|            |        |                                    |         |
|            |        | 状态与请求不同时必选；             |         |
+------------+--------+------------------------------------+---------+
| data       | Object | 终端待解析数据包                   |         |
+------------+--------+------------------------------------+---------+
| StatusRepo | String | 设备Wi-Fi状态/上联状态上报周期，单 | N       |
| rtInterval |        | 位s（秒）；上报时间设置以600秒（1  |         |
|            |        | 0分钟）为公约数（例如600秒，1200秒 |         |
|            |        | ，1800秒），默认14400秒（4小时）； |         |
+------------+--------+------------------------------------+---------+
| Repo       | String | 下挂设备上报周期，                 | Y       |
| rtInterval |        | 单位s(秒)，上报时间设置以600秒（1  |         |
|            |        | 0分钟）为公约数（例如600秒，1200秒 |         |
|            |        | ，1800秒），默认1800秒（30分钟）； |         |
+------------+--------+------------------------------------+---------+
| Samp       | String | 数据采                             | Y       |
| leInterval |        | 样间隔，单位s(秒)，间隔时间以60秒  |         |
|            |        | 为公约数（例如60秒，120秒），默认6 |         |
|            |        | 0s，采样间隔只用于统计收发速率信息 |         |
+------------+--------+------------------------------------+---------+
| UplinkSt   | Number | 设备上行连接状态开关；             | Y       |
| atusEnable |        |                                    |         |
|            |        | 取值为1（True），0(False)          |         |
+------------+--------+------------------------------------+---------+
| WlanNeig   | Number | 设备周边Wi                         | N       |
| hborEnable |        | -Fi信息，取值为1（True），0(False) |         |
+------------+--------+------------------------------------+---------+
| ApConfig   | Number | 设备Wi-Fi状态信息；                | Y       |
| InfoEnable |        |                                    |         |
|            |        | 取值为1（True），0(False)          |         |
+------------+--------+------------------------------------+---------+
| STA        | Number | 设备下挂设备信息开关；             | Y       |
| InfoEnable |        |                                    |         |
|            |        | 取值为1（True），0(False)          |         |
+------------+--------+------------------------------------+---------+
| [STA       | [Nu    | [下挂设备状                        | N       |
| ChangeEnab | mber]{ | 态变更上报开关，默认关闭；]{.mark} |         |
| le]{.mark} | .mark} |                                    |         |
|            |        | [枚举取值；                        |         |
|            |        | 取值为1（开启），0(关闭)；]{.mark} |         |
+------------+--------+------------------------------------+---------+
| [STA       | [St    | [下挂                              | N       |
| ChangeRptU | ring]{ | 设备状态变更上报Url地址；]{.mark}  |         |
| rl]{.mark} | .mark} |                                    |         |
+------------+--------+------------------------------------+---------+

[说明：当STAChangeEnable字段缺失时，默认关闭下挂设备状态变更上报功能；]{.mark}

成功回复：

{\"timestamp\":1626948825804,\"mqttUrl\":\"\*\*\*\*\*\*\*\",\"mqttClientId\":\"\*\*\*\*\*\*\*\",\"mqttUser\":\"\*\*\*\*\*\*\*\",\"mqttPassword\":\"\*\*\*\*\*\*\*\",\"mqttKeepalive\":\*\*\*,\"mqttRetry\":![](media/image42.wmf),\"httpsUrl\":\"\*\*\*\*\*\*\*\",\"userBind\":0,
\"data\":{\"StatusReportInterval\":\"14400\",\"ReportInterval\":\"1800\",\"SampleInterval\":\"60\",\"UplinkStatusEnable\":1,\"[WlanNeighborEnable]{.mark}\":1,\"ApCnfigInfoEnable\":1,\"STAInfoEnable\":1,\"[STAChangeEnable]{.mark}\":0,\"[STAChangeRptUrl]{.mark}\":\"\*\*\*\*\*\*\*\"}}

失败回复：{\"respCode\":X,\"respCont\":\"\*\*\*\*\*\"}

## 组网终端连接 {#组网终端连接 .QB标题4}

> 连接MQTT服务器的时候，keepAliveTime 使用
> 上线消息的返回字段mqttKeepalive。MQTT发送消息属性设置统一为Retain：false。

## 遗嘱消息 {#遗嘱消息 .QB标题5}

topic：/device/{deviceId}/upward

表7.4-9 组网终端遗嘱消息参数表

  ----------- ----------- ------------------------------------------- ----------
  参数名      类型        描述                                        是否必须

  eventType   String      事件类型（Offline）                         Y

  deviceId    String      组网终端ID                                  Y

  timestamp   Number      一级家开平台时间戳,组网终端可用于时钟同步   Y
  ----------- ----------- ------------------------------------------- ----------

示例：{\"eventType\":\"Offline\",\"deviceId\":\"\*\*\*\*\*\",\"timestamp\":1626948825804}

## MQTT上线通知 {#mqtt上线通知 .QB标题5}

请求方向：组网终端\--\>平台

> Topic：/device/{deviceId}/upward

说明：组网终端与一级平台建立长心跳长连接后，通过长连接发送MQ上线通知信息，通知平台组网终端MQTT上线.

表7.4-10 组网终端MQTT上线通知参数表

  ------------ --------- ------------------------------------------- ----------
  参数名       类型      描述                                        是否必须

  eventType    String    事件类型（MBoot）                           Y

  deviceId     String    组网终端ID                                  Y

  timestamp    Number    一级家开平台时间戳,组网终端可用于时钟同步   Y

  deviceMac    String    组网终端真实MAC                             Y

  ipAddress    String    组网终端IP若为非IP终端则可忽略              N
  ------------ --------- ------------------------------------------- ----------

示例：

{\"deviceId\":\"\*\*\*\*\*\",\"eventType\":\"MBoot\",\"timestamp\":1626948825804,\"deviceMac\":\"\*\*\*\*\*\",\"ipAddress\":\"\*\*\*\*\*\*\"}

## 设备强制下线 {#设备强制下线 .QB标题5}

请求方向：平台---\>组网终端

请求topic：/device/{deviceId}/downward

表7.4-11 组网终端强制下线参数表

  -------------- -------- ------------------------------------- ----------
  参数名         类型     描述                                  是否必须

  eventType      String   事件类型（KickOut）                   Y

  deviceId       String   组网终端ID                            Y
  -------------- -------- ------------------------------------- ----------

示例：

{\"function\":\"KickOut\",\"deviceId\":\"\*\*\*\*\*\"}

备注：

1.  KickOut控制命令，该指令的目的是使组网终端断开当前MQTT连接，重新上线。

## 组网终端数据周期/上电上报 {#组网终端数据周期上电上报 .QB标题4}

## 接口描述 {#接口描述-5 .QB标题5}

接口内容：周期/上电上报的信息通过HTTP POST方式上报到一级家开平台

请求类型：组网终端-\>一级家开平台

请求url： httpsUrl/function（httpsUrl
为7.3.2.3组网终端上线接口响应字段获取，function为表7.3-12所示的周期/上电上报function取值）

请求头：Content-Type: application/json

Accept-Charset: utf-8

表7.3-12 周期/上电上报function表格

  --------------------------- -------------------------------------------
  function取值                功能说明

  ApConfigInfo                信息上报

  UplinkStatus                上联状态

  STAInfo                     下挂设备信息

  WlanNeighbor                周边Wi-Fi信息
  --------------------------- -------------------------------------------

## 请求 {#请求-57 .QB标题5}

{

\"deviceId\": \"\*\*\*\*\*\",

\"timestamp\": \*\*\*\*\*\*,

\"data\": {

//数据值同7.3.2.7组网终端数据上报接口相应function对应数据体

}

}

## 响应 {#响应-57 .QB标题5}

表7.4-13 周期/上电上报响应

  ------------------------------------------------------------------------
  参数名      类型       描述                                 是否必须
  ----------- ---------- ------------------------------------ ------------
  respCode    Number     响应码，详见附录C错误码              Y

  respCont    String     响应的返回值                         N
  ------------------------------------------------------------------------

成功示例：{\"respCode\": X}

失败示例：{\"respCode\":X,\"respCont\":\"XXXXX\"}

## 组网终端数据主动上报 {#组网终端数据主动上报 .QB标题4}

## Speedtest测速数据主动上报 {#speedtest测速数据主动上报 .QB标题5}

## 接口描述 {#接口描述-6 .QB标题6}

接口描述：Speedtest测速数据主动上报的信息通过HTTP
POST方式上报到一级家开平台

请求类型：组网终端-\>一级家开平台

请求url： [SpeedResultUrl（SpeedResultUrl为7.3.2.9.2.4
Speedtest下载测试接口响应字段获取）]{.mark}

请求头：Content-Type: application/json

Accept-Charset: utf-8

## 接口请求 {#接口请求 .QB标题6}

表2-25 Speedtest主动上报参数表

  ----------------------- ----------------- -------------------------------------------------------------------------------------- ------------
  参数名                  类型              描述                                                                                   是否必须

  deviceId                String            组网终端ID;                                                                            Y

  timestamp               Number            时间戳，单位：毫秒；                                                                   Y

  data                    Object            终端待解析数据包;                                                                      Y

  HttpSpeedTestRate       String            Speedtest下载速率，单位Mbps；平台下发事件上报间隔时间内下载速率平均值；                Y

  SeqNumber               Number            数据传输序列号；收到7.4.2.8.2.23指令时，SeqNumber取值为1，发起主动上报后，SeqNumber=   N
                                            SeqNumber+1；                                                                          

  TransmitRatio           Number            传输进度；0:代表测速结果传输未完成；1：代表测速结果传输已完成；                        N

  [TransmitSize]{.mark}   [String]{.mark}   [已下载文件大小,单位为Mbit;]{.mark}                                                    [N]{.mark}
  ----------------------- ----------------- -------------------------------------------------------------------------------------- ------------

成功示例：

{\"deviceId\":\"CMCC-30103-\*\*\*\*\*\*\*\*\*\*\*\*\",\"timestamp\":1641523029678,\"data\":{\"HttpSpeedTestRate\":\"1000.00\",\"SeqNumber\":1,\"TransmitRatio
\":0,[\"TransmitSize\":\"xxxxxx\"]{.mark}}}

## 接口响应 {#接口响应 .QB标题6}

表2-26 周期/上电上报响应

  ------------------------------------------------------------------------
  参数名      类型       描述                                 是否必须
  ----------- ---------- ------------------------------------ ------------
  respCode    Number     响应码，详见附录C错误码              Y

  respCont    String     响应的返回值                         N
  ------------------------------------------------------------------------

成功示例：{\"respCode\": X}

失败示例：{\"respCode\":X,\"respCont\":\"XXXXX\"}

## 下挂设备状态变更主动上报 {#下挂设备状态变更主动上报 .QB标题5}

## 接口描述 {#接口描述-7 .QB标题6}

接口描述：下挂设备状态变更数据主动上报的信息通过HTTP
POST方式上报到一级家开平台

请求类型：组网终端-\>一级家开平台

请求url： []{.mark} STAChangeRptUrl（STAChangeRptUrl可从7.3.2.9.2.17
周期上报配置接口或7.3.2.3 组网终端上线接口中获取，以最新地址为准）。\
若周期上报配置接口中的STAChangeEnable为1时，开启主动上报功能，当下挂设备状态变更时将变更数据上报到一级平台。

请求头：Content-Type: application/json

Accept-Charset: utf-8

## 接口请求 {#接口请求-1 .QB标题6}

表2-25 [STAChange]{.mark}主动上报参数表

+---------------+---------+-----------------------------------+-------+
| 参数名        | 类型    | 描述                              | 是否  |
|               |         |                                   | 必须  |
+---------------+---------+-----------------------------------+-------+
| deviceId      | String  | 组网终端ID;                       | Y     |
+---------------+---------+-----------------------------------+-------+
| timestamp     | Number  | 时间戳，单位：毫秒；              | Y     |
+---------------+---------+-----------------------------------+-------+
| data          | Object  | 终端待解析数据包;                 | Y     |
+---------------+---------+-----------------------------------+-------+
| MacAddress    | String  | 下挂设备的MAC地址；               | Y     |
+---------------+---------+-----------------------------------+-------+
| HostName      | String  | 下挂设备的HostName；              | N     |
+---------------+---------+-----------------------------------+-------+
| StaStatus     | Number  | STA状态，采用枚举取值；           | Y     |
|               |         |                                   |       |
|               |         | 0：STA离线；                      |       |
|               |         |                                   |       |
|               |         | 1：STA上线                        |       |
+---------------+---------+-----------------------------------+-------+
| Radio         | String  | STA接入频段，取值2.4G、5G或5G-2;  | N     |
|               |         |                                   |       |
|               |         | 注：对于三频设备，5G表示5.1G频段  |       |
|               |         | ，5G-2表示5.8G频段；双频设备忽略  |       |
|               |         | 5G-2频段；有线接入时，取值为空；  |       |
+---------------+---------+-----------------------------------+-------+
| RSSI          | String  | STA的上联信号强度，单位为dBm；    | N     |
|               |         |                                   |       |
|               |         | 说明：有线接入时，取值为空；      |       |
+---------------+---------+-----------------------------------+-------+
| RxRate        | String  | 当前的协商接收速率(Mbps)；        | N     |
+---------------+---------+-----------------------------------+-------+
| TxRate        | String  | 当前的协商发送速率(Mbps) ；       | N     |
+---------------+---------+-----------------------------------+-------+

成功示例：

{\"deviceId\":\"CMCC-30103-\*\*\*\*\*\*\*\*\*\*\*\*\",\"timestamp\":1641523029678,\"data\":{\"MacAddress\":\"00BBCCDDEEFF\",\"HostName\":\"XXXXXXXX\",\"StaStatus\":1,\"Radio\":\"5G\",\"RSSI\":\"-45\",\"RxRate\":\"2401\",\"TxRate\":\"2401\"}}

## 接口响应 {#接口响应-1 .QB标题6}

表2-26 周期/上电上报响应

  ------------------------------------------------------------------------
  参数名      类型       描述                                 是否必须
  ----------- ---------- ------------------------------------ ------------
  respCode    Number     响应码，详见附录C错误码              Y

  respCont    String     响应的返回值                         N
  ------------------------------------------------------------------------

成功示例：{\"respCode\": X}

失败示例：{\"respCode\":X,\"respCont\":\"XXXXX\"}

## 数据上报 {#数据上报 .QB标题4}

## 接口描述 {#接口描述-8 .QB标题5}

接口内容：除了注册上线认证外，组网终端主动上报家开平台的其他信息，包括IF5收到控制或查询接口后异步上报的信息都通过本接口上报；

请求topic：/device/{deviceId}/upward

请求类型：组网终端-\>家开平台

## 请求 {#请求-58 .QB标题5}

{

\"deviceId\": \"\*\*\*\*\*\",

\"seqId\": \"\*\*\*\*\*\",//功能控制/查询接口平台下发后上报

\"eventType\": \"XData\_\*\*\*\",//事件类型

\"timestamp\": \*\*\*\*\*\*,//毫秒

\"data\": {}//不同的事件类型对应不同的数据值

}

表7.4-14 组网终端数据上报参数表

  -------------------- ---------------------------------------- --------------------------------------------------
  eventType \*\*\*取值 功能说明                                 触发条件

  ApConfigInfo         信息上报                                 周期上报；收到控制、查询接口执行后上报

  UplinkStatus         上联状态                                 周期上报；收到控制、查询接口执行后上报

  STAInfo              下挂设备信息                             周期上报；收到查询接口执行后上报

  WlanNeighbor         周边Wi-Fi查询                            上电上报；周期上报；收到控制、查询接口执行后上报

  WiFiStats            收发报文统计信息                         收到控制或查询接口执行后上报

  File                 文件操作进度                             收到控制或查询接口执行后上报

  DownFileSpeed        下载速度                                 收到控制或查询接口执行后上报

  DelayTime            Ping时延                                 收到控制或查询接口执行后上报

  InternetAccessInfo   设备联网配置信息，用于查询网口相关信息   收到控制或查询接口执行后上报

  AllDeviceLimit       网速分配查询                             收到查询接口执行后上报

  AllTimerTask         定时任务查询                             收到查询接口执行后上报

  WiFiSwitch           Wi-Fi 开关结果上报                       收到控制或查询接口执行后上报

  RadioConfig          Wi-Fi功率配置结果上报                    收到控制或查询接口执行后上报

  WPS                  Wi-Fi WPS控制结果上报                    收到控制或查询接口执行后上报

  WiFiParameterSync    Wi-Fi参数控制结果上报                    收到控制或查询接口执行后上报

  MacFilter            设置黑白名单结果上报                     收到控制或查询接口执行后上报

  LEDControl           指示灯控制结果上报                       收到控制或查询接口执行后上报

  RoamingConfig        STA漫游控制结果上报                      收到控制或查询接口执行后上报

  DeviceLimit          网速分配控制上报                         收到控制接口执行后上报

  TimerTask            定时任务控制结果上报                     收到控制接口执行后上报

  OpenQlink            开启快连                                 收到控制接口执行后上报

  NetInfo              引导热点下发配网信息                     收到控制接口执行后上报

  OpenWiFiSync         Wi-Fi配置自动同步开关                    收到控制接口执行后上报

  UpdateUserkey        更新用户信息                             收到控制接口执行后上报

  MAPTopology          网络拓扑结构查询                         收到控制接口执行后上报

  WorkModelConfig      工作模式设置数据上报                     收到控制接口执行后上报

  ProvinceCode         省份码配置数据上报                       收到控制接口执行后上报

  ApBind               扫码绑定数据上报                         收到控制接口执行后上报

  5GPreferred          5GHz频段优先配置数据上报                 收到控制接口执行后上报

  QoS                  优先级调度数据上报                       收到控制接口执行后上报

  ApConfigInfo2        扩展信息查询                             收到控制接口执行后上报

  Accelerate           内网加速接口数据上报                     收到控制接口执行后上报

  HttpSpeedTest        下载测试数据上报                         收到控制接口执行后上报

  SpeedtestConfig      Speedtest测速控制                        收到控制接口执行后上报

  MulticastConfig      组播转换配置接口                         收到控制接口执行后上报
  -------------------- ---------------------------------------- --------------------------------------------------

## 信息上报 {#信息上报 .QB标题6}

说明：Y代表字段必传，且不为空（为空填默认值），N表示可选。

表7.4-15 组网终端信息上报参数表

+-------------------+---+------+-----------------------------------+-------+
| 参数名            | 类 |     | 描述                              | 是否  |
|                   | 型 |     |                                   | 必须  |
+-------------------+---+------+-----------------------------------+-------+
| type              | N |      | AP设备的上网方式，枚举如下：      | Y     |
|                   | u |      |                                   |       |
|                   | m |      | 0：DHCP ，默认                    |       |
|                   | b |      |                                   |       |
|                   | e |      | 1：PPPoE                          |       |
|                   | r |      |                                   |       |
|                   |   |      | 2：STATIC                         |       |
+-------------------+---+------+-----------------------------------+-------+
| pppoeInfo         | O |      | 拨号上网信息(上网方式为pppoe      | N     |
|                   | b |      | ，必填)，包含netAccount、netPwd。 |       |
|                   | j |      |                                   |       |
|                   | e |      |                                   |       |
|                   | c |      |                                   |       |
|                   | t |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| netAccount        | S |      | 上网账号                          | N     |
|                   | t |      |                                   |       |
|                   | r |      |                                   |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| netPwd            | S |      | 上网密码                          | N     |
|                   | t |      |                                   |       |
|                   | r |      |                                   |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| hardwareVersion   | S |      | 硬件版本                          | Y     |
|                   | t |      |                                   |       |
|                   | r |      |                                   |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| softwareVersion   | S |      | 软件版本                          | Y     |
|                   | t |      |                                   |       |
|                   | r |      |                                   |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| WorkingMode       | N |      | AP工作模式：                      | Y     |
|                   | u |      |                                   |       |
|                   | m |      | 0：桥接                           |       |
|                   | b |      |                                   |       |
|                   | e |      | 1：路由                           |       |
|                   | r |      |                                   |       |
|                   |   |      | 2：中继                           |       |
+-------------------+---+------+-----------------------------------+-------+
| UpTime            | S |      | 在线时长，单位：秒                | Y     |
|                   | t |      |                                   |       |
|                   | r |      |                                   |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| MacFilterEnable   | N |      | 是否使                            | Y     |
|                   | u |      | 能MAC地址过滤，1为过滤，0为不过滤 |       |
|                   | m |      |                                   |       |
|                   | b |      |                                   |       |
|                   | e |      |                                   |       |
|                   | r |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| MacFilterPolicy   | N |      | MAC地址过滤策略：                 | N     |
|                   | u |      |                                   |       |
|                   | m |      | 0: 黑名单                         |       |
|                   | b |      |                                   |       |
|                   | e |      | 1: 白名单                         |       |
|                   | r |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| MacFilterEntries  | S |      | 黑白名单                          | N     |
|                   | t |      | 信息：包含MAC地址及设备名（最长为 |       |
|                   | r |      | 64字节），以"/"隔开；两组信息之间 |       |
|                   | i |      | 以逗号分开，最多支持32组。示例：  |       |
|                   | n |      |                                   |       |
|                   | g |      | 001111334455/pro,                 |       |
|                   |   |      | 80717a33ccf3/android              |       |
+-------------------+---+------+-----------------------------------+-------+
| LEDOnOff          | N |      | 指示灯开关，1为On，0为Off         | Y     |
|                   | u |      |                                   |       |
|                   | m |      |                                   |       |
|                   | b |      |                                   |       |
|                   | e |      |                                   |       |
|                   | r |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| B                 |   | Nu   | 双频合一开关状态：                | N     |
| andSteeringStatus |   | mber |                                   |       |
|                   |   |      | 0: 关闭                           |       |
|                   |   |      |                                   |       |
|                   |   |      | 1: 打开                           |       |
+-------------------+---+------+-----------------------------------+-------+
| RoamingSwitch     | N |      | 是否开                            | Y     |
|                   | u |      | 启Wi-Fi漫游控制，1为启用，0为关闭 |       |
|                   | m |      |                                   |       |
|                   | b |      |                                   |       |
|                   | e |      |                                   |       |
|                   | r |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| LowRSSI2.4G       | N |      | 弱信号阈值（2.4G），单位dBm       | N     |
|                   | u |      |                                   |       |
|                   | m |      | 当STA接入                         |       |
|                   | b |      | 当前组网终端的RSSI小于该阈值时，  |       |
|                   | e |      | 组网终端需对该STA执行漫游切换控制 |       |
|                   | r |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| LowRSSI5G         | N |      | 弱信号阈值（5G），单位dBm         | N     |
|                   | u |      |                                   |       |
|                   | m |      | 当STA接入                         |       |
|                   | b |      | 当前组网终端的RSSI小于该阈值时，  |       |
|                   | e |      | 组网终端需对该STA执行漫游切换控制 |       |
|                   | r |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| ipAddress         | S |      | 组网终端IP                        | N     |
|                   | t |      |                                   |       |
|                   | r |      |                                   |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| IPv6Status        | N |      | 组网                              | N     |
|                   | u |      | 终端IPv4/IPv6双栈状态，枚举取值； |       |
|                   | m |      |                                   |       |
|                   | b |      | 0：关闭IPv4/IPv6双栈              |       |
|                   | e |      |                                   |       |
|                   | r |      | 1：开启IPv4/IPv6双栈              |       |
+-------------------+---+------+-----------------------------------+-------+
| IPv6ConnStatus    | S |      | IPv6协议的连接状态，枚举取值：    | Y     |
|                   | t |      |                                   |       |
|                   | r |      | Connected                         |       |
|                   | i |      |                                   |       |
|                   | n |      | Unconnected                       |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| IP                | S |      | IPv6地址分配机制，枚举取值：      | Y     |
| v6IPAddressOrigin | t |      |                                   |       |
|                   | r |      | AutoConfigured                    |       |
|                   | i |      |                                   |       |
|                   | n |      | DHCPv6                            |       |
|                   | g |      |                                   |       |
|                   |   |      | Static                            |       |
+-------------------+---+------+-----------------------------------+-------+
| IPv6IPAddress     | S |      | WAN连接的IPv6地址；               | Y     |
|                   | t |      |                                   |       |
|                   | r |      |                                   |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| IPv6DNSServers    | S |      | DNS Server地址。                  | Y     |
|                   | t |      |                                   |       |
|                   | r |      |                                   |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| IPv6Prefix        | S |      | Prefix Delegation使能状态；       | Y     |
| DelegationEnabled | t |      |                                   |       |
|                   | r |      | TRUE表示启用，FALSE表示禁用。     |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| IPv6PrefixOrigin  | S |      | 前缀地址分配机制，枚举取值：      | Y     |
|                   | t |      |                                   |       |
|                   | r |      | PrefixDelegation                  |       |
|                   | i |      |                                   |       |
|                   | n |      | Static                            |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| IPv6Prefix        | S |      | 前缀地址。                        | Y     |
|                   | t |      |                                   |       |
|                   | r |      |                                   |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| IPv6PrefixPltime  | N |      | 公告前缀的preferred               | Y     |
|                   | u |      | lifetime，单位：秒 ；             |       |
|                   | m |      |                                   |       |
|                   | b |      |                                   |       |
|                   | e |      |                                   |       |
|                   | r |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| IPv6PrefixVltime  | N |      | 公告前缀的valid                   | Y     |
|                   | u |      | lifetime，单位：秒 ；             |       |
|                   | m |      |                                   |       |
|                   | b |      |                                   |       |
|                   | e |      |                                   |       |
|                   | r |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| D                 | S |      | IPv6默认网关 ；                   | Y     |
| efaultIPv6Gateway | t |      |                                   |       |
|                   | r |      |                                   |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| Dslite_Enable     | S |      | 是否启用DS-lite功能。             | Y     |
|                   | t |      |                                   |       |
|                   | r |      | TRUE表示启用，FALSE表示禁用。     |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| LockNetStatus     | N |      | 锁网状                            | Y     |
|                   | u |      | 态标识，表示设备当前的锁网状态：  |       |
|                   | m |      |                                   |       |
|                   | b |      | 1为锁网，0为不锁网；              |       |
|                   | e |      |                                   |       |
|                   | r |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| Radios            | A |      | Wi-Fi射频信息的数组，包           | Y     |
|                   | r |      | 含以下字段：Radio，Enable，Transm |       |
|                   | r |      | itPower，Channel、Bandwidth字段； |       |
|                   | a |      |                                   |       |
|                   | y |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| Radio             | S |      | Radios数组之一，频段，枚举取值：  | Y     |
|                   | t |      |                                   |       |
|                   | r |      | 2.4G                              |       |
|                   | i |      |                                   |       |
|                   | n |      | 5G                                |       |
|                   | g |      |                                   |       |
|                   |   |      | 5G-2                              |       |
|                   |   |      |                                   |       |
|                   |   |      | 注：对于三                        |       |
|                   |   |      | 频设备，5G表示5.1G频段，5G-2表示  |       |
|                   |   |      | 5.8G频段；双频设备忽略5G-2频段；  |       |
+-------------------+---+------+-----------------------------------+-------+
| Enable            | N |      | 频段是否启用，1为启用，0为禁用    | Y     |
|                   | u |      |                                   |       |
|                   | m |      |                                   |       |
|                   | b |      |                                   |       |
|                   | e |      |                                   |       |
|                   | r |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| TransmitPower     | S |      | Wi-Fi发射功率级别（百分比）       | Y     |
|                   | t |      |                                   |       |
|                   | r |      |                                   |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| Channel           | S |      | 当前工作信道号                    | Y     |
|                   | t |      |                                   |       |
|                   | r |      |                                   |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| LoadRate          | N |      | 当前信                            | N     |
|                   | u |      | 道使用率（%），数据范围：0-100；  |       |
|                   | m |      |                                   |       |
|                   | b |      | 说明：应                          |       |
|                   | e |      | 包含自身数据收发和周边干扰之和；  |       |
|                   | r |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| Bandwidth         | N |      | 当前Wi-Fi频宽，采用枚举取值：     | N     |
|                   | u |      |                                   |       |
|                   | m |      | 0：自动频宽                       |       |
|                   | b |      |                                   |       |
|                   | e |      | 1：20MHz                          |       |
|                   | r |      |                                   |       |
|                   |   |      | 2：40MHz                          |       |
|                   |   |      |                                   |       |
|                   |   |      | 3：80MHz                          |       |
|                   |   |      |                                   |       |
|                   |   |      | 4：160MHz                         |       |
|                   |   |      |                                   |       |
|                   |   |      | 5：80+80MHz                       |       |
|                   |   |      |                                   |       |
|                   |   |      | 说明：对于2.4                     |       |
|                   |   |      | G频段，自动频宽功能为20/40MHz频宽 |       |
|                   |   |      | 自适应；对于5G频段，自动频宽功能  |       |
|                   |   |      | 对应为20/40/80/160MHz频宽自适应； |       |
+-------------------+---+------+-----------------------------------+-------+
| Configurations    | A |      | Wi-Fi配置参数数组                 | Y     |
|                   | r |      |                                   |       |
|                   | r |      |                                   |       |
|                   | a |      |                                   |       |
|                   | y |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| Radio             | S |      | 频段，枚举取值：                  | Y     |
|                   | t |      |                                   |       |
|                   | r |      | 2.4G                              |       |
|                   | i |      |                                   |       |
|                   | n |      | 5G                                |       |
|                   | g |      |                                   |       |
|                   |   |      | 5G-2                              |       |
|                   |   |      |                                   |       |
|                   |   |      | 注：对于三                        |       |
|                   |   |      | 频设备，5G表示5.1G频段，5G-2表示  |       |
|                   |   |      | 5.8G频段；双频设备忽略5G-2频段；  |       |
+-------------------+---+------+-----------------------------------+-------+
| Index             | N |      | SSID的索引                        | Y     |
|                   | u |      |                                   |       |
|                   | m |      |                                   |       |
|                   | b |      |                                   |       |
|                   | e |      |                                   |       |
|                   | r |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| Enable            | N |      | 是否启用，1为启用，0为禁用        | Y     |
|                   | u |      |                                   |       |
|                   | m |      |                                   |       |
|                   | b |      |                                   |       |
|                   | e |      |                                   |       |
|                   | r |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| SSID              | S |      | SSID名称                          | Y     |
|                   | t |      |                                   |       |
|                   | r |      |                                   |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| SecurityMode      | S |      | 认证加密模式，枚举取值：          | Y     |
|                   | t |      |                                   |       |
|                   | r |      | None                              |       |
|                   | i |      |                                   |       |
|                   | n |      | WEP-64                            |       |
|                   | g |      |                                   |       |
|                   |   |      | WEP-128                           |       |
|                   |   |      |                                   |       |
|                   |   |      | WPA-Personal                      |       |
|                   |   |      |                                   |       |
|                   |   |      | WPA2-Personal                     |       |
|                   |   |      |                                   |       |
|                   |   |      | MIXED-WPAPSK2                     |       |
|                   |   |      |                                   |       |
|                   |   |      | WPA3-SAE                          |       |
|                   |   |      |                                   |       |
|                   |   |      | MIXED-WPA2WPA3                    |       |
+-------------------+---+------+-----------------------------------+-------+
| Encrypt           | N |      | 加密算法，枚举取值：              | N     |
|                   | u |      |                                   |       |
|                   | m |      | 0：None:                          |       |
|                   | b |      |                                   |       |
|                   | e |      | 1：AES                            |       |
|                   | r |      |                                   |       |
|                   |   |      | 2：TKIP                           |       |
|                   |   |      |                                   |       |
|                   |   |      | 3：AES+TKIP                       |       |
+-------------------+---+------+-----------------------------------+-------+
| Pwd               | S |      | Wi-Fi密钥，WEP Key或Pre-shared    | Y     |
|                   | t |      | Ke                                |       |
|                   | r |      | y。管理平台不应存储和显示此参数。 |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| MaxAssociateNum   | N |      | 该SSID最大允许接入的用户数        | Y     |
|                   | u |      |                                   |       |
|                   | m |      |                                   |       |
|                   | b |      |                                   |       |
|                   | e |      |                                   |       |
|                   | r |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| SSIDAdv           | N |      | 是否广播SSID，1为广播，0为不广播  | Y     |
| ertisementEnabled | u |      |                                   |       |
|                   | m |      |                                   |       |
|                   | b |      |                                   |       |
|                   | e |      |                                   |       |
|                   | r |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| SSIDStandard      | S |      | WL                                | N     |
|                   | t |      | AN口支持的无线传输标准，枚举取值: |       |
|                   | r |      |                                   |       |
|                   | i |      | 11b/g                             |       |
|                   | n |      |                                   |       |
|                   | g |      | 11b/g/n                           |       |
|                   |   |      |                                   |       |
|                   |   |      | 11b/g/n/ax                        |       |
|                   |   |      |                                   |       |
|                   |   |      | 11a/n/ac/ax                       |       |
|                   |   |      |                                   |       |
|                   |   |      | 11a/n/ac                          |       |
|                   |   |      |                                   |       |
|                   |   |      | 11a/n                             |       |
|                   |   |      |                                   |       |
|                   |   |      | 11n                               |       |
|                   |   |      |                                   |       |
|                   |   |      | 11a                               |       |
|                   |   |      |                                   |       |
|                   |   |      | 11b                               |       |
|                   |   |      |                                   |       |
|                   |   |      | 11g                               |       |
+-------------------+---+------+-----------------------------------+-------+
| CPUOccupancyRate  | N |      | 0-100（CPU占用率）                | Y     |
|                   | u |      |                                   |       |
|                   | m |      |                                   |       |
|                   | b |      |                                   |       |
|                   | e |      |                                   |       |
|                   | r |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| RamOccupancyRate  | N |      | 0-100（RAM占用率）                | Y     |
|                   | u |      |                                   |       |
|                   | m |      |                                   |       |
|                   | b |      |                                   |       |
|                   | e |      |                                   |       |
|                   | r |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| FlashSize         | N |      | Flash大小（单位：Mbytes）         | Y     |
|                   | u |      |                                   |       |
|                   | m |      |                                   |       |
|                   | b |      |                                   |       |
|                   | e |      |                                   |       |
|                   | r |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| RamSize           | N |      | Ram大小（单位：Mbytes）           | Y     |
|                   | u |      |                                   |       |
|                   | m |      |                                   |       |
|                   | b |      |                                   |       |
|                   | e |      |                                   |       |
|                   | r |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| deviceVendor      | S |      | 厂商编码                          | N     |
|                   | t |      |                                   |       |
|                   | r |      |                                   |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| deviceModel       | S |      | 型号编码                          | N     |
|                   | t |      |                                   |       |
|                   | r |      |                                   |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| cpuType           | S |      | CPU型号，例如:MT7621A             | N     |
|                   | t |      |                                   |       |
|                   | r |      |                                   |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| deviceSn          | S |      | 组网终端SN                        | N     |
|                   | t |      |                                   |       |
|                   | r |      |                                   |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| userBind          | N |      | 用户绑定状态，0未绑定，1绑定；    | N     |
|                   | u |      |                                   |       |
|                   | m |      |                                   |       |
|                   | b |      |                                   |       |
|                   | e |      |                                   |       |
|                   | r |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| ClientIP          | S |      | 设备出口公网IP；                  | N     |
|                   | t |      |                                   |       |
|                   | r |      |                                   |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+
| provinceCode      | S |      | 组网终端省份信息                  | N     |
|                   | t |      |                                   |       |
|                   | r |      |                                   |       |
|                   | i |      |                                   |       |
|                   | n |      |                                   |       |
|                   | g |      |                                   |       |
+-------------------+---+------+-----------------------------------+-------+

示例：

{\"deviceId\":\"myDeviceId\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_ApConfigInfo\",\"timestamp\":1626948825804,\"data\":{\"type\":1,\"pppoeInfo\":{\"netAccount\":\"xxxxxxxx\",\"netPwd\":\"XXXssX\"},\"hardwareVersion\":\"1.01\",\"softwareVersion\":\"3.2\",\"WorkingMode\":0,\"UpTime\":\"650\",\"MacFilterEnable\":1,\"MacFilterPolicy\":0,\"MacFilterEntries\":\"AABBCCDDEEFF/iphone,FFEEDDCCBBAA/sam\",\"LEDOnOff\":1,\"BandSteeringEnable\":0,\"RoamingSwitch\":1,\"LowRSSI2.4G\":-80,\"LowRSSI5G\":-80,\"ipAddress\":\"192.168.10.1\",\"IPv6Status\":1,\"IPv6ConnStatus\":\"Connected\",\"IPv6IPAddressOrigin\":\"Static\",\"IPv6IPAddress\":\"2001:DA8:1000::F1\",\"IPv6DNSServers\":\"2001:DA8:6000::F1\",\"IPv6PrefixDelegationEnabled\":\"FALSE\",\"IPv6PrefixOrigin\":\"Static\",\"IPv6Prefix\":\"2001:1:2:3::/48\",\"IPv6PrefixPltime\":86400,\"IPv6PrefixVltime\":86400,\"DefaultIPv6Gateway\":\"2001:DA8:6000::F2\",\"Dslite_Enable\":\"TRUE\",\"LockNetStatus\":0,\"Radios\":\[{\"Radio\":\"2.4G\",\"Enable\":1,\"TransmitPower\":\"100\",\"Channel\":\"6\",\"LoadRate\":10,\"Bandwidth\":1},{\"Radio\":\"5G\",\"Enable\":1,\"TransmitPower\":\"100\",\"Channel\":\"6\",\"LoadRate\":10,\"Bandwidth\":4}\],\"Configurations\":\[{\"Radio\":\"2.4G\",\"Index\":1,\"Enable\":1,\"SSID\":\"CMCC-2341\",\"SecurityMode\":\"MIXED-WPAPSK2\",\"Encrypt\":3,\"Pwd\":\"\*\*\*\*\*\*\*\",\"MaxAssociateNum\":64,\"SSIDAdvertisementEnabled\":1,\"SSIDStandard\":\"11b/g/n\"},{\"Radio\":\"5G\",\"Index\":5,\"Enable\":1,\"SSID\":\"CMCC-2341-5G\",\"SecurityMode\":\"MIXED-WPAPSK2\",\"Encrypt\":3,\"Pwd\":\"\*\*\*\*\*\*\*\",\"MaxAssociateNum\":64,\"SSIDAdvertisementEnabled\":1,\"SSIDStandard\":\"11a/n/ac/ax\"}\],\"CPUOccupancyRate\":2,\"CPUTemperature\":40,\"RamOccupancyRate\":71,\"cpuType\":\"MTK7621A\",\"FlashSize\":128,\"RamSize\":256,\"deviceVendor\":\"01\",\"deviceModel\":\"1101\",\"cpuType\":\"MT7621A\",\"deviceSn\":\"011101\*\*\*\*\*\*\",\"userBind\":1,
\"ClientIP\":\"\*\*\*.\*\*\*.\*\*\*.\*\*\*\",\"provinceCode\":\"ZHJ\"}}

## 上联状态 {#上联状态-1 .QB标题6}

表7.4-16 组网终端上联状态参数表

+-----------+-----+-------------------------------------------+--------+
| 参数名    | 类  | 描述                                      | 是     |
|           | 型  |                                           | 否必须 |
+===========+=====+===========================================+========+
| U         | Str | 当前的上行接入方式：                      | Y      |
| plinkType | ing |                                           |        |
|           |     | WLAN、Ethernet、PLC、Cable、Optical       |        |
|           |     | Ethernet、GPON、XGPON、PoE                |        |
+-----------+-----+-------------------------------------------+--------+
| M         | Str | 上联使用的管理MAC地址                     | Y      |
| acAddress | ing |                                           |        |
+-----------+-----+-------------------------------------------+--------+
| Radio     | Str | WLAN上联时                                | N      |
|           | ing | 使用的频段，取值2.4G或5G，WLAN上行时必选  |        |
+-----------+-----+-------------------------------------------+--------+
| SSID      | Str | WLAN上联时接入的SSID名称，WLAN上行时必选  | N      |
|           | ing |                                           |        |
+-----------+-----+-------------------------------------------+--------+
| Channel   | Str | WLAN上联时的工作信道号，WLAN上行时必选    | N      |
|           | ing |                                           |        |
+-----------+-----+-------------------------------------------+--------+
| Noise     | Str | WLAN                                      | N      |
|           | ing | 上联时的噪声强度，单位dBm，WLAN上行时必选 |        |
+-----------+-----+-------------------------------------------+--------+
| SNR       | Str | W                                         | N      |
|           | ing | LAN上联时的信噪比，单位dB，WLAN上行时必选 |        |
+-----------+-----+-------------------------------------------+--------+
| RSSI      | Str | WLAN上联时                                | N      |
|           | ing | 的上联信号强度，单位为dBm，WLAN上行时必选 |        |
+-----------+-----+-------------------------------------------+--------+
| ~~Fiber   | ~   | ~~光上                                    | ~~N~~  |
| TXPower~~ | ~St | 联时发射光功率，单位dBm；光接入时必选；~~ |        |
|           | rin |                                           |        |
|           | g~~ |                                           |        |
+-----------+-----+-------------------------------------------+--------+
| ~~Fiber   | ~   | ~~光上                                    | ~~N~~  |
| RXPower~~ | ~St | 联时接收光功率，单位dBm；光接入时必选；~~ |        |
|           | rin |                                           |        |
|           | g~~ |                                           |        |
+-----------+-----+-------------------------------------------+--------+
| RxRate    | Str | 上行的协商接收速率(Mbps)                  | Y      |
|           | ing |                                           |        |
+-----------+-----+-------------------------------------------+--------+
| TxRate    | Str | 上行的协商发送速率(Mbps)                  | Y      |
|           | ing |                                           |        |
+-----------+-----+-------------------------------------------+--------+
| RxRate_rt | Str | 上行的实时接收速率(Mbps)                  | Y      |
|           | ing |                                           |        |
+-----------+-----+-------------------------------------------+--------+
| TxRate_rt | Str | 上行的实时发送速率(Mbps)                  | Y      |
|           | ing |                                           |        |
+-----------+-----+-------------------------------------------+--------+
| A         | Str | 上行实时接收速率周期均值，单位Mbps        | N      |
| verRxRate | ing |                                           |        |
|           |     | 该字段仅在周期上报时必选，查询上报时不报  |        |
+-----------+-----+-------------------------------------------+--------+
| A         | Str | 上行实时发送速率周期均值，单位Mbps        | N      |
| verTxRate | ing |                                           |        |
|           |     | 该字段仅在周期上报时必选，查询上报时不报  |        |
+-----------+-----+-------------------------------------------+--------+
| MaxRxRate | Str | 上行实现接收速率周期最大值，单位Mbps      | N      |
|           | ing |                                           |        |
|           |     | 该字段仅在周期上报时必选，查询上报时不报  |        |
+-----------+-----+-------------------------------------------+--------+
| MaxTxRate | Str | 上行实时发送速率周期最大值，单位Mbps      | N      |
|           | ing |                                           |        |
|           |     | 该字段仅在周期上报时必选，查询上报时不报  |        |
+-----------+-----+-------------------------------------------+--------+

示例：

{\"deviceId\":\"myDeviceId\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_UplinkStatus\",\"timestamp\":1626948825804,\"data\":{\"UplinkType\":\"WLAN\",\"MacAddress\":\"012233445566\",\"Radio\":\"2.4G\",\"SSID\":\"CMCC-1234\",\"Channel\":\"6\",\"Noise\":\"-90\",\"SNR\":\"35\",\"RSSI\":\"-55\",\"RxRate\":\"144\",\"TxRate\":\"144\",\"RxRate_rt\":\"0\",\"TxRate_rt\":\"0\",\"AverRXRate\":\"100\",\"AverTXRate\":\"100\",\"MaxRXRate\":\"100\",\"MaxTXRate\":\"100\"}}

## 下挂设备信息 {#下挂设备信息-2 .QB标题6}

表7.4-17 组网终端下挂设备信息参数表

+----------------+--------+------------------------------------+------+
| 参数名         | 类型   | 描述                               | 是否 |
|                |        |                                    | 必须 |
+----------------+--------+------------------------------------+------+
| TotalBytesSent | Long   | 总发送字节数（上行口数据）         | N    |
+----------------+--------+------------------------------------+------+
| Tota           | Long   | 总接收字节数（上行口数据）         | N    |
| lBytesReceived |        |                                    |      |
+----------------+--------+------------------------------------+------+
| To             | Long   | 总发送包数（上行口数据）           | N    |
| talPacketsSent |        |                                    |      |
+----------------+--------+------------------------------------+------+
| TotalP         | Long   | 总接收包数（上行口数据）           | N    |
| acketsReceived |        |                                    |      |
+----------------+--------+------------------------------------+------+
| ErrorsSent     | Long   | 发送出错的包数（上行口数据）       | N    |
+----------------+--------+------------------------------------+------+
| ErrorsReceived | Long   | 接收的错误包数（上行口数据）       | N    |
+----------------+--------+------------------------------------+------+
| Disc           | Long   | 发送时丢弃的包数（上行口数据）     | N    |
| ardPacketsSent |        |                                    |      |
+----------------+--------+------------------------------------+------+
| DiscardP       | Long   | 接收时丢弃的包数（上行口数据）     | N    |
| acketsReceived |        |                                    |      |
+----------------+--------+------------------------------------+------+
| [~~data        | [      | [~~数据                            | ~    |
| type~~]{.mark} | ~~Numb | 上报类型，采用枚举取值；~~]{.mark} | ~N~~ |
|                | er~~]{ |                                    |      |
|                | .mark} | ~~0：周期上报；~~                  |      |
|                |        |                                    |      |
|                |        | ~~1：主动上报~~                    |      |
|                |        |                                    |      |
|                |        | ~~该字段仅需周期上报接口中携带；~~ |      |
+----------------+--------+------------------------------------+------+
| Ipv6           | Long   | IPv6总发送字节数（上行口数据）     | N    |
| TotalBytesSent |        |                                    |      |
+----------------+--------+------------------------------------+------+
| Ipv6Tota       | Long   | IPv6总接收字节数（上行口数据）     | N    |
| lBytesReceived |        |                                    |      |
+----------------+--------+------------------------------------+------+
| BytesSent2G    | Long   | 2.4GHz频段发送字节                 | N    |
|                |        | 数（统计SSID-1及SSID-3的总字节数） |      |
+----------------+--------+------------------------------------+------+
| B              | Long   | 2.4GHz频段接收字节                 | N    |
| ytesReceived2G |        | 数（统计SSID-1及SSID-3的总字节数） |      |
+----------------+--------+------------------------------------+------+
| BytesSent5G    | Long   | 5GHz频段发送字节                   | N    |
|                |        | 数（统计SSID-5及SSID-7的总字节数） |      |
+----------------+--------+------------------------------------+------+
| B              | Long   | 5GHz频段接收字节                   | N    |
| ytesReceived5G |        | 数（统计SSID-5及SSID-7的总字节数） |      |
+----------------+--------+------------------------------------+------+
| BytesSent5G2   | Long   | 5G-2频段发送字节数（               | N    |
|                |        | 统计SSID-9及SSID-11的总字节数）；  |      |
|                |        |                                    |      |
|                |        | 注：对于三频设备，该字段必选；     |      |
|                |        | 5GHz频段表示5.1G频段，5G-2表示     |      |
|                |        | 5.8G频段；双频终端无需上报该字段； |      |
+----------------+--------+------------------------------------+------+
| By             | Long   | 5G-2频段接收字节数                 | N    |
| tesReceived5G2 |        | （统计SSID-9及SSID-11的总字节数）  |      |
|                |        |                                    |      |
|                |        | 注：对于三频设备，该字段必选；     |      |
|                |        | 5GHz频段表示5.1G频段，5G-2表示     |      |
|                |        | 5.8G频段；双频终端无需上报该字段； |      |
+----------------+--------+------------------------------------+------+
| STANumber      | Number | 下挂设备                           | Y    |
|                |        | 数据，当值为0时，设备信息数组为空  |      |
+----------------+--------+------------------------------------+------+
| Devices        | Array  | 连接的                             | N    |
|                |        | 设备信息数组，下挂设备数非零时必选 |      |
+----------------+--------+------------------------------------+------+
| IPAddress      | String | 下挂设备                           | N    |
|                |        | 的IPAddress，下挂设备数非零时必选  |      |
+----------------+--------+------------------------------------+------+
| ST             | String | 下挂设备的IPV6地址；该字段         | N    |
| AIPv6IPAddress |        | 在下挂设备数非零，且支持IPv6时必选 |      |
+----------------+--------+------------------------------------+------+
| HostName       | String | 下挂设                             | N    |
|                |        | 备的HostName，下挂设备数非零时必选 |      |
+----------------+--------+------------------------------------+------+
| MacAddress     | String | 下挂设                             | N    |
|                |        | 备的MAC地址，下挂设备数非零时必选  |      |
+----------------+--------+------------------------------------+------+
| VMacAddress    | String | 下挂设备在组网                     | N    |
|                |        | 终端下的虚拟MAC，如果未转换，则和  |      |
|                |        | 真实MAC一致，下挂设备数非零时必选  |      |
+----------------+--------+------------------------------------+------+
| UpTime         | String | 已连接时                           | N    |
|                |        | 间，单位：秒，下挂设备数非零时必选 |      |
+----------------+--------+------------------------------------+------+
| C              | Number | 下挂设备连接协议，枚举取           | N    |
| onnectProtocol |        | 值，下挂设备通过Wi-Fi连接时必选；  |      |
|                |        |                                    |      |
|                |        | 0：非Wi-Fi接入                     |      |
|                |        |                                    |      |
|                |        | 1：11a或11b                        |      |
|                |        |                                    |      |
|                |        | 2：11g                             |      |
|                |        |                                    |      |
|                |        | 3：11n                             |      |
|                |        |                                    |      |
|                |        | 4：11ac                            |      |
|                |        |                                    |      |
|                |        | 5：11ax                            |      |
+----------------+--------+------------------------------------+------+
| Radio          | String | WLAN下挂设备的接入频段，取值2.4G   | N    |
|                |        | 、5G或5G-2，对非WLAN下挂设备应填空 |      |
|                |        | 值；该字段在下挂设备数非零时必选;  |      |
|                |        |                                    |      |
|                |        | 注：对                             |      |
|                |        | 于三频设备，5G表示5.1G频段，5G-2表 |      |
|                |        | 示5.8G频段；双频设备忽略5G-2频段； |      |
+----------------+--------+------------------------------------+------+
| SSID           | String | WLAN下挂                           | N    |
|                |        | 设备的接入SSID名称，对非WLAN下挂设 |      |
|                |        | 备应填空值""，下挂设备数非零时必选 |      |
+----------------+--------+------------------------------------+------+
| RSSI           | String | WLAN下挂设备当前的信               | N    |
|                |        | 号强度，单位为dBm，对非WLAN下挂设  |      |
|                |        | 备应填空值""，下挂设备数非零时必选 |      |
+----------------+--------+------------------------------------+------+
| RxRate         | String | 当前的协商接                       | N    |
|                |        | 收速率(Mbps)，下挂设备数非零时必选 |      |
+----------------+--------+------------------------------------+------+
| TxRate         | String | 当前的协商发送速率(Mbps)           | N    |
|                |        | ，下挂设备数非零时必选             |      |
+----------------+--------+------------------------------------+------+
| RxRate_rt      | String | 上行的实时接                       | N    |
|                |        | 收速率(Mbps)，下挂设备数非零时必选 |      |
+----------------+--------+------------------------------------+------+
| TxRate_rt      | String | 上行的实时发送速率(Mbps)           | N    |
|                |        | ，下挂设备数非零时必选             |      |
+----------------+--------+------------------------------------+------+
| STAType        | String | 下挂设备类                         | N    |
|                |        | 型，枚举方式；下挂设备数非零时必选 |      |
|                |        |                                    |      |
|                |        | PC、P                              |      |
|                |        | hone、TV、Router、IoT、IPC、others |      |
+----------------+--------+------------------------------------+------+
| BytesSent      | Long   | 下挂设备发送字节数                 | N    |
+----------------+--------+------------------------------------+------+
| BytesReceived  | Long   | 下挂设备接收字节数                 | N    |
+----------------+--------+------------------------------------+------+
| AverRxRate     | String | 下挂                               | N    |
|                |        | 设备接收流量周期均值，单位：Mbps； |      |
|                |        |                                    |      |
|                |        | 该字段在下挂设备数非零时必选，     |      |
|                |        | 仅在周期上报时必选，查询上报时不报 |      |
+----------------+--------+------------------------------------+------+
| AverTxRate     | String | 下挂                               | N    |
|                |        | 设备发送流量周期均值，单位：Mbps； |      |
|                |        |                                    |      |
|                |        | 该字段在下挂设备数非零时必选，     |      |
|                |        | 仅在周期上报时必选，查询上报时不报 |      |
+----------------+--------+------------------------------------+------+
| MaxRxRate      | String | 下挂设                             | N    |
|                |        | 备接收流量周期最大值，单位：Mbps； |      |
|                |        |                                    |      |
|                |        | 该字段在下挂设备数非零时必选，     |      |
|                |        | 仅在周期上报时必选，查询上报时不报 |      |
+----------------+--------+------------------------------------+------+
| MaxTxRate      | String | 下挂设                             | N    |
|                |        | 备发送流量周期最大值，单位：Mbps； |      |
|                |        |                                    |      |
|                |        | 该字段在下挂设备数非零时必选，     |      |
|                |        | 仅在周期上报时必选，查询上报时不报 |      |
+----------------+--------+------------------------------------+------+

示例：

{\"deviceId\":\"myDeviceId\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_STAInfo\",\"timestamp\":1626948825804,\"data\":{\"TotalBytesSent\":232343040,\"TotalBytesReceived\":232456790,\"TotalPacketsSent\":346870,\"TotalPacketsReceived\":457321,\"ErrorsSent\":21,\"ErrorsReceived\":0,\"DiscardPacketsSent\":0,\"DiscardPacketsReceived\":0,\"Ipv6TotalBytesSent\":2323430,\"Ipv6TotalBytesReceived\":2324560,\"BytesSent2G\":346870,\"BytesReceived2G\":457321,\"BytesSent5G\":132343040,\"BytesReceived5G\":132456790,\"BytesSent5G2\":0,\"BytesReceived5G2\":0,\"STANumber\":2,\"Devices\":\[{\"IPAddress\":\"192.168.10.1\",\"STAIPv6IPAddress\":\"2001:DA8:1000::F1\",\"hostName\":\"opporeno10\",\"MacAddress\":\"AABBCCDDEEFF\",\"VMacAddress\":\"AABBCCDDEEFF\",\"UpTime\":\"650\",\"ConnectProtocol\":5,\"Radio\":\"2.4G\",\"SSID\":\"CMCC-1234\",\"RSSI\":\"-60\",\"RxRate\":\"144\",\"TxRate\":\"144\",\"STAType\":\"phone\",\"BytesSent\":23234,\"BytesReceived\":232,\"AverRXRate\":\"100\",\"AverTxRate\":\"100\",\"MaxRXRate\":\"150\",\"MaxTxRate\":\"150\"},{\"IPAddress\":\"192.168.10.2\",\"STAIPv6IPAddress\":\"2001:DA8:1000::F2\",\"hostName\":\"opporeno10\",\"MacAddress\":\"FFEEDDCCBBAA\",\"VMacAddress\":\"FFEEDDCCBBAA\",\"UpTime\":\"880\",\"ConnectProtocol\":5,\"Radio\":\"2.4G\",\"SSID\":\"CMCC-1234\",\"RSSI\":\"-56\",\"RxRate\":\"144\",\"TxRate\":\"144\",\"STAType\":\"phone\",\"BytesSent\":23234,\"BytesReceived\":232,\"AverRXRate\":\"100\",\"AverTxRate\":\"100\",\"MaxRXRate\":\"150\",\"MaxTxRate\":\"150\"}\]}}

## 周边Wi-Fi信息 {#周边wi-fi信息-2 .QB标题6}

> 表7.4-18 周边Wi-Fi信息数据体

+---------+--------+------------------------------------------+-------+
| 参数名  | 类型   | 描述                                     | 是否  |
|         |        |                                          | 必须  |
+=========+========+==========================================+=======+
| Number  | Number | 周边                                     | Y     |
|         |        | Wi-Fi数量，当值为0时，Wi-Fi信息数组为空  |       |
+---------+--------+------------------------------------------+-------+
| Radios  | Array  | 周边                                     | N     |
|         |        | Wi-Fi信息数组，周边Wi-Fi数量为非零时必选 |       |
+---------+--------+------------------------------------------+-------+
| Radio   | String | 频段：2                                  | N     |
|         |        | .4G、5G；该字段在周边Wi-Fi数量非零时必选 |       |
+---------+--------+------------------------------------------+-------+
| SSID    | String | 周边Wi-Fi的S                             | N     |
|         |        | SID名称；该字段在周边Wi-Fi数量非零时必选 |       |
+---------+--------+------------------------------------------+-------+
| Mac     | String | 周边Wi-Fi                                | N     |
| Address |        | 的MAC地址，格式为不带冒号并且大写；      |       |
|         |        |                                          |       |
|         |        | 该字段在周边Wi-Fi数量非零时必选          |       |
+---------+--------+------------------------------------------+-------+
| Channel | String | 周边Wi-Fi信道                            | N     |
|         |        | ，如存在多信道，引用","逗号分隔，例："1  |       |
|         |        | ,6"；                                    |       |
|         |        |                                          |       |
|         |        | 该字段在周边Wi-Fi数量非零时必选          |       |
+---------+--------+------------------------------------------+-------+
| Ba      | Number | 周边Wi-Fi频宽，                          | N     |
| ndwidth |        | 采用枚举取值：周边Wi-Fi数量非零时必选；  |       |
|         |        |                                          |       |
|         |        | 1：20MHz                                 |       |
|         |        |                                          |       |
|         |        | 2：40MHz                                 |       |
|         |        |                                          |       |
|         |        | 3：80MHz                                 |       |
|         |        |                                          |       |
|         |        | 4：160MHz                                |       |
|         |        |                                          |       |
|         |        | 5：80+80MHz                              |       |
|         |        |                                          |       |
|         |        | 0：自适应频宽                            |       |
+---------+--------+------------------------------------------+-------+
| RSSI    | String | 周边Wi-Fi的弱信号值，单位dBm；           | N     |
|         |        |                                          |       |
|         |        | 周边Wi-Fi数量非零时必选；                |       |
+---------+--------+------------------------------------------+-------+
| L       | Number | 信道使用率（%），数据范围：0-100；       | N     |
| oadRate |        |                                          |       |
+---------+--------+------------------------------------------+-------+
| Wifis   | Number | 周边Wi-Fi使用的无线标准，                | N     |
| tandard |        | 采用枚举取值：周边Wi-Fi数量非零时必选；  |       |
|         |        |                                          |       |
|         |        | 0：:802.11a或802.11b                     |       |
|         |        |                                          |       |
|         |        | 1：802.11b/g                             |       |
|         |        |                                          |       |
|         |        | 2：802.11b/g/n                           |       |
|         |        |                                          |       |
|         |        | 3：802.11a/n/ac                          |       |
|         |        |                                          |       |
|         |        | 4：802.11b/g/n/ax                        |       |
|         |        |                                          |       |
|         |        | 5：802.11a/n/ac/ax                       |       |
|         |        |                                          |       |
|         |        | 6：802.11a/n                             |       |
|         |        |                                          |       |
|         |        | 7：802.11n                               |       |
|         |        |                                          |       |
|         |        | 8：802.11g                               |       |
|         |        |                                          |       |
|         |        | 9：802.11g/n                             |       |
+---------+--------+------------------------------------------+-------+

注：

①周边Wi-Fi数量超过24时，按RSSI信号强度从大到小上报24个周边Wi-Fi信息；

示例：

② 设备上电时，AP默认执行全信道扫描，获取所有信道周边干扰数据；

③ 平台开启周边Wi-Fi
周期上报功能时，仅需获取工作信道周边Wi-Fi数据，并上报到平台；

④
当平台下发扫描指令时，AP按平台下发扫描要求（全信道或工作信道）进行扫描；当平台未下发扫描范围或扫描方案的参数错误时，默认执行工作信道扫描。

{\"deviceId\":\"myDeviceId\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_WlanNeighbor\",\"timestamp\":1626948825804,\"data\":{\"Number\":2,\"Radios\":\[{\"Radio\":\"2.4G\",\"SSID\":\"CMCC-1234\",\"MacAddress\":\"0A2233445568\",\"Channel\":\"1\",\"Bandwidth\":\"1\",\"RSSI\":\"-60\",\"LoadRate\":50,\"Wifistandard\":\"2\"},{\"Radio\":\"5G\",\"SSID\":\"CMCC-1234\",\"MacAddress\":\"0B2233445566\",\"Channel\":\"36\",\"Bandwidth\":\"4\",\"RSSI\":\"-50\",\"LoadRate\":10,\"Wifistandard\":\"4\"}\]}}

## 收发报文统计信息 {#收发报文统计信息 .QB标题6}

表7.4-19 收发报文统计信息参数表

  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  参数名                   类型     描述                                                                                                                           是否必须
  ------------------------ -------- ------------------------------------------------------------------------------------------------------------------------------ ----------
  Stats                    Array    每个用户侧接口的报文统计数组（WLAN接口基于SSID统计；以太网接口基于端口统计，并按接口序号从小到大的次序依次出现在响应消息中）   Y

  Radio                    String   WLAN接口的频段，取值2.4G或5G，以太接口填0                                                                                      Y

  Index                    Number   WLAN接口的SSID索引和以太接口序号                                                                                               Y

  SSID                     String   WLAN接口的SSID名称，非WLAN接口填空值                                                                                           Y

  TotalBytesSent           Long     总发送字节数                                                                                                                   Y

  TotalBytesReceived       Long     总接收字节数                                                                                                                   Y

  TotalPacketsSent         Long     总发送包数                                                                                                                     Y

  TotalPacketsReceived     Long     总接收包数                                                                                                                     Y

  ErrorsSent               Long     发送出错的包数                                                                                                                 Y

  ErrorsReceived           Long     接收的错误包数                                                                                                                 Y

  DiscardPacketsSent       Long     发送时丢弃的包数                                                                                                               Y

  DiscardPacketsReceived   Long     接收时丢弃的包数                                                                                                               Y
  ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------

示例：

{\"deviceId\":\"myDeviceId\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_WiFiStats\",\"timestamp\":1626948825804,\"data\":{\"Stats\":\[{\"Radio\":\"2.4G\",\"Index\":1,\"SSID\":\"CMCC-1234\",\"TotalBytesSent\":232343040,\"TotalBytesReceived\":232456790,\"TotalPacketsSent\":346870,\"TotalPacketsReceived\":457321,\"ErrorsSent\":21,\"ErrorsReceived\":0,\"DiscardPacketsSent\":0,\"DiscardPacketsReceived\":0},{\"Radio\":\"5G\",\"Index\":5,\"SSID\":\"CMCC-1234-5G\",\"TotalBytesSent\":232343040,\"TotalBytesReceived\":232456790,\"TotalPacketsSent\":346870,\"TotalPacketsReceived\":457321,\"ErrorsSent\":21,\"ErrorsReceived\":0,\"DiscardPacketsSent\":0,\"DiscardPacketsReceived\":0}\]}}

## 文件操作进度 {#文件操作进度 .QB标题6}

表7.4-20文件操作参数表

  ------------------------------------------------------------------------
  参数名         类型           描述                            是否必须
  -------------- -------------- ------------------------------- ----------
  respCode       Number         见IF5/IF8响应码表，如：2002     Y

  respCont       String         0-100表示文件操作当前进度       Y
  ------------------------------------------------------------------------

> 示例：

{\"deviceId\":\"myDeviceId\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_File\",\"timestamp\":1626948825804,\"data\":{\"respCode\":2002,\"respCont\":\"80\"}}

具体为：

正常升级：{2002,1};{2002,100},{2000,1},{2000,100}按次序上报4个事件

升级异常：{2003,0};

{2002,1};{2003,1}

{2002,1};{2002,100};{2003,2}

## 下载速度 {#下载速度 .QB标题6}

表7.4-21下载速度参数表

  ----------------- ------------ ------------------------------ ----------
  参数名            类型         描述                           必须

  avgDownloadRate   String       平均下载速率，单位KB/S         Y
  ----------------- ------------ ------------------------------ ----------

示例：

{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_DownFileSpeed\",\"timestamp\":1626948825804,\"data\":{\"avgDownloadRate\":\"258\"}}

## Ping测试 {#ping测试-1 .QB标题6}

表7.4-22 Ping测试参数表

  -------------- ------------ -------------------------------- -----------
  参数名         类型         描述                             必须

  sendTimes      Number       发送次数                         Y

  receiveTimes   Number       接收次数                         Y

  lostTimes      Number       丢失次数                         Y

  minDelay       Number       最低延时，单位：毫秒             Y

  maxDelay       Number       最高延时，单位：毫秒             Y

  avgDelay       Number       平均延时，单位：毫秒             Y
  -------------- ------------ -------------------------------- -----------

示例：

{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_DelayTime\",\"timestamp\":1626948825804,\"data\":{\"sendTimes\":4,\"receiveTimes\":4,\"lostTimes\":0,\"minDelay\":30,\"maxDelay\":34,\"avgDelay\":32}}

## 端口参数信息 {#端口参数信息 .QB标题6}

表7.4-23 端口参数信息表

  ---------------- ------------- -------------------------------------- ------
  参数名           类型          描述                                   必须

  portInfoList     Array         端口号信息的数组                       Y

  portType         Number        端口类型：0：WAN，1：LAN               Y

  portRate         String        端口速率(百兆、千兆)，协商速率         Y

  portMac          String        端口mac                                Y

  portConnection   Number        端口连接情况：0：已连接，1：未连接     Y
  ---------------- ------------- -------------------------------------- ------

示例：

{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_InternetAccessInfo\",\"timestamp\":1626948825804,\"data\":{\"portInfoList\":\[{\"portType\":0,\"portRate\":\"XXXX\",\"portMac\":\"XXXX\",\"portConnection\":0},{\"portType\":1,\"portRate\":\"XXXX\",\"portMac\":\"XXXX\",\"portConnection\":0},{\"portType\":1,\"portRate
\":\"XXXX\",\"portMac \":\"XXXX\",\"portConnection\":1}\]}}

## 网速分配 {#网速分配 .QB标题6}

表7.4-24 网速分配上报参数表

+---------------+------+--------------------------------------+-------+
| 参数名        | 类型 | 描述                                 | 是否  |
|               |      |                                      | 必须  |
+===============+======+======================================+=======+
| Devices       | A    | 设备列表，示例：                     | Y     |
|               | rray |                                      |       |
|               |      | Devices\[{\"DeviceMac                |       |
|               |      | \":\"AABBCCDDEEFF\",\" RxRate        |       |
|               |      | \":\"10\",\" TxRate                  |       |
|               |      | \":\"10\"},......\]                  |       |
+---------------+------+--------------------------------------+-------+
| DeviceMac     | St   | 组网终端MAC地址                      | Y     |
|               | ring |                                      |       |
+---------------+------+--------------------------------------+-------+
| RxRate        | St   | 上行的接收速率(Mbps)                 | Y     |
|               | ring |                                      |       |
+---------------+------+--------------------------------------+-------+
| TxRate        | St   | 上行的发送速率(Mbps)                 | Y     |
|               | ring |                                      |       |
+---------------+------+--------------------------------------+-------+
| Limitedurl    | St   | 限                                   | N     |
|               | ring | 制访问域名列表（路由模式下需支持）； |       |
|               |      |                                      |       |
|               |      | 多组                                 |       |
|               |      | 域名之间以逗号分开，最多支持32组。示 |       |
|               |      | 例：\"www.taobao.com,www.baidu.com\" |       |
+---------------+------+--------------------------------------+-------+
| De            | Nu   | 是否周期启用设备限速：               | N     |
| viceLimitMode | mber |                                      |       |
|               |      | 0：                                  |       |
|               |      | 不启用周期控制，立即执行，需手动解除 |       |
|               |      |                                      |       |
|               |      | 1：启用周期控制，                    |       |
|               |      | 按周期执行；(在DeviceLimitTimeOffse  |       |
|               |      | t1对应时间加入速率限制，在DeviceLimi |       |
|               |      | tTimeOffset2对应时间解除速率限制。当 |       |
|               |      | DeviceLimitTimeOffset2小于DeviceLim  |       |
|               |      | itTimeOffset1时，DeviceLimitTimeOffs |       |
|               |      | et2代表相对于第二天0点的时间偏移量） |       |
+---------------+------+--------------------------------------+-------+
| De            | Nu   | 使用int值二进制位的低7位             | N     |
| viceLimitWeek | mber | 代表星期，由高到低位依次代表星期六五 |       |
|               |      | 四三二一日。如7(00000111B)表示周二， |       |
|               |      | 周一和周日。若仅需单次执行，值为0。  |       |
+---------------+------+--------------------------------------+-------+
| DeviceLim     | Nu   | 执行时间偏移量1（执                  | N     |
| itTimeOffset1 | mber | 行任务的时间点与当天凌晨0点的时间差  |       |
|               |      | ，以秒为单位），该时刻启动速率限制； |       |
+---------------+------+--------------------------------------+-------+
| DeviceLim     | Nu   | 行时间偏移量2（执                    | N     |
| itTimeOffset2 | mber | 行任务的时间点与当天凌晨0点的时间差  |       |
|               |      | ，以秒为单位），该时刻停止速率限制； |       |
+---------------+------+--------------------------------------+-------+

示例：

{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_DeviceLimit\",\"timestamp\":1626948825804,\"data\":{\"Devices\":\[{\"DeviceMac\":\"AABBCCDDEEFF\",\"RxRate\":\"10\",\"TxRate\":\"10\",\"DeviceLimitMode\":\"1\",\"DeviceLimitWeek\":127,\"DeviceLimitTimeOffset1\":100,\"DeviceLimitTimeOffset2\":10000},{\"DeviceMac\":\"00BBCCDDEEFF\",\"RxRate\":\"10\",\"TxRate\":\"10\",\"DeviceLimitMode\":1,\"DeviceLimitWeek\":127,\"DeviceLimitTimeOffset1\":11000,\"DeviceLimitTimeOffset2\":20000}\]}}

注：对于eventType字段内容，当收到查询指令时，响应内容为\"XData_AllDeviceLimit\"；当收到控制指令时，响应内容为:\"XData_DeviceLimit\"；

## 定时任务 {#定时任务 .QB标题6}

表7.4-25定时任务参数表

+--------+-------+-------------------------------------------+--------+
| 参数名 | 类型  | 描述                                      | 是     |
|        |       |                                           | 否必须 |
+--------+-------+-------------------------------------------+--------+
| Tasks  | Array | \[{以下字段组成的json},...\]              | Y      |
+--------+-------+-------------------------------------------+--------+
| TaskId | S     | 任务Id                                    | Y      |
|        | tring |                                           |        |
+--------+-------+-------------------------------------------+--------+
| Time   | Long  | 执行时间偏移量（执行任务的                | Y      |
| Offset |       | 时间点与当天凌晨0点的时间差，以秒为单位） |        |
+--------+-------+-------------------------------------------+--------+
| Week   | N     | 使用int值                                 | Y      |
|        | umber | 二进制位的低7位代表星期，由高到低位依次代 |        |
|        |       | 表星期六五四三二一日。如7(00000111B)表示  |        |
|        |       | 周二，周一和周日。若仅需单次执行，值为0。 |        |
+--------+-------+-------------------------------------------+--------+
| Enable | N     | 任务是否启用0：不启用， 1：启用           | Y      |
|        | umber |                                           |        |
+--------+-------+-------------------------------------------+--------+
| Action | S     | 任务指令，可能取值如下：                  | Y      |
|        | tring |                                           |        |
|        |       | ToReboot（重启）                          |        |
|        |       |                                           |        |
|        |       | ToSetHealthMode（健                       |        |
|        |       | 康模式，定时开、关Wi-Fi，（健康模式，定时 |        |
|        |       | 开、关Wi-Fi，在TimeOffset对应的时间关闭指 |        |
|        |       | 定index的Wi-Fi，在TimeOffset2对应的时间开 |        |
|        |       | 启它。当TimeOffset2小于TimeOffset时，Tim  |        |
|        |       | eOffset2代表相对于第二天0点的时间偏移量） |        |
+--------+-------+-------------------------------------------+--------+
| TimeO  | Long  | 仅当                                      | Y      |
| ffset2 |       | Action为ToSetHealthMode时，才携带该字段,  |        |
|        |       | 执行时间偏移量（执行任务的                |        |
|        |       | 时间点与当天凌晨0点的时间差，以秒为单位） |        |
+--------+-------+-------------------------------------------+--------+
| Index  | N     | 仅当Action为T                             | Y      |
|        | umber | oSetHealthMode时，才携带该字段，Wi-Fi通道 |        |
|        |       | 。2.4G用1-4，5G用5-8，0表示所有Wi-Fi通道  |        |
+--------+-------+-------------------------------------------+--------+

示例：

{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_TimerTask\",\"timestamp\":1626948825804,\"data\":{\"Tasks\":\[{\"TaskId\":\"\*\*\*\*\*\",\"TimeOffset\":3600,\"Week\":7,\"Enable\":1,\"Action\":\"ToSetHealthMode\",\"TimeOffset2\":4000,\"Index\":0}\]}}

注：对于eventType字段内容，当收到查询指令时，响应内容为\"XData_AllTimerTask
\"；当收到控制指令时，响应内容为:\"XData_TimerTask \"；

## Wi-Fi开关控制 {#wi-fi开关控制-1 .QB标题6}

表7.4-26 Wi-Fi控制参数表

+---------+-------------+------------------------------------+--------+
| 参数名  | 类型        | 描述                               | 是     |
|         |             |                                    | 否必须 |
+=========+=============+====================================+========+
| Radio   | String      | \                                  | Y      |
|         |             | "2.4G\"、\"5G\"、\"5G-2\"、\"all\" |        |
|         |             |                                    |        |
|         |             | 注：对                             |        |
|         |             | 于三频设备，5G表示5.1G频段，5G-2表 |        |
|         |             | 示5.8G频段；双频设备忽略5G-2频段； |        |
+---------+-------------+------------------------------------+--------+
| Enable  | Number      | 0或1（0：关闭Wi-Fi，1：打开Wi-Fi） | Y      |
+---------+-------------+------------------------------------+--------+
| Index   | Number      | 可选字段：使用该字段表             | Y      |
|         |             | 示对指定index进行控制；不使用该字  |        |
|         |             | 段表示对指定Radio的全局控制。2.4G  |        |
|         |             | 采用1-4，5G采用5-8，5G-2采用9-12； |        |
+---------+-------------+------------------------------------+--------+

示例：

{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_WiFiSwitch\",\"timestamp\":1626948825804,\"data\":{\"Radio\":\"2.4G\",\"Enable\":1,\"Index\":1}}

## Wi-Fi射频参数配置 {#wi-fi射频参数配置-1 .QB标题6}

表7.4-27 Wi-Fi射频参数配置参数表

+--------------+--------+------------------------------------+--------+
| 参数名       | 类型   | 描述                               | 是     |
|              |        |                                    | 否必须 |
+==============+========+====================================+========+
| Radio        | String | \                                  | Y      |
|              |        | "2.4G\"、\"5G\"、\"5G-2\"、\"all\" |        |
|              |        |                                    |        |
|              |        | 注：对                             |        |
|              |        | 于三频设备，5G表示5.8G频段，5G-2表 |        |
|              |        | 示5.2G频段；双频设备忽略5G-2频段； |        |
+--------------+--------+------------------------------------+--------+
| T            | String | 0-100 （Wi-Fi发射功率百分比）      | Y      |
| ransmitPower |        |                                    |        |
+--------------+--------+------------------------------------+--------+
| Channel      | String | 工作信道，0代表自动信道；          | N      |
+--------------+--------+------------------------------------+--------+
| Bandwidth    | Number | 当前Wi-Fi频宽，采用枚举取值：      | N      |
|              |        |                                    |        |
|              |        | 0：自动频宽                        |        |
|              |        |                                    |        |
|              |        | 1：20MHz                           |        |
|              |        |                                    |        |
|              |        | 2：40MHz                           |        |
|              |        |                                    |        |
|              |        | 3：80MHz                           |        |
|              |        |                                    |        |
|              |        | 4：160MHz                          |        |
|              |        |                                    |        |
|              |        | 5：80+80MHz                        |        |
|              |        |                                    |        |
|              |        | 说明：对于                         |        |
|              |        | 2.4G频段，自动频宽功能为20/40MHz频 |        |
|              |        | 宽自适应；对于5G频段，自动频宽功能 |        |
|              |        | 对应为20/40/80/160MHz频宽自适应；  |        |
+--------------+--------+------------------------------------+--------+

示例：

{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_RadioConfig\",\"timestamp\":1626948825804,\"data\":{\"Radio\":\"2.4G\",\"TransmitPower\":\"100\"，\"Channel\":\"1\",\"Bandwidth\":1}}

## Wi-Fi WPS控制 {#wi-fi-wps控制-1 .QB标题6}

表7.4-28 Wi-Fi WPS控制参数表

+--------------+--------+------------------------------------+--------+
| 参数名       | 类型   | 描述                               | 是     |
|              |        |                                    | 否必须 |
+==============+========+====================================+========+
| Radio        | String | \                                  | Y      |
|              |        | "2.4G\"、\"5G\"、\"5G-2\"、\"all\" |        |
|              |        |                                    |        |
|              |        | 注：对                             |        |
|              |        | 于三频设备，5G表示5.1G频段，5G-2表 |        |
|              |        | 示5.8G频段；双频设备忽略5G-2频段； |        |
+--------------+--------+------------------------------------+--------+

示例：

{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_WPS\",\"timestamp\":1626948825804,\"data\":{\"Radio\":\"all\"}}

## Wi-Fi 参数控制 {#wi-fi-参数控制 .QB标题6}

## 表7.4-31 Wi-Fi参数控制参数表 {#表7.4-31-wi-fi参数控制参数表 .QB标题6 .unnumbered}

+--------------+------+------------------------------------+----------+
| 参数名       | 类型 | 描述                               | 是否必须 |
+--------------+------+------------------------------------+----------+
| Radio        | St   | 待设置的频段，枚举取值：           | Y        |
|              | ring |                                    |          |
|              |      | \"2.4G\"、\"5G\"、\"5G-2\"；       |          |
|              |      |                                    |          |
|              |      | 说明：对                           |          |
|              |      | 于三频设备，5G表示5.1G频段，5G-2表 |          |
|              |      | 示5.8G频段；双频设备忽略5G-2频段； |          |
+--------------+------+------------------------------------+----------+
| Index        | Nu   | SSID的索引，2.                     | Y        |
|              | mber | 4G采用1-4，5G采用5-8，5G-2采用9-12 |          |
+--------------+------+------------------------------------+----------+
| Enable       | Nu   | 是否启用，1为启用，0禁用           | Y        |
|              | mber |                                    |          |
+--------------+------+------------------------------------+----------+
| SSID         | St   | SSID名称                           | Y        |
|              | ring |                                    |          |
+--------------+------+------------------------------------+----------+
| SecurityMode | St   | 加密模式取值：                     | Y        |
|              | ring |                                    |          |
|              |      | None                               |          |
|              |      |                                    |          |
|              |      | WEP-64                             |          |
|              |      |                                    |          |
|              |      | WEP-128                            |          |
|              |      |                                    |          |
|              |      | WPA-Personal                       |          |
|              |      |                                    |          |
|              |      | WPA2-Personal                      |          |
|              |      |                                    |          |
|              |      | MIXED-WPAPSK2                      |          |
|              |      |                                    |          |
|              |      | WPA3-SAE                           |          |
|              |      |                                    |          |
|              |      | MIXED-WPA2WPA3                     |          |
+--------------+------+------------------------------------+----------+
| Encrypt      | Nu   | 加密算法，枚举取值：               | N        |
|              | mber |                                    |          |
|              |      | 0：None:                           |          |
|              |      |                                    |          |
|              |      | 1：AES                             |          |
|              |      |                                    |          |
|              |      | 2：TKIP                            |          |
|              |      |                                    |          |
|              |      | 3：AES+TKIP                        |          |
+--------------+------+------------------------------------+----------+
| Pwd          | St   | Wi-Fi密码                          | Y        |
|              | ring |                                    |          |
+--------------+------+------------------------------------+----------+
| Max          | Nu   | 该SSID最大允许接入的用户数         | Y        |
| AssociateNum | mber |                                    |          |
+--------------+------+------------------------------------+----------+
| SSIDAdvertis | Nu   | 是否广播SSID，1为广播，0为不广播   | Y        |
| ementEnabled | mber |                                    |          |
+--------------+------+------------------------------------+----------+
| SSIDStandard | St   | W                                  | N        |
|              | ring | LAN口支持的无线传输标准，枚举取值: |          |
|              |      |                                    |          |
|              |      | 11b/g                              |          |
|              |      |                                    |          |
|              |      | 11b/g/n                            |          |
|              |      |                                    |          |
|              |      | 11b/g/n/ax                         |          |
|              |      |                                    |          |
|              |      | 11a/n/ac/ax                        |          |
|              |      |                                    |          |
|              |      | 11a/n/ac                           |          |
|              |      |                                    |          |
|              |      | 11a/n                              |          |
|              |      |                                    |          |
|              |      | 11n                                |          |
|              |      |                                    |          |
|              |      | 11a                                |          |
|              |      |                                    |          |
|              |      | 11b                                |          |
|              |      |                                    |          |
|              |      | 11g                                |          |
+--------------+------+------------------------------------+----------+

示例：

{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_WiFiParameterSync\",\"timestamp\":1641523029678,\"data\":{\"Configurations\":\[{\"Radio\":\"2.4G\",\"Index\":1,\"Enable\":1,\"SSID\":\"CMCC-2341\",\"SecurityMode\":\"MIXED-WPAPSK2\",\"Encrypt\":3,\"Pwd\":\"\*\*\*\*\*\*\*\",\"MaxAssociateNum\":10,\"SSIDAdvertisementEnabled\":1,\"SSIDStandard\":\"11b/g/n\"},{\"Radio\":\"5G\",\"Index\":1,\"Enable\":1,\"SSID\":\"CMCC-2341-5G\",\"SecurityMode\":\"MIXED-WPAPSK2\",\"Encrypt\":3,\"Pwd\":\"\*\*\*\*\*\*\*\",\"MaxAssociateNum\":10,\"SSIDAdvertisementEnabled\":1,\"SSIDStandard\":\"11a/n/ac/ax\"}\]}}

## 设置黑白名单 {#设置黑白名单-1 .QB标题6}

表7.4-29设黑白名单参数表

+--------------+------+---------------------------------------+--------+
| 参数名       | 类型 | 描述                                  | 是     |
|              |      |                                       | 否必须 |
+==============+======+=======================================+========+
| \"MacFi      | Nu   | 0、1（是否使能MAC地址过滤，0否1是）   | Y      |
| lterEnable\" | mber |                                       |        |
+--------------+------+---------------------------------------+--------+
| \"MacFi      | Nu   | 0、                                   | Y      |
| lterPolicy\" | mber | 1（MAC地址过滤策略，0黑名单1白名单）  |        |
+--------------+------+---------------------------------------+--------+
| \"MacFil     | St   | 名单                                  | Y      |
| terEntries\" | ring | 列表："mac地址/设备名"格式；两组信息  |        |
|              |      | 之间以逗号分开，最多支持32组。示例：  |        |
|              |      |                                       |        |
|              |      | \"AABBC                               |        |
|              |      | CDDEEFF/iphone,FFEEDDCCBBAA/samsung\" |        |
+--------------+------+---------------------------------------+--------+

示例：

> {\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_MacFilter\",\"timestamp\":1626948825804,\"data\":{\"MacFilterEnable\":1,\"MacFilterPolicy\":0,\"MacFilterEntries\":\"AABBCCDDEEFF/iphone,FFEEDDCCBBAA/samsung\"}}

## 指示灯控制 {#指示灯控制 .QB标题6}

表7.4-30指示灯控制参数表

  ------------------------------------------------------------------------
  参数名         类型         描述                              是否必须
  -------------- ------------ --------------------------------- ----------
  \"LEDOnOff\"   Number       0或1（0: 关闭，1: 打开）          Y

  ------------------------------------------------------------------------

示例：

{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_LEDControl\",\"timestamp\":1626948825804,\"data\":{\"LEDOnOff\":1}}

## STA漫游控制 {#sta漫游控制 .QB标题6}

说明：当设备收到开启双频合一指令时，终端应主动将SSID-5的名称（SSID）和密码（key）调整为SSID-1的名称和密码；当设备收到关闭双频合一指令时（已开启双频合一），终端应主动将SSID-5的名称（SSID）在现有名称条件下增加"-5G"，SSID-5的密码保持不变；（例如：双频合一开启时，SSID-1和SSID-5的名称为CMCC-XXXX，关闭双频合一后，调整SSID-5的名称为CMCC-XXXX-5G，密码保持不变）；

表7.4-31 STA漫游控制参数表

+-------------+-------+---------------------------------------+-------+
| 参数名      | 类型  | 描述                                  | 是否  |
|             |       |                                       | 必须  |
+=============+=======+=======================================+=======+
| Ro          | N     | 0或1（0: 关闭，1: 打开）              | Y     |
| amingSwitch | umber |                                       |       |
+-------------+-------+---------------------------------------+-------+
| LowRSSI2.4G | N     | 弱                                    | N     |
|             | umber | 信号阈值（2.4G），单位dBm，如：-90。  |       |
|             |       |                                       |       |
|             |       | 当                                    |       |
|             |       | STA接入当前组网终端的RSSI小于该阈值时 |       |
|             |       | ，组网终端需对该STA执行漫游切换控制。 |       |
+-------------+-------+---------------------------------------+-------+
| LowRSSI5G   | N     | 弱信号阈值（5G），单位dBm，如：-90。  | N     |
|             | umber |                                       |       |
|             |       | 当                                    |       |
|             |       | STA接入当前组网终端的RSSI小于该阈值时 |       |
|             |       | ，组网终端需对该STA执行漫游切换控制。 |       |
+-------------+-------+---------------------------------------+-------+
| BandSte     | N     | 双频合一开关状态：                    | Y     |
| eringEnable | umber |                                       |       |
|             |       | 0: 关闭                               |       |
|             |       |                                       |       |
|             |       | 1: 打开                               |       |
+-------------+-------+---------------------------------------+-------+

示例：

{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_RoamingConfig\",\"timestamp\":1626948825804,\"data\":{\"BandSteeringEnable\":1,\"RoamingSwitch\":0,\"LowRSSI2.4G\":-80,\"LowRSSI5G\":-80}}

## 开启快连 {#开启快连 .QB标题6}

{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"
XData_OpenQlink \",\"timestamp\":1626948825804,\"data\":{}}

## 引导热点下发配网信息 {#引导热点下发配网信息 .QB标题6}

表7.4-32引导热点下发配网信息参数表

  --------------- ------- ----------------------------------------------- ----------
  参数名          类型    描述                                            是否必须

  iotDeviceMacs   Array   智能设备mac列表iotDeviceMacs，取值\[\"mac1\",   Y
                          \"mac2\"\]                                      
  --------------- ------- ----------------------------------------------- ----------

示例：

{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_NetInfo\",\"timestamp\":1626948825804,\"data\":{\"iotDeviceMacs\":\[\"mac1\",\"mac2\"\]}}

## Wi-Fi配置自动同步开关 {#wi-fi配置自动同步开关 .QB标题6}

表7.4-33 Wi-Fi配置自动同步开关参数表

+--------------+------+---------------------------------+-------------+
| 参数名       | 类型 | 描述                            | 是否必须    |
+--------------+------+---------------------------------+-------------+
| syncEnable   | Nu   | 是否开启自动同步，枚举取值；    | Y           |
|              | mber |                                 |             |
|              |      | 0：不启用，                     |             |
|              |      | 1：启用；默认取值为1            |             |
+--------------+------+---------------------------------+-------------+

示例：

{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_OpenWiFiSync\",\"timestamp\":1626948825804,\"data\":{\"syncEnable\":1}}

## 更新用户信息 {#更新用户信息 .QB标题6}

{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_UpdateUserkey\",\"timestamp\":1626948825804,\"data\":{}}

## 周期上报配置 {#周期上报配置 .QB标题6}

表7.4-34 周期上报配置参数表

+--------------+------+-----------------------------------+-----------+
| 参数名       | 类型 | 描述                              | 是否必须  |
+--------------+------+-----------------------------------+-----------+
| StatusRe     | St   | Wi-Fi状态/上联状态/周             | N         |
| portInterval | ring | 边Wi-Fi状态上报周期，单位s(秒)；  |           |
+--------------+------+-----------------------------------+-----------+
| Re           | St   | 下挂设备上报周期，单位s(秒)；     | Y         |
| portInterval | ring |                                   |           |
+--------------+------+-----------------------------------+-----------+
| Sa           | St   | 数据采样间隔，单位s(秒)；         | Y         |
| mpleInterval | ring |                                   |           |
+--------------+------+-----------------------------------+-----------+
| Uplink       | Nu   | 设备上行连接状态开关；            | Y         |
| StatusEnable | mber |                                   |           |
|              |      | 0：不启用， 1：启用；默认取值为1  |           |
+--------------+------+-----------------------------------+-----------+
| S            | Nu   | 设备下挂设备信息开关；            | Y         |
| TAInfoEnable | mber |                                   |           |
|              |      | 0：不启用， 1：启用；默认取值为1  |           |
+--------------+------+-----------------------------------+-----------+
| WlanNe       | Nu   | 设备周边Wi-                       | N         |
| ighborEnable | mber | Fi信息，取值为1（True），0(False) |           |
+--------------+------+-----------------------------------+-----------+
| ApCnf        | Nu   | 设备Wi-Fi状态信息；               | Y         |
| igInfoEnable | mber |                                   |           |
|              |      | 0：不启用， 1：启用；默认取值为1  |           |
+--------------+------+-----------------------------------+-----------+
| [STAChangeEn | [Nu  | [下挂设备状态                     | N         |
| able]{.mark} | mber | 变更上报开关，默认关闭；]{.mark}  |           |
|              | ]{.m |                                   |           |
|              | ark} | [枚举取值；取                     |           |
|              |      | 值为1（开启），0(关闭)；]{.mark}  |           |
+--------------+------+-----------------------------------+-----------+
| [STAChangeRp | [St  | [下挂                             | N         |
| tUrl]{.mark} | ring | 设备状态变更上报Url地址；]{.mark} |           |
|              | ]{.m |                                   |           |
|              | ark} |                                   |           |
+--------------+------+-----------------------------------+-----------+

示例：

{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_ApReportConfig\",\"timestamp\":1626948825804,\"data\":{\"StatusReportInterval\":\"14400\",\"ReportInterval\":\"1800\",\"SampleInterval\":\"60\",\"UplinkStatusEnable\":1,\"STAInfoEnable\":1,\"[WlanNeighborEnable]{.mark}\":1,\"ApCnfigInfoEnable\":1,\"[STAChangeEnable]{.mark}\":0,\"[STAChangeRptUrl]{.mark}\":\"\*\*\*\*\*\*\*\"}}

## 网络拓扑 {#网络拓扑 .QB标题6}

表7.4-35 网络拓扑上报参数表

+----------+------+-------------------------------------------+-------+
| 参数名   | 类型 | 描述                                      | 是否  |
|          |      |                                           | 必须  |
+----------+------+-------------------------------------------+-------+
| Devices  | A    | 家庭拓扑网络信息                          | Y     |
|          | rray |                                           |       |
+----------+------+-------------------------------------------+-------+
| meshRole | Nu   | Mesh角色（枚举）：                        | Y     |
|          | mber |                                           |       |
|          |      | 0：非mesh终端；                           |       |
|          |      |                                           |       |
|          |      | 1：controller；                           |       |
|          |      |                                           |       |
|          |      | 2：agent；                                |       |
|          |      |                                           |       |
|          |      | 3：AC；                                   |       |
|          |      |                                           |       |
|          |      | 4：AP                                     |       |
|          |      |                                           |       |
|          |      | 说明：AP专指面板式AP；                    |       |
+----------+------+-------------------------------------------+-------+
| Ma       | St   | 拓扑终                                    | Y     |
| cAddress | ring | 端自身MAC地址，应同终端铭牌MAC保持一致；  |       |
+----------+------+-------------------------------------------+-------+
| UpTime   | St   | 在线时长，单位：秒                        | Y     |
|          | ring |                                           |       |
+----------+------+-------------------------------------------+-------+
| I        | St   | 拓扑终端IPv4地址；                        | N     |
| PAddress | ring |                                           |       |
+----------+------+-------------------------------------------+-------+
| IPv6I    | St   | 拓扑终端IPv6地址；                        | N     |
| PAddress | ring |                                           |       |
+----------+------+-------------------------------------------+-------+
| S        | Nu   | 下挂设备数量                              | Y     |
| TANumber | mber |                                           |       |
+----------+------+-------------------------------------------+-------+
| Back     | Ob   | MAP设备的上联backhaul信息，包含Uplink     | Y     |
| haulinfo | ject | Type、Radio、MapAlmac、RxRate、TxRate字段 |       |
+----------+------+-------------------------------------------+-------+
| Up       | St   | 拓扑终端上行接入                          | Y     |
| linkType | ring | 方式：WLAN、Ethernet、PLC、Cable、Optical |       |
|          |      | Ethernet、GPON、XGPON、PoE                |       |
+----------+------+-------------------------------------------+-------+
| Radio    | St   | 拓扑终端W                                 | N     |
|          | ring | LAN上联时使用的频段，取值2.4G、5G或5G-2； |       |
|          |      |                                           |       |
|          |      | 注：对于三频设备，5G表示5.1G频段，        |       |
|          |      | 5G-2表示5.8G频段；双频设备忽略5G-2频段；  |       |
+----------+------+-------------------------------------------+-------+
| MapAlmac | St   | 拓扑终端上联使用的管理Almac地址，如果     | Y     |
|          | ring | meshRole取值为controller或                |       |
|          |      | AC时，则该字段表示上联设备的链路MAC地址;  |       |
|          |      |                                           |       |
|          |      | 说明：拓扑终端Ma                          |       |
|          |      | pAlmac应同拓扑上联终端的铭牌MAC保持一致； |       |
+----------+------+-------------------------------------------+-------+
| RxRate   | St   | 拓扑终端上行协商接收速率(Mbps)            | Y     |
|          | ring |                                           |       |
+----------+------+-------------------------------------------+-------+
| TxRate   | St   | 拓扑终端上行协商发送速率(Mbps)            | Y     |
|          | ring |                                           |       |
+----------+------+-------------------------------------------+-------+

示例：

{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_MAPTopology\",\"timestamp\":1626948825804,\"data\":{\"Devices\":\[{\"MacAddress\":\"11223344AABB\",\"meshRole\":1,\"UpTime\":\"500\",\"IPAddress\":\"192.168.10.1\",\"IPv6IPAddress\":\"2001:DA8:1000::F1\",\"STANumber\":2,\"Backhaulinfo\":{\"UplinkType\":\"Ethernet\",\"MapAlmac\":\"AABBCCDD0123\",\"RxRate\":\"1000\",\"TxRate\":\"1000\"}},{\"MacAddress\":\"11223344AACC\",\"meshRole\":2,\"UpTime\":\"400\",\"IPAddress\":\"192.168.10.2\",\"IPv6IPAddress\":\"2001:DA8:1000::F5\",\"STANumber\":3,\"Backhaulinfo\":{\"UplinkType\":\"Ethernet\",\"MapAlmac\":\"11223344AABB\",\"RxRate\":\"1000\",\"TxRate\":\"1000\"}},{\"MacAddress\":\"11223344AADD\",\"meshRole\":2,\"UpTime\":\"300\",\"IPAddress\":\"192.168.10.3\",\"IPv6IPAddress\":\"2001:DA8:1000::FA\",\"STANumber\":4,\"Backhaulinfo\":{\"UplinkType\":\"WLAN\",\"MapAlmac\":\"11223344AACC\",\"RxRate\":\"2401\",\"TxRate\":\"2401\"}}\]}}

## 工作模式设置 {#工作模式设置 .QB标题6}

表7.4-36 工作模式设置上报参数表

+----------+------+-------------------------------------------+-------+
| 参数名   | 类型 | 描述                                      | 是否  |
|          |      |                                           | 必须  |
+----------+------+-------------------------------------------+-------+
| Wor      | Nu   | AP工作模式：                              | Y     |
| kingMode | mber |                                           |       |
|          |      | 1：路由                                   |       |
|          |      |                                           |       |
|          |      | 0：桥接                                   |       |
+----------+------+-------------------------------------------+-------+

示例：

{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_WorkModelConfig\",\"timestamp\":1626948825804,\"data\":{\"WorkingMode\",0}}

## 省码配置数据 {#省码配置数据 .QB标题6}

表7.4-37 省份编码下发接口响应

  --------------- --------- ------------------------------------ ----------
  参数名          类型      描述                                 是否必须

  provinceCode    String    组网终端省份信息                     Y
  --------------- --------- ------------------------------------ ----------

成功示例：

{\"deviceId\":\"CMCC-30103-AABBCCDDEEFF\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_ProvinceCode\",\"timestamp\":1641523029678,\"data\":{\"provinceCode\":\"ZHJ\"}}

## 扫码绑定数据 {#扫码绑定数据 .QB标题6}

表7.4-38 扫码绑定接口响应

  ------------------------------------------------------------------------------------------------------
  参数名         类型       描述                                                            是否必须
  -------------- ---------- --------------------------------------------------------------- ------------
  deviceMac      String     组网终端铭牌MAC地址，推荐使用WAN口MAC，格式为不带冒号并且大写   Y

  cmei           String     组网终端唯一标识                                                Y

  deviceSn       String     组网终端SN                                                      Y

  deviceVendor   String     厂商编码                                                        Y

  deviceModel    String     产品型号编码                                                    Y

  CGW            object     APP配网信息                                                     Y

  user_key       String     用户信息                                                        Y

  gwAddress      String     预留地址，组网终端无关                                          Y

  gwAddress2     String     组网终端连接地址，格式为https://\*\*\*\*\*                      Y
  ------------------------------------------------------------------------------------------------------

成功示例：

{\"deviceId\":\"\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_ApBind\",\"timestamp\":1626948825804,\"data\":{\"deviceMac\":\"00112233445566\",\"cmei\":\"\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\",\"deviceSn\":\"011101\*\*\*\*\*\*\*\*\*\",\"deviceVendor\":\"01\",\"deviceModel\":\"1101\",\"CGW\":{\"user_key\":\"\*\*\*\*\*\*\*\",\"gwAddress\":\"\*\*\*\*\*\*\*\",\"gwAddress2\":\"\*\*\*\*\*\*\*\"}}}}

平台下发参数错误或设备已绑定时，调用7.4.2.7出错上报接口，上报错误内容；

失败示例：

{\"eventType\":\"Response_ApBind\",\"deviceId\":\"\*\*\*\*\*\",\"timestamp\":\"\*\*\*\*\*\",\"respCode\":4002,\"respCont\":\"Device
bound\"}

## 5GHz频段优先配置 {#ghz频段优先配置-1 .QB标题6}

表2-2 5GHz频段优先配置接口响应

  ------------------------------------------------------------------------------------------------------------------------------------------
  参数名           类型       描述                                                                                               是否必须
  ---------------- ---------- -------------------------------------------------------------------------------------------------- -----------
  5GPreferredSta   String     名单列表："mac地址/设备名"格式；多信息之间以逗号分开，最多支持32组。示例：\"AABBCCDDEE00/iphone,   Y
                              112233445566/Mi\"                                                                                  

  LimitedTime      Number     限制连接2.4GHz频段的时间，单位毫秒，缺省值为3000；                                                 Y
  ------------------------------------------------------------------------------------------------------------------------------------------

成功示例：

{\"deviceId\":\"CMCC-30103-AABBCCDDEEFF\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_5GPreferred\",\"timestamp\":1641523029678,\"data\":{\"5GPreferredSta\":\"AABBCCDDEE00/iphone,112233445566/Mi\",\"LimitedTime\":3000}}

## QoS优先级配置 {#qos优先级配置-1 .QB标题6}

表2-4 QoS优先级配置接口响应

  -----------------------------------------------------------------------------------------------------------
  参数名            类型       描述                                                               是否必须
  ----------------- ---------- ------------------------------------------------------------------ -----------
  QosEnable         Number     QoS开关；1：打开，0：关闭                                          Y

  QosParameter      Array      QoS分类规则，最大下发8个实例；                                     N

  QosPriority       Number     QoS优先级；取值范围：0-7；数值越大优先级越高；                     N

  DscpEnable        Number     DSCP优先级开关；1：打开，0：关闭                                   N

  DscpPriority      Number     DSCP优先级；取值范围：0-63；数值越大优先级越高；                   N

  Vlan8021pEnable   Number     802.1P启用开关；1：打开，0关闭                                     N

  Vlan8021p         Number     VLAN优先级；取值范围：0-7；数值越大优先级越高；                    N

  SourceIp          String     源IP                                                               N

  SourcePort        String     源端口                                                             N

  DestinationIp     String     目的地IP                                                           N

  DestinationPort   String     目的地端口                                                         N

  Protocol          String     传输协议列表，多种协议时使用逗号进行分割；取值为：TCP，UDP，ICMP   N

  SourceMac         String     源MAC（一般只路由器铭牌MAC）                                       N

  DestinationMac    String     目的MAC（下挂设备MAC）                                             N
  -----------------------------------------------------------------------------------------------------------

成功示例：

{\"deviceId\":\"CMCC-30103-AABBCCDDEEFF\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_QoS\",\"timestamp\":1641523029678,\"data\":{\"QosEnable\":1,\"QosParameter\":\[{\"QosPriority\":5,\"DscpEnable\":1,\"DscpPriority\":45,\"SourceMac\":\"AABBCCDDEEFF\",\"DestinationMac\":\"\*\*\*\*\*\*\*\*\*\*\*\*\"},{\"QosPriority\":6,\"Vlan8021pEnable\":1,\"Vlan8021p\":6,\"SourceIp\":\"224.xx.xx.xx\",\"SourcePort\":\"\*\*\*\*\",\"DestinationIp\":\"xx.xx.xx.xx\",\"DestinationPort\":\"\*\*\*\*\",\"Protocol\":\"ICMP\"}\]}}

## 扩展信息查询 {#扩展信息查询-1 .QB标题6}

表2-6 扩展信息查询接口响应

+-------------+-------+---------------------------------------+------+
| 参数名      | 类型  | 描述                                  | 是否 |
|             |       |                                       | 必须 |
+=============+=======+=======================================+======+
| VlanEnable  | N     | IPTV业务开关；1：打开，0：关闭        | Y    |
|             | umber |                                       |      |
+-------------+-------+---------------------------------------+------+
| VlanId      | N     | IPTV业务的VLAN                        | N    |
|             | umber | ID；IPTV业务开关打开时必选；          |      |
+-------------+-------+---------------------------------------+------+
| [M          | [Numb | [组播转单播开关；0: 关闭，1:          | [N   |
| ulticastEna | er]{. | 开启]{.mark}                          | ]{.m |
| ble]{.mark} | mark} |                                       | ark} |
+-------------+-------+---------------------------------------+------+
| IptvStatus  | Array | 用户侧接口                            | N    |
|             |       | 的VLAN参数；IPTV业务开关打开时必选；  |      |
+-------------+-------+---------------------------------------+------+
| Radio       | S     | 端口信息，对于WLAN接口的              | N    |
|             | tring | 频段，取值2.4G或5G或5G-2，对于以太接  |      |
|             |       | 口，取值为0；IPTV业务开关打开时必选； |      |
|             |       |                                       |      |
|             |       | 注：对于三频设备，5G表示5.1G频段，5G- |      |
|             |       | 2表示5.8G频段；双频设备忽略5G-2频段； |      |
+-------------+-------+---------------------------------------+------+
| Index       | N     | WLAN接口的SSID索引或以                | N    |
|             | umber | 太接口序号；IPTV业务开关打开时必选；  |      |
+-------------+-------+---------------------------------------+------+
| QosEnable   | N     | QoS开关；1：打开，0：关闭             | Y    |
|             | umber |                                       |      |
+-------------+-------+---------------------------------------+------+
| Q           | Array | QoS分类规则；                         | N    |
| osParameter |       |                                       |      |
+-------------+-------+---------------------------------------+------+
| QosPriority | N     | QoS优先级                             | N    |
|             | umber | ；取值范围：0-7；数值越大优先级越高； |      |
+-------------+-------+---------------------------------------+------+
| DscpEnable  | N     | DSCP优先级开关；1：打开，0：关闭      | N    |
|             | umber |                                       |      |
+-------------+-------+---------------------------------------+------+
| D           | N     | DSCP优先级；                          | N    |
| scpPriority | umber | 取值范围：0-63；数值越大优先级越高；  |      |
+-------------+-------+---------------------------------------+------+
| Vlan        | N     | 802.1P启用开关；1：打开，0关闭        | N    |
| 8021pEnable | umber |                                       |      |
+-------------+-------+---------------------------------------+------+
| Vlan8021p   | N     | VLAN优先级                            | N    |
|             | umber | ；取值范围：0-7；数值越大优先级越高； |      |
+-------------+-------+---------------------------------------+------+
| SourceIp    | S     | 源IP                                  | N    |
|             | tring |                                       |      |
+-------------+-------+---------------------------------------+------+
| SourcePort  | S     | 源端口                                | N    |
|             | tring |                                       |      |
+-------------+-------+---------------------------------------+------+
| De          | S     | 目的地IP                              | N    |
| stinationIp | tring |                                       |      |
+-------------+-------+---------------------------------------+------+
| Dest        | S     | 目的地端口                            | N    |
| inationPort | tring |                                       |      |
+-------------+-------+---------------------------------------+------+
| Protocol    | S     | 传输协议列表，多种协议时使用          | N    |
|             | tring | 逗号进行分割；取值为：TCP，UDP，ICMP  |      |
+-------------+-------+---------------------------------------+------+
| SourceMac   | S     | 源MAC（一般只路由器铭牌MAC）          | N    |
|             | tring |                                       |      |
+-------------+-------+---------------------------------------+------+
| Des         | S     | 目的MAC（下挂设备MAC）                | N    |
| tinationMac | tring |                                       |      |
+-------------+-------+---------------------------------------+------+

成功示例：

{\"deviceId\":\"CMCC-30103-AABBCCDDEEFF\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_ApConfigInfo2\",\"timestamp\":1641523029678,\"data\":{\"VlanEnable\":1,\"VlanId\":46,[\"MulticastEnable\":1]{.mark},\"IptvStatus\":\[{\"Radio\":\"5G\",\"Index\":7},{\"Radio\":\"2.4G\",\"Index\":3},{\"Radio\":\"0\",\"Index\":1},{\"Radio\":\"0\",\"Index\":3}\],\"QosEnable\":1,\"QosParameter\":\[{\"QosPriority\":5,\"DscpEnable\":1,\"DscpPriority\":45,\"SourceMac\":\"AABBCCDDEEFF\",\"DestinationMac\":\"\*\*\*\*\*\*\*\*\*\*\*\*\"},{\"QosPriority\":6,\"Vlan8021pEnable\":1,\"Vlan8021p\":6,\"SourceIp\":\"224.xx.xx.xx\",\"SourcePort\":\"\*\*\*\*\",\"DestinationIp\":\"xx.xx.xx.xx\",\"DestinationPort\":\"\*\*\*\*\",\"Protocol\":\"ICMP\"}\]}

## 配置家庭内网加速通道 {#配置家庭内网加速通道 .QB标题6}

表2-8 配置家庭内网加速通道接口响应

  ------------- -------- -------------------------------------------- ----------
  参数名        类型     描述                                         是否必须

  AccEnable     Number   加速通道开关；1：打开，0：关闭               Y

  AccNumber     Number   加速通道数量；加速通道开启时必选；           N

  AccStatus     Array    加速通道信息；加速通道开启时必选；           N

  AccId         String   加速通道ID；加速通道开启时必选；             N

  AccUrl        String   加速通道信息获取地址；加速通道开启时必选；   N
  ------------- -------- -------------------------------------------- ----------

成功示例：

{\"deviceId\":\"CMCC-30103-AABBCCDDEEFF\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_Accelerate\",\"timestamp\":1641523029678,\"data\":{\"AccEnable\":1,\"AccNumber\":2,\"AccStatus\":\[{\"AccId\":\"xxxx\",\"AccUrl\":\"xxxx\"},{\"AccId\":\"xxxx\",\"AccUrl\":\"xxxx\"}\]}}

## Speedtest下载测试 {#speedtest下载测试 .QB标题6}

表2-24 Speedtest下载测试接口响应

  ------------------------- ----------------- --------------------------------------------- ------------
  参数名                    类型              描述                                          是否必须

  HttpSpeedTestUrl          String            HttpSpeedTest下载测速url地址                  Y

  HttpSpeedTestTime         Number            HttpSpeedTest下载测试时间，单位s(秒)          Y

  HttpSpeedTestInterval     Number            HttpSpeedTest事件上报间隔时间，单位ms(毫秒)   Y

  [SpeedResultUrl]{.mark}   [String]{.mark}   [下载测速结果上报url地址]{.mark}              [N]{.mark}
  ------------------------- ----------------- --------------------------------------------- ------------

成功示例：

{\"deviceId\":\"CMCC-30103-\*\*\*\*\*\*\*\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_HttpSpeedTest\",\"timestamp\":1641523029678,\"data\":{\"HttpSpeedTestUrl
\":\"http://xxxxxxxx\",\" HttpSpeedTestTime \":20,\"
HttpSpeedTestInterval \":100,[\"SpeedResultUrl\":\"xxxxxxxx\"]{.mark}}}

## Speedtest测试控制 {#speedtest测试控制 .QB标题6}

表2-28 Speedtest测速控制

+--------------+------+------------------------------------+----------+
| 参数名       | 类型 | 描述                               | 是否必须 |
+--------------+------+------------------------------------+----------+
| Spe          | Nu   | Speedtest测速控制开关，            | Y        |
| edtestSwitch | mber |                                    |          |
|              |      | 1：停止测速；                      |          |
+--------------+------+------------------------------------+----------+

示例：{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_SpeedtestConfig\",\"timestamp\":1626948825804,\"data\":{\"SpeedtestSwitch\":1}}

## 组播转单播开关控制 {#组播转单播开关控制 .QB标题6}

表2-32 组播转单播开关控制

  ----------------- -------- ------------------------------------ -----------
  参数名            类型     描述                                 是否必须

  MulticastEnable   Number   组播转单播开关控制；0: 关闭；1: 开启 Y
  ----------------- -------- ------------------------------------ -----------

示例：{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_MulticastEnable\",\"timestamp\":1626948825804,\"data\":{\"MulticastEnable\":1}}

## 日志上报 {#日志上报 .QB标题6}

表2-32 日志上报控制

  --------------- -------- ----------------------------------------------------------------------------------------------------------------------------------------------------------- ---------- --------- --
  参数名          类型     描述                                                                                                                                                        是否必须             

  TimeOut         Number   收集日志的超时时间，单位秒。从起点日志收集开始，收集TimeOut时长日志信息，同时把生成的日志文件上传到平台；若下发TimeOut参数为"0"，则上报插件存储日志信息；              Y         

  LogUrl          String   上报日志的HTTP URL地址，举例：https://server:port/rest/logreport/1.0?access_token=keisda73nc6hn234k5kj6j78k1j34n5n4n6n7l9f&mac=22-33-44-55-66-77;                      Y         

  LogLevel        Number   日志级别，0表示DEBUG，1表示INFO, 2表示ERROR；                                                                                                                          Y         
  --------------- -------- ----------------------------------------------------------------------------------------------------------------------------------------------------------- ---------- --------- --

示例：{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XData_LogReport\",\"timestamp\":1626948825804,
\"data\":{\"TimeOut\":100,\"LogUrl\":\"https://xxxxxx\",\"LogLevel\":1}}

说明：

设备完成日志上报接口响应后，向LogUrl地址发起日志上报，日志上报要求如下：

区分插件日志和设备日志进行上报，插件日志上报文件命名规则为：MAC-timestamp-
TimeOut- LogLevel-Plugin.log，设备日志上报文件命名规则为：MAC-timestamp-
TimeOut- LogLevel-Device.log

插件日志命名示例：MAC为AABBCCDD0123组网终端于1635760833000（2021-11-01
18:00:33）发起日志上报，收集日志的超时时间（TimeOut）为100秒，日志级别（LogLevel）为0（DEBUG）时，插件(plugin)日志的名称为：AABBCCDD0123-1635760833000-100-0-Plugin.log

## 响应 {#响应-58 .QB标题5}

成功：无回复

失败：异步，7.4.2.6出错上报接口function为Response\_{eventType}

## 出错上报 {#出错上报 .QB标题4}

## 接口描述 {#接口描述-9 .QB标题5}

接口内容：由于Mqtt下行消息操作失败而产生的异步上行消息

请求topic：/device/{deviceId}/upward

请求类型：组网终端-\>家开平台

## 请求 {#请求-59 .QB标题5}

{

\"eventType\": \"Response\_{function}\",

\"deviceId\": \"\*\*\*\*\*\",

\"timestamp\": \"\*\*\*\*\*\",

\"respCode\": \*\*\*\*\*,

\"respCont\": \"1\"

}

## 响应 {#响应-59 .QB标题5}

无

注：因为接口是异步回复接口，因此无回复

## 组网终端控制 {#组网终端控制 .QB标题4}

## 接口描述 {#接口描述-10 .QB标题5}

请求topic：/device/{deviceId}/downward

请求类型：家开平台-\>组网终端

## 请求 {#请求-60 .QB标题5}

{

\"function\": \"XControl\_\*\*\*\",

\"deviceId\": \"\*\*\*\*\*\",

\"seqId\": \"\*\*\*\*\*\",

\"data\": { //具体内容见下表}

}

表7.4-39控制事件类型汇总表

  --------------------------------------- ---------------------------------
  eventType\_\*\*\*取值（组网终端控制）   功能说明

  WiFiSwitch                              Wi-Fi开关控制

  RadioConfig                             Wi-Fi射频参数

  WPS                                     Wi-Fi WPS控制

  MacFilter                               设置黑白名单

  Reboot                                  重启

  LEDControl                              指示灯开关控制

  RoamingConfig                           STA漫游控制

  DeviceLimit                             网速分配控制

  WiFiParameterSync                       控制Wi-Fi参数

  TimerTask                               定时任务

  DownFileSpeed                           下载测速

  DelayTime                               Ping测试

  OpenQlink                               开启快连

  NetInfo                                 引导热点下发配网信息

  OpenWiFiSync                            Wi-Fi配置自动同步开关

  UpdateUserkey                           更新用户信息

  ApReportConfig                          周期上报配置

  WorkModelConfig                         工作模式设置

  ProvinceCode                            省码配置接口

  ApBind                                  扫码绑定接口

  5GPreferred                             5GHz频段优先

  QoS                                     优先级调度

  Accelerate                              内网加速接口数据上报

  HttpSpeedTest                           下载测试

  MulticastConfig                         组播转换配置接口
  --------------------------------------- ---------------------------------

## Wi-Fi开关控制 {#wi-fi开关控制-2 .QB标题6}

表7.4-40 Wi-Fi开关控制参数表

+--------------+------+------------------------------------+----------+
| 参数名       | 类型 | 描述                               | 是否必须 |
+--------------+------+------------------------------------+----------+
| Radio        | St   | Wi-Fi频段，枚举取值：              | Y        |
|              | ring |                                    |          |
|              |      | \"2                                |          |
|              |      | .4G\"、\"5G\"、\"5G-2\"、\"all\"； |          |
|              |      |                                    |          |
|              |      | 说明：对                           |          |
|              |      | 于三频设备，5G表示5.1G频段，5G-2表 |          |
|              |      | 示5.8G频段；双频设备忽略5G-2频段； |          |
+--------------+------+------------------------------------+----------+
| Enable       | Nu   | 0: 关闭Wi-Fi；1: 打开Wi-Fi         | Y        |
|              | mber |                                    |          |
+--------------+------+------------------------------------+----------+
| Index        | Nu   | 使用该字段表                       | N        |
|              | mber | 示对指定index进行控制；不使用该字  |          |
|              |      | 段表示对指定Radio的全局控制。2.4G  |          |
|              |      | 采用1-4，5G采用5-8，5G-2采用9-12； |          |
+--------------+------+------------------------------------+----------+

示例：

> {\"function\":\"XControl_WiFiSwitch\",\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"Radio\":\"2.4G\",\"Enable\":1,\"Index\":1}}

## Wi-Fi射频参数配置 {#wi-fi射频参数配置-2 .QB标题6}

表7.4-41 Wi-Fi射频参数配置参数表

+--------------+------+------------------------------------+----------+
| 参数名       | 类型 | 描述                               | 是否必须 |
+--------------+------+------------------------------------+----------+
| Radio        | St   | Wi-Fi频段，枚举取值：              | Y        |
|              | ring |                                    |          |
|              |      | \"2.4G\"、\"5G\"、\"5G-2\"；       |          |
|              |      |                                    |          |
|              |      | 说明：对                           |          |
|              |      | 于三频设备，5G表示5.1G频段，5G-2表 |          |
|              |      | 示5.8G频段；双频设备忽略5G-2频段； |          |
+--------------+------+------------------------------------+----------+
| T            | St   | 0-100 （Wi-Fi发射功率百分比）；    | Y        |
| ransmitPower | ring |                                    |          |
|              |      | 说明：穿墙→100；标准→60；节能→40； |          |
+--------------+------+------------------------------------+----------+
| Channel      | St   | 工作信道，0代表自动信道；          | N        |
|              | ring |                                    |          |
+--------------+------+------------------------------------+----------+
| Bandwidth    | Nu   | 当前Wi-Fi频宽，采用枚举取值：      | N        |
|              | mber |                                    |          |
|              |      | 0：自动频宽                        |          |
|              |      |                                    |          |
|              |      | 1：20MHz                           |          |
|              |      |                                    |          |
|              |      | 2：40MHz                           |          |
|              |      |                                    |          |
|              |      | 3：80MHz                           |          |
|              |      |                                    |          |
|              |      | 4：160MHz                          |          |
|              |      |                                    |          |
|              |      | 5：80+80MHz                        |          |
|              |      |                                    |          |
|              |      | 说明：对于                         |          |
|              |      | 2.4G频段，自动频宽功能为20/40MHz频 |          |
|              |      | 宽自适应；对于5G频段，自动频宽功能 |          |
|              |      | 对应为20/40/80/160MHz频宽自适应；  |          |
+--------------+------+------------------------------------+----------+

示例：

{\"function\":\"XControl_RadioConfig\",\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"Radio\":\"2.4G\",\"TransmitPower\":\"100\",\"Channel\":\"1\",\"Bandwidth\":1}}

## Wi-Fi WPS控制 {#wi-fi-wps控制-2 .QB标题6}

表7.4-42 Wi-Fi WPS参数表

+--------------+------+------------------------------------+----------+
| 参数名       | 类型 | 描述                               | 是否必须 |
+--------------+------+------------------------------------+----------+
| Radio        | St   | \                                  | Y        |
|              | ring | "2.4G\"、\"5G\"、\"5G-2\"、\"all\" |          |
|              |      |                                    |          |
|              |      | 说明：对                           |          |
|              |      | 于三频设备，5G表示5.1G频段，5G-2表 |          |
|              |      | 示5.8G频段；双频设备忽略5G-2频段； |          |
+--------------+------+------------------------------------+----------+

示例：{\"function\":\"XControl_WPS\",\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"Radio\":\"all\"}}

## 设置黑白名单 {#设置黑白名单-2 .QB标题6}

表7.4-43 设置黑白名单参数表

  ------------------ -------- -------------------------------------------------------------------------------------------------------------------------- ----------
  参数名             类型     描述                                                                                                                       是否必须

  MacFilterEnable    Number   是否使能MAC地址过滤，0-不使能；1-使能                                                                                      Y

  MacFilterPolicy    Number   MAC地址过滤策略，0-黑名单；1-白名单                                                                                        Y

  MacFilterEntries   String   名单列表："mac地址/设备名"格式；两组信息之间以逗号分开，最多支持32组。示例：\"AABBCCDDEEFF/iphone,FFEEDDCCBBAA/samsung\"   Y
  ------------------ -------- -------------------------------------------------------------------------------------------------------------------------- ----------

示例：

> {\"function\":\"XControl_MacFilter\",\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"MacFilterEnable\":1,\"MacFilterPolicy\":0,\"MacFilterEntries\":\"AABBCCDDEEFF/iphone,FFEEDDCCBBAA/samsung\"}}

## 重启 {#重启 .QB标题6}

表7.4-44 重启参数表

+--------------+------+---------------------------------------+-------+
| 参数名       | 类型 | 描述                                  | 是否  |
|              |      |                                       | 必须  |
+--------------+------+---------------------------------------+-------+
| ControlType  | St   | \"Reboot\"：重启                      | Y     |
|              | ring |                                       |       |
|              |      | \"2.4GChanReSe                        |       |
|              |      | lect\"：重新选择2.4G频段Wi-Fi工作信道 |       |
|              |      |                                       |       |
|              |      | \"5GChanRe                            |       |
|              |      | Select\"：重新选择5G频段Wi-Fi工作信道 |       |
|              |      |                                       |       |
|              |      | \"ResetPwd\"：恢复出厂默认密码        |       |
+--------------+------+---------------------------------------+-------+

示例：{\"function\":\"XControl_Reboot\",\"deviceId\":\"\*\*\*\*\",\"seqId\":\"\*\*\*\",\"data\":{\"ControlType\":\"Reboot\"}}

## 指示灯开关控制 {#指示灯开关控制 .QB标题6}

表7.4-45 指示灯控制参数表

  -------------- -------- ------------------------------------ -----------
  参数名         类型     描述                                 是否必须

  LEDOnOff       Number   0: 关闭；1: 打开                     Y
  -------------- -------- ------------------------------------ -----------

示例：{\"function\":\"XControl_LEDControl\",\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"LEDOnOff\":1}}

## STA漫游控制 {#sta漫游控制-1 .QB标题6}

表7.46 STA漫游控制参数表

+--------------+------+------------------------------------+----------+
| 参数名       | 类型 | 描述                               | 是否必须 |
+--------------+------+------------------------------------+----------+
| BandSt       | Nu   | 双频合一开关状态，枚举取值：       | Y        |
| eeringEnable | mber |                                    |          |
|              |      | 0: 关闭                            |          |
|              |      |                                    |          |
|              |      | 1: 打开                            |          |
+--------------+------+------------------------------------+----------+
| R            | Nu   | 漫游开关，枚举取值：               | Y        |
| oamingSwitch | mber |                                    |          |
|              |      | 0: 关闭                            |          |
|              |      |                                    |          |
|              |      | 1: 打开                            |          |
+--------------+------+------------------------------------+----------+
| LowRSSI2.4G  | Nu   | 弱信                               | Y        |
|              | mber | 号阈值（2.4G），单位dBm，如：-90。 |          |
|              |      |                                    |          |
|              |      | 当STA接入                          |          |
|              |      | 当前组网终端的RSSI小于该阈值时，组 |          |
|              |      | 网终端需对该STA执行漫游切换控制。  |          |
+--------------+------+------------------------------------+----------+
| LowRSSI5G    | Nu   | 弱                                 | Y        |
|              | mber | 信号阈值（5G），单位dBm，如：-90。 |          |
|              |      |                                    |          |
|              |      | 当STA接入                          |          |
|              |      | 当前组网终端的RSSI小于该阈值时，组 |          |
|              |      | 网终端需对该STA执行漫游切换控制。  |          |
+--------------+------+------------------------------------+----------+

示例：

{\"function\":\"XControl_RoamingConfig\",\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"BandSteeringEnable\":0,\"RoamingSwitch\":1,\"LowRSSI2.4G\":-80,\"LowRSSI5G\":-80}}

## 网速分配 {#网速分配-1 .QB标题6}

表7.4-47 上行限速控制参数表

+----------------+------+----------------------------------+----------+
| 参数名         | 类型 | 描述                             | 是否必须 |
+----------------+------+----------------------------------+----------+
| Devices        | A    | 设备列表，                       | Y        |
|                | rray |                                  |          |
+----------------+------+----------------------------------+----------+
| DeviceMac      | St   | 设备MAC地址                      | Y        |
|                | ring |                                  |          |
+----------------+------+----------------------------------+----------+
| RxRate         | St   | 上                               | N        |
|                | ring | 行的接收速率(Mbps)；不限速填0；  |          |
+----------------+------+----------------------------------+----------+
| TxRate         | St   | 上                               | N        |
|                | ring | 行的发送速率(Mbps)；不限速填0；  |          |
+----------------+------+----------------------------------+----------+
| Limitedurl     | St   | 限制访问域名列表；多组域名之间   | N        |
|                | ring | 以逗号分开，最多支持32组。示例： |          |
|                |      | \"www.taobao.com,www.baidu.com\" |          |
+----------------+------+----------------------------------+----------+
| D              | Nu   | 是否周期启用设备限速：           | N        |
| eviceLimitMode | mber |                                  |          |
|                |      | 0：不启                          |          |
|                |      | 用周期控制，立即执行，需手动解除 |          |
|                |      |                                  |          |
|                |      | 1：启用周                        |          |
|                |      | 期控制，按周期执行；(在DeviceLi  |          |
|                |      | mitTimeOffset1对应时间加入速率限 |          |
|                |      | 制，在DeviceLimitTimeOffset2对应 |          |
|                |      | 时间解除速率限制。当DeviceLimitT |          |
|                |      | imeOffset2小于DeviceLimitTimeOff |          |
|                |      | set1时，DeviceLimitTimeOffset2代 |          |
|                |      | 表相对于第二天0点的时间偏移量）  |          |
+----------------+------+----------------------------------+----------+
| D              | Nu   | 使用                             | N        |
| eviceLimitWeek | mber | int值二进制位的低7位代表星期，由 |          |
|                |      | 高到低位依次代表星期六五四三二一 |          |
|                |      | 日。如7(00000111B)表示周二，周一 |          |
|                |      | 和周日。若仅需单次执行，值为0。  |          |
+----------------+------+----------------------------------+----------+
| DeviceLi       | Nu   | 执行时间偏移量1（执行任务的      | N        |
| mitTimeOffset1 | mber | 时间点与当天凌晨0点的时间差，以  |          |
|                |      | 秒为单位），该时刻启动速率限制； |          |
+----------------+------+----------------------------------+----------+
| DeviceLi       | Nu   | 行时间偏移量2（执行任务的        | N        |
| mitTimeOffset2 | mber | 时间点与当天凌晨0点的时间差，以  |          |
|                |      | 秒为单位），该时刻停止速率限制； |          |
+----------------+------+----------------------------------+----------+

示例：

{\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"eventType\":\"XControl_DeviceLimit\",\"data\":{\"Devices\":\[{\"DeviceMac\":\"AABBCCDDEEFF\",\"RxRate\":\"10\",\"TxRate\":\"10\",\"DeviceLimitMode\":\"1\",\"DeviceLimitWeek\":127,\"DeviceLimitTimeOffset1\":100,\"DeviceLimitTimeOffset2\":10000},{\"DeviceMac\":\"00BBCCDDEEFF\",\"RxRate\":\"10\",\"TxRate\":\"10\",\"DeviceLimitMode\":1,\"DeviceLimitWeek\":127,\"DeviceLimitTimeOffset1\":11000,\"DeviceLimitTimeOffset2\":20000}\]}}

## 控制Wi-Fi参数 {#控制wi-fi参数 .QB标题6}

表7.4-48 Wi-Fi参数控制参数表

+-----------------+------+---------------------------------+----------+
| 参数名          | 类型 | 描述                            | 是否必须 |
+-----------------+------+---------------------------------+----------+
| Configurations  | A    | Wi-Fi配置的数组                 | Y        |
|                 | rray |                                 |          |
+-----------------+------+---------------------------------+----------+
| Radio           | St   | 待设置的频段，枚举取值：        | Y        |
|                 | ring |                                 |          |
|                 |      | \"2.4G\"、\"5G\"、\"5G-2\"；    |          |
|                 |      |                                 |          |
|                 |      | 说明：对于三频                  |          |
|                 |      | 设备，5G表示5.1G频段，5G-2表示5 |          |
|                 |      | .8G频段；双频设备忽略5G-2频段； |          |
+-----------------+------+---------------------------------+----------+
| Index           | Nu   | SSID的索引，2.4G采              | Y        |
|                 | mber | 用1-4，5G采用5-8，5G-2采用9-12  |          |
+-----------------+------+---------------------------------+----------+
| Enable          | Nu   | 是否启用，1为启用，0禁用        | Y        |
|                 | mber |                                 |          |
+-----------------+------+---------------------------------+----------+
| SSID            | St   | SSID名称                        | Y        |
|                 | ring |                                 |          |
+-----------------+------+---------------------------------+----------+
| SecurityMode    | St   | 加密模式取值：                  | Y        |
|                 | ring |                                 |          |
|                 |      | None                            |          |
|                 |      |                                 |          |
|                 |      | WEP-64                          |          |
|                 |      |                                 |          |
|                 |      | WEP-128                         |          |
|                 |      |                                 |          |
|                 |      | WPA-Personal                    |          |
|                 |      |                                 |          |
|                 |      | WPA2-Personal                   |          |
|                 |      |                                 |          |
|                 |      | MIXED-WPAPSK2                   |          |
|                 |      |                                 |          |
|                 |      | WPA3-SAE                        |          |
|                 |      |                                 |          |
|                 |      | MIXED-WPA2WPA3                  |          |
+-----------------+------+---------------------------------+----------+
| Encrypt         | Nu   | 加密算法，枚举取值：            | N        |
|                 | mber |                                 |          |
|                 |      | 0：None:                        |          |
|                 |      |                                 |          |
|                 |      | 1：AES                          |          |
|                 |      |                                 |          |
|                 |      | 2：TKIP                         |          |
|                 |      |                                 |          |
|                 |      | 3：AES+TKIP                     |          |
+-----------------+------+---------------------------------+----------+
| Pwd             | St   | Wi-Fi密码                       | Y        |
|                 | ring |                                 |          |
+-----------------+------+---------------------------------+----------+
| MaxAssociateNum | Nu   | 该SSID最大允许接入的用户数      | Y        |
|                 | mber |                                 |          |
+-----------------+------+---------------------------------+----------+
| SSIDAdver       | Nu   | 是                              | Y        |
| tisementEnabled | mber | 否广播SSID，1为广播，0为不广播  |          |
+-----------------+------+---------------------------------+----------+
| SSIDStandard    | St   | WLAN                            | N        |
|                 | ring | 口支持的无线传输标准，枚举取值: |          |
|                 |      |                                 |          |
|                 |      | 11b/g                           |          |
|                 |      |                                 |          |
|                 |      | 11b/g/n                         |          |
|                 |      |                                 |          |
|                 |      | 11b/g/n/ax                      |          |
|                 |      |                                 |          |
|                 |      | 11a/n/ac/ax                     |          |
|                 |      |                                 |          |
|                 |      | 11a/n/ac                        |          |
|                 |      |                                 |          |
|                 |      | 11a/n                           |          |
|                 |      |                                 |          |
|                 |      | 11n                             |          |
|                 |      |                                 |          |
|                 |      | 11a                             |          |
|                 |      |                                 |          |
|                 |      | 11b                             |          |
|                 |      |                                 |          |
|                 |      | 11g                             |          |
+-----------------+------+---------------------------------+----------+

示例：

{\"function\":\"XControl_WiFiParameterSync\",\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"Configurations\":\[{\"Radio\":\"2.4G\",\"Index\":1,\"Enable\":1,\"SSID\":\"CMCC-2341\",\"SecurityMode\":\"MIXED-WPAPSK2\",\"Encrypt\":3,\"Pwd\":\"\*\*\*\*\*\*\*\",\"MaxAssociateNum\":10,\"SSIDAdvertisementEnabled\":1,\"SSIDStandard\":\"11b/g/n\"},{\"Radio\":\"5G\",\"Index\":1,\"Enable\":1,\"SSID\":\"CMCC-2341-5G\",\"SecurityMode\":\"MIXED-WPAPSK2\",\"Encrypt\":3,\"Pwd\":\"\*\*\*\*\*\*\*\",\"MaxAssociateNum\":10,\"SSIDAdvertisementEnabled\":1,\"SSIDStandard\":\"11a/n/ac/ax\"}\]}}

## Ping测试 {#ping测试-2 .QB标题6}

表7.4-49 Ping测试参数表

  -------------- -------- ------------------------------------ -----------
  参数名         类型     描述                                 是否必须

  assignDomain   String   指定域名                             Y

  pingSize       Number   发包字节大小（缺省为32）             Y

  pingCount      Number   发包数 （缺省为4）                   Y
  -------------- -------- ------------------------------------ -----------

示例：

> {\"function\":\"XControl_DelayTime\",\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"assignDomain\":\"www.baidu.com\",\"pingSize\":32,\"pingCount\":4}}

## 下载测速 {#下载测速 .QB标题6}

表7.4-50下载测速参数表

  --------------- -------- ------------------------------------ -----------
  参数名          类型     描述                                 是否必须

  assignFileUrl   String   目标文件URL                          Y
  --------------- -------- ------------------------------------ -----------

示例：

{\"function\":\"XControl_DownFileSpeed\",\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"assignFileUrl\":\"\*\*\*\*\*\"}}

## 定时任务 {#定时任务-1 .QB标题6}

表7.4-51 组网终端定时任务参数表

+-----------------+------+---------------------------------+----------+
| 参数名          | 类型 | 描述                            | 是否必须 |
+-----------------+------+---------------------------------+----------+
| Operation       | St   | 取值Add/Delete/Update           | Y        |
|                 | ring |                                 |          |
+-----------------+------+---------------------------------+----------+
| TaskId          | St   | 任务Id                          | Y        |
|                 | ring |                                 |          |
+-----------------+------+---------------------------------+----------+
| TimeOffset      | Long | 执行时                          | Y        |
|                 |      | 间偏移量（执行任务的时间点与当  |          |
|                 |      | 天凌晨0点的时间差，以秒为单位） |          |
+-----------------+------+---------------------------------+----------+
| Week            | Nu   | 使用int值                       | Y        |
|                 | mber | 二进制位的低7位代表星期，由高到 |          |
|                 |      | 低位依次代表星期六五四三二一日  |          |
|                 |      | 。如7(00000111B)表示周二，周一  |          |
|                 |      | 和周日。若仅需单次执行，值为0。 |          |
+-----------------+------+---------------------------------+----------+
| Enable          | Nu   | 任务是否启用0：不启用， 1：启用 | Y        |
|                 | mber |                                 |          |
+-----------------+------+---------------------------------+----------+
| Action          | St   | 任务指令，可能取值如下：        | Y        |
|                 | ring |                                 |          |
|                 |      | ToReboot（重启）                |          |
|                 |      |                                 |          |
|                 |      | ToSetH                          |          |
|                 |      | ealthMode（健康模式，定时开、关 |          |
|                 |      | Wi-Fi，（健康模式，定时开、关Wi |          |
|                 |      | -Fi，在TimeOffset对应的时间关闭 |          |
|                 |      | 指定index的Wi-Fi，在TimeOffset2 |          |
|                 |      | 对应的时间开启它。当TimeOffset2 |          |
|                 |      | 小于TimeOffset时，TimeOffset2代 |          |
|                 |      | 表相对于第二天0点的时间偏移量） |          |
+-----------------+------+---------------------------------+----------+
| TimeOffset2     | Long | 仅当Action为T                   | N        |
|                 |      | oSetHealthMode时，才携带该字段, |          |
|                 |      | 执行时                          |          |
|                 |      | 间偏移量（执行任务的时间点与当  |          |
|                 |      | 天凌晨0点的时间差，以秒为单位） |          |
+-----------------+------+---------------------------------+----------+
| Index           | Nu   | 仅当Action为ToSetHeal           | Y        |
|                 | mber | thMode时，才携带该字段。2.4G用1 |          |
|                 |      | -4，5G用5-8，0表示所有Wi-Fi索引 |          |
+-----------------+------+---------------------------------+----------+

示例：

{\"function\":\"XControl_TimerTask\",\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"Operation\":\"Add\",\"TaskId\":\"\*\*\*\*\*\",\"TimeOffset\":3600,\"Week\":7,\"Enable\":1,\"Action\":\"ToSetHealthMode\",\"TimeOffset2\":4200,\"Index\":1}}

## 开启快连 {#开启快连-1 .QB标题6}

该接口下发后，开启快连热点CMCC-QLINK，窗口期4分钟，如窗口期内重复收到开启快连指令，则重新计算窗口期。

示例：

{\"function\":\"XControl_OpenQlink\",\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"data\":{}}

说明：若组网终端开启了Wi-Fi
5兼容模式，收到该请求时，通过7.3.2.8出错上报接口来响应，eventType为Response\_{
function}，respCode为1004，respCont为\"WiFi5 compatibilityStatus
open\"。

## 引导热点下发配网信息 {#引导热点下发配网信息-1 .QB标题6}

智能组网设备在收到该控制指令后，通过CMCC-GUIDE-LINK给data里的deviceMacs下发通知智能设备入网信息。

表7.4-52 组网终端组网终端引导热点下发配网信息参数表

  --------------- ------- ------------------------------------ -----------
  参数名          类型    描述                                 是否必须

  iotDeviceMacs   Array   取值\[\"mac1\", \"mac2\"\]           Y
  --------------- ------- ------------------------------------ -----------

示例：

{\"function\":\"XControl_NetInfo\",\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"iotDeviceMacs\":\[\"mac1\",\"mac2\"\]}}

## Wi-Fi配置自动同步开关 {#wi-fi配置自动同步开关-1 .QB标题6}

通过该消息针对组网终端配置Wi-Fi参数同步功能。组网终端默认Wi-Fi参数同步处于开启状态；

表7.4-53 开启下挂设备参数同步接口参数表

+--------------+------+------------------------------------+----------+
| 参数名       | 类型 | 描述                               | 是否必须 |
+--------------+------+------------------------------------+----------+
| syncEnable   | Nu   | 枚举值，是否开启自动同步；         | Y        |
|              | mber |                                    |          |
|              |      | 0：不启用， 1：启用；默认取值为1   |          |
+--------------+------+------------------------------------+----------+

示例：

{\"function\":\"XControl_OpenWiFiSync\",\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"syncEnable\":1}}

## 更新用户信息 {#更新用户信息-1 .QB标题6}

接口描述：用户信息user_key过期后，一级家庭开放平台会通过本接口将最新的user_key通过加密报文下发给组网终端，一级家庭开放平台根据异步响应上报的seqId判断，本接口下发成功与失败，如组网终端因离线等原因接收失败，平台将在组网终端再次上线时，重新下发本接口。

请求topic：/device/{deviceId}/downward

请求方向：一级家庭开放平台-\>组网终端

表7.4-54 更新用户信息接口请求参数表

  -------------- -------- ------------------------------------ -----------
  参数名         类型     描述                                 是否必须

  user_key       String   用户信息                             Y
  -------------- -------- ------------------------------------ -----------

请求示例：

{\"function\":\"XControl_UpdateUserkey\",\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"user_key\":\"\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\"}}

说明：

user_key加密方式如下：

加密算法：AES-128

加密模式：CBC

填充方式：PKCS5Padding

加密密钥：gwToken

智能组网设备每次向平台发起注册，平台都会生成一个随机的gwToken

偏移量："0000000000000000"(16个0)

输出格式：base64

字符集：utf-8

AES为对称加密算法，以上约定的方法也适用于解密算法

## 周期上报配置 {#周期上报配置-1 .QB标题6}

> 设置设备信息上报配置参数，包含上报周期和上报内容开关。设备收到平台配置指令后，组网终端应间隔interval，再发起首次周期上报，interval=rand\[0,
> 300\]，单位秒。

表7.4-55 周期上报配置数据体

+-----------------+------+-----------------------------------+--------+
| 参数名          | 类型 | 描述                              | 是     |
|                 |      |                                   | 否必须 |
+-----------------+------+-----------------------------------+--------+
| Statu           | St   | 设备                              | N      |
| sReportInterval | ring | Wi-Fi状态/上联状态上报周期，单位s |        |
|                 |      | （秒）；上报时间设置以600秒（10分 |        |
|                 |      | 钟）为公约数（例如600秒，1200秒， |        |
|                 |      | 1800秒），默认14400秒（4小时）；  |        |
+-----------------+------+-----------------------------------+--------+
| ReportInterval  | St   | 下挂设备上报周期，单位            | Y      |
|                 | ring | s(秒)，上报时间设置以600秒（10分  |        |
|                 |      | 钟）为公约数（例如600秒，1200秒， |        |
|                 |      | 1800秒），默认1800秒（30分钟）；  |        |
+-----------------+------+-----------------------------------+--------+
| SampleInterval  | St   | 数据采样                          | Y      |
|                 | ring | 间隔，单位s(秒)，间隔时间以60秒为 |        |
|                 |      | 公约数（例如60秒，120秒），默认60 |        |
|                 |      | s，采样间隔只用于统计收发速率信息 |        |
+-----------------+------+-----------------------------------+--------+
| Upl             | Nu   | 设备上行连接状态开关；            | Y      |
| inkStatusEnable | mber |                                   |        |
|                 |      | 取值为1（True），0(False)         |        |
+-----------------+------+-----------------------------------+--------+
| STAInfoEnable   | Nu   | 设备下挂设备信息开关；            | Y      |
|                 | mber |                                   |        |
|                 |      | 取值为1（True），0(False)         |        |
+-----------------+------+-----------------------------------+--------+
| Wla             | Nu   | 设备周边Wi-                       | N      |
| nNeighborEnable | mber | Fi信息，取值为1（True），0(False) |        |
+-----------------+------+-----------------------------------+--------+
| [STAChang       | [Nu  | [下挂设备状态                     | N      |
| eEnable]{.mark} | mber | 变更上报开关，默认关闭；]{.mark}  |        |
|                 | ]{.m |                                   |        |
|                 | ark} | [枚举取值；取                     |        |
|                 |      | 值为1（开启），0(关闭)；]{.mark}  |        |
+-----------------+------+-----------------------------------+--------+
| [STAChang       | [St  | [下                               | N      |
| eRptUrl]{.mark} | ring | 挂设备状态变更上报地址；]{.mark}  |        |
|                 | ]{.m |                                   |        |
|                 | ark} |                                   |        |
+-----------------+------+-----------------------------------+--------+
| ApC             | Nu   | 设备Wi-Fi状态信息；               | Y      |
| onfigInfoEnable | mber |                                   |        |
|                 |      | 取值为1（True），0(False)         |        |
+-----------------+------+-----------------------------------+--------+

说明：当[STAChangeEnable字段缺失时，默认关闭下挂设备状态变更上报功能；]{.mark}

示例：

{\"function\":\"XControl_ApReportConfig\",\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"StatusReportInterval\":\"14400\",\"ReportInterval\":\"1800\",\"SampleInterval\":\"60\",\"UplinkStatusEnable\":1,\"STAInfoEnable\":1,\"[WlanNeighborEnable]{.mark}\":1,\"[STAChangeEnable]{.mark}\":0,\"[STAChangeRptUrl]{.mark}\":\"\*\*\*\*\*\*\*\",\"ApConfigInfoEnable\":1}}

## 工作模式设置 {#工作模式设置-1 .QB标题6}

接口描述：通过该接口实现组网终端工作模式设置；（当用户具有多台组网终端时，APP仅对Controller终端进行工作模式设置；对于全光组网终端、AC+AP组网终端，APP应屏蔽该接口功能）。

表7.4-56 工作模式设置数据体

+-----------------+------+-----------------------------------+--------+
| 参数名          | 类型 | 描述                              | 是     |
|                 |      |                                   | 否必须 |
+-----------------+------+-----------------------------------+--------+
| WorkingMode     | Nu   | AP工作模式：                      | Y      |
|                 | mber |                                   |        |
|                 |      | 1：路由                           |        |
|                 |      |                                   |        |
|                 |      | 0：桥接                           |        |
+-----------------+------+-----------------------------------+--------+

示例：

{\"function\":\"XControl_WorkModelConfig\",\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"WorkingMode\":0}}

## 省份码配置接口 {#省份码配置接口 .QB标题6}

接口内容：通过该接口实现省份编码下发，终端收到该接口请求后，应写保存省码信息；

（注：若平台下发省份编码有误、或终端已有省份编码信息，执行出错上报流程）

表7.4-57 省份编码下发接口请求参数表

  -----------------------------------------------------------------------
  参数名          类型       描述                              是否必须
  --------------- ---------- --------------------------------- ----------
  provinceCode    String     组网终端省份信息                  Y

  -----------------------------------------------------------------------

示例：

{\"function\":\"XControl_ProvinceCode\",\"deviceId\":\"CMCC-30103-AABBCCDDEEFF\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"provinceCode\":\"ZHJ\"}}

## 扫码绑定 {#扫码绑定 .QB标题6}

接口内容：APP或WEB页面获取组网终端串码后，通过调用该接口，发送正式上网通道信息给组网终端；组网终端审核下发串码信息是否同自身串码信息一致，若信息一致则保存该接口的userkey信息，并重新注册上线，供后续接口调用时使用。并开启CMCC-GUIDE-LINK。若平台下发串码信息同设备自身串码不一致，则响应错误信息；

说明：当设备已绑定时，平台调用本接口下发指令时，设备上报错误响应，不执行绑定流程；

表7.4-58 扫码绑定指令参数表

  -----------------------------------------------------------------------------------------------
  参数名          类型        描述                                                    是否必须
  --------------- ----------- ------------------------------------------------------- -----------
  deviceMac       String      铭牌MAC地址，推荐使用WAN口MAC，格式为不带冒号并且大写   Y

  cmei            String      终端唯一标识                                            Y

  deviceSn        String      终端SN                                                  Y

  deviceVendor    String      厂商编码                                                Y

  deviceModel     String      型号编码                                                Y

  CGW             object      APP配网信息                                             Y

  user_key        String      用户信息                                                Y

  gwAddress       String      预留地址，组网终端无关                                  Y

  gwAddress2      String      终端连接地址，格式为https://\*\*\*\*\*                  Y
  -----------------------------------------------------------------------------------------------

示例：

{\"function\":\"XControl_ApBind\",\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"deviceMac\":\"00112233445566\",\"cmei\":\"\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\",\"deviceSn\":\"011101\*\*\*\*\*\*\*\*\*\",\"deviceVendor\":\"01\",\"deviceModel\":\"1101\",\"CGW\":{\"user_key\":\"\*\*\*\*\*\*\*\",\"gwAddress\":\"\*\*\*\*\*\*\*\",\"gwAddress2\":\"\*\*\*\*\*\*\*\"}}}

## 5GHz频段优先 {#ghz频段优先 .QB标题6}

接口内容：组网终端收到该接口时，需将指定STA限制接入2.4GHz，限制时间LimitedTime时间（建议3-5秒），并引导切换到5GHz频段；

平台下发该接口前，需判断当前在线的STA是否具备连接5GHz频段能力（建议识别标准：STA连接路由器的信号强度
RSSI
\>-70dbm，用户近一周内未修改SSID、KEY参数，且该STA在一周内连接过5GHz频段）；

表7.3-73 5GHz频段优先请求参数表

  ------------------------------------------------------------------------------------------------------------------------------------------
  参数名           类型       描述                                                                                               是否必须
  ---------------- ---------- -------------------------------------------------------------------------------------------------- -----------
  function         String     控制事件类型，取值："XControl_5GPreferred"                                                         Y

  deviceId         String     组网终端ID                                                                                         Y

  seqId            String     会话ID：请求唯一标识                                                                               Y

  data             Object     终端待解析数据包                                                                                   Y

  5GPreferredSta   String     名单列表："mac地址/设备名"格式；多信息之间以逗号分开，最多支持32组。示例：\"AABBCCDDEE00/iphone,   Y
                              112233445566/Mi\"                                                                                  

  LimitedTime      Number     限制连接2.4GHz频段的时间，单位毫秒，缺省值为3000；                                                 Y
  ------------------------------------------------------------------------------------------------------------------------------------------

示例：

{\"function\":\"XControl_5GPreferred\",\"deviceId\":\"CMCC-30103-AABBCCDDEEFF\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"5GPreferredSta\":\"AABBCCDDEE00/iphone,112233445566/Mi\",\"LimitedTime\":3000}}

## 优先级配置 {#优先级配置 .QB标题6}

接口内容：通过该接口实现路由器QoS优先级配置，组网终端应支持通过MAC（包含源MAC和目的MAC）或五元组信息（包含源IP地址、目的IP地址、协议号、源端口、目的端口）对相关业务进行优先级调度。该接口仅需AP工作在路由模式下支持；

平台调用该接口配置业务优先级时，需在WLAN空口进行WMM队列的映射，支持WMM定义的四中流类型（VOICE/VIDEO/BEST
EFORT/BACKGROUND）及其优先级调度规则，支持基于优先级的数据处理和转发。WMM
和 DSCP 的映射关系如下表所示：

表1-1WMM和DSCP映射关系

  ----------------------- ----------------------- -----------------------
  QoS范围                 DSCP范围                WMM流类型

  0                       0\~7                    AC_BE

  1\~2                    8\~23                   AC_BK

  3                       24\~31                  AC_BE

  4\~5                    32\~47                  AC_VI

  6\~7                    48\~63                  AC_VO
  ----------------------- ----------------------- -----------------------

表2-3 QoS优先级配置接口请求参数表

  -----------------------------------------------------------------------------------------------------------
  参数名            类型       描述                                                               是否必须
  ----------------- ---------- ------------------------------------------------------------------ -----------
  function          String     控制事件类型，取值："XControl_QoS"                                 Y

  deviceId          String     组网终端ID                                                         Y

  seqId             String     会话ID：请求唯一标识                                               Y

  data              Object     终端待解析数据包                                                   Y

  QosEnable         Number     QoS开关；1：打开，0：关闭                                          Y

  QosParameter      Array      QoS分类规则，最大下发8个实例；                                     N

  QosPriority       Number     QoS优先级；取值范围：0-7；数值越大优先级越高；                     N

  DscpEnable        Number     DSCP优先级开关；1：打开，0：关闭                                   N

  DscpPriority      Number     DSCP优先级；取值范围：0-63；数值越大优先级越高；                   N

  Vlan8021pEnable   Number     802.1P启用开关；1：打开，0关闭                                     N

  Vlan8021p         Number     VLAN优先级；取值范围：0-7；数值越大优先级越高；                    N

  SourceIp          String     源IP                                                               N

  SourcePort        String     源端口                                                             N

  DestinationIp     String     目的地IP                                                           N

  DestinationPort   String     目的地端口                                                         N

  Protocol          String     传输协议列表，多种协议时使用逗号进行分割；取值为：TCP，UDP，ICMP   N

  SourceMac         String     源MAC（一般只路由器铭牌MAC）                                       N

  DestinationMac    String     目的MAC（下挂设备MAC）                                             N
  -----------------------------------------------------------------------------------------------------------

示例：

{\"function\":\"XControl_QoS\",\"deviceId\":\"CMCC-30103-\*\*\*\*\*\*\*\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"QosEnable\":1,\"QosParameter\":\[{\"QosPriority\":5,\"DscpEnable\":1,\"DscpPriority\":45,\"SourceMac\":\"\*\*\*\*\*\*\*\*\*\*\*\*\",\"DestinationMac\":\"\*\*\*\*\*\*\*\*\*\*\*\*\"},{\"QosPriority\":7,\"DscpEnable\":1,\"DscpPriority\":57,\"SourceIp\":\"224.xx.xx.xx\",\"SourcePort\":\"\*\*\*\*\",\"DestinationIp\":\"xx.xx.xx.xx\",\"DestinationPort\":\"\*\*\*\*\",\"Protocol\":\"TCP\"},{\"QosPriority\":6,\"Vlan8021pEnable\":1,\"Vlan8021p\":6,\"SourceIp\":\"224.xx.xx.xx\",\"SourcePort\":\"\*\*\*\*\",\"DestinationIp\":\"xx.xx.xx.xx\",\"DestinationPort\":\"\*\*\*\*\",\"Protocol\":\"ICMP\"}\]}}

## 配置家庭内网加速通道 {#配置家庭内网加速通道-1 .QB标题6}

接口内容：通过该消息配置家庭内网加速通道信息；

接口要求：

① 组网终端接收到加速通道接口指令时，需保存加速通道信息。

②
当平台开启内网加速功能时，终端需在每次重启后，主动更新内网加速通道信息；

③
当组网终端获取内网加速通道信息时间超48小时后，组网终端应间隔interval，主动更新内网加速通道信息，interval=rand\[0,
86400\]，单位秒。

表2-7 家庭内网加速通道配置接口请求参数表

+------------+-------+----------------------------------------+-------+
| 参数名     | 类型  | 描述                                   | 是否  |
|            |       |                                        | 必须  |
+============+=======+========================================+=======+
| function   | S     | 控制                                   | Y     |
|            | tring | 事件类型，取值："XControl_Accelerate"  |       |
+------------+-------+----------------------------------------+-------+
| seqId      | S     | 会话ID：请求唯一标识                   | Y     |
|            | tring |                                        |       |
+------------+-------+----------------------------------------+-------+
| deviceId   | S     | 组网终端ID                             | Y     |
|            | tring |                                        |       |
+------------+-------+----------------------------------------+-------+
| data       | O     | 终端待解析数据包                       | Y     |
|            | bject |                                        |       |
+------------+-------+----------------------------------------+-------+
| AccEnable  | N     | 加速通道开关；1：打开，0：关闭         | Y     |
|            | umber |                                        |       |
+------------+-------+----------------------------------------+-------+
| AccNumber  | N     | 加速通道数量                           | N     |
|            | umber | ，建议不超过8项；加速通道开启时必选；  |       |
+------------+-------+----------------------------------------+-------+
| AccStatus  | Array | 加速通道信息；加速通道开启时必选；     | N     |
+------------+-------+----------------------------------------+-------+
| AccId      | S     | 加速通道ID；加速通道开启时必选；       | N     |
|            | tring |                                        |       |
+------------+-------+----------------------------------------+-------+
| AccUrl     | S     | 加速                                   | N     |
|            | tring | 通道信息获取地址；加速通道开启时必选； |       |
|            |       |                                        |       |
|            |       | 说明：当终端                           |       |
|            |       | 收到指令时，需向该连接地址获取需加速的 |       |
|            |       | IP地址；（地址格式，请平台侧做好同步） |       |
+------------+-------+----------------------------------------+-------+

示例：

{\"deviceId\":\"CMCC-30103-AABBCCDDEEFF\",\"seqId\":\"\*\*\*\*\*\",\"function\":\"XControl_Accelerate\",\"data\":{\"AccEnable\":1,\"AccNumber\":2,\"AccStatus\":\[{\"AccId\":\"xxxx\",\"AccUrl\":\"xxxx\"},{\"AccId\":\"xxxx\",\"AccUrl\":\"xxxx\"}\]}}

## Speedtest下载测试 {#speedtest下载测试-1 .QB标题6}

接口描述：通过该消息组网终端基于MQTT进行下载测试，通过APP实现网络测速功能。[APP进行测速时通过该接口将完整的上报地址下发给AOS-NET。]{.mark}

表2-23 Speedtest下载测速请求参数表

  ------------------------- ----------------- ---------------------------------------------- ------------
  参数名                    类型              描述                                           是否必须

  function                  String            控制事件类型，取值："XControl_HttpSpeedTest"   Y

  seqId                     String            会话ID：请求唯一标识                           Y

  deviceId                  String            组网终端ID                                     Y

  data                      Object            终端待解析数据包                               Y

  HttpSpeedTestUrl          String            HttpSpeedTest下载测速url地址                   Y

  HttpSpeedTestTime         Number            HttpSpeedTest下载测试时间，单位s(秒)           Y

  HttpSpeedTestInterval     Number            HttpSpeedTest事件上报间隔时间，单位ms(毫秒)    Y

  [SpeedResultUrl]{.mark}   [String]{.mark}   [下载测速结果上报url地址]{.mark}               [N]{.mark}
  ------------------------- ----------------- ---------------------------------------------- ------------

成功示例：

{\"function\":\"XControl_HttpSpeedTest\",\"deviceId\":\"CMCC-30103-\*\*\*\*\*\*\*\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"HttpSpeedTestUrl\":\"http://xxxxxxxx\",\"HttpSpeedTestTime\":20,\"HttpSpeedTestInterval\":100,[\"SpeedResultUrl\":\"xxxxxxxx\"]{.mark}}}

## Speedtest测速控制 {#speedtest测速控制 .QB标题6}

接口描述：
Speedtest测速控制，若正在进行测试时，收到该指令则结束该测试任务，并上报指令响应成功；若未处于测速状态时收到该指令，则上报指令响应成功。

表2-27 Speedtest测速控制

+--------------+------+------------------------------------+----------+
| 参数名       | 类型 | 描述                               | 是否必须 |
+--------------+------+------------------------------------+----------+
| function     | St   | 控制事件类型                       | Y        |
|              | ring | ，取值："XControl_SpeedtestConfig" |          |
+--------------+------+------------------------------------+----------+
| deviceId     | St   | 组网终端ID                         | Y        |
|              | ring |                                    |          |
+--------------+------+------------------------------------+----------+
| seqId        | St   | 会话ID：请求唯一标识               | Y        |
|              | ring |                                    |          |
+--------------+------+------------------------------------+----------+
| data         | Ob   | 终端待解析数据包                   | Y        |
|              | ject |                                    |          |
+--------------+------+------------------------------------+----------+
| Spe          | Nu   | Speedtest测速控制开关，            | Y        |
| edtestSwitch | mber |                                    |          |
|              |      | 1：停止测速；                      |          |
+--------------+------+------------------------------------+----------+

成功示例：

{\"function\":\"XControl_SpeedtestConfig\",\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"SpeedtestSwitch\":1}}

## 组播转单播开关控制 {#组播转单播开关控制-1 .QB标题6}

接口描述：
若该功能开启时，控制AP开启/关闭组播转单播能力。组网终端默认开启组播转单播功能；

表2-31 组播转单播开关控制

  ----------------- -------- ------------------------------------------------ -----------
  参数名            类型     描述                                             是否必须

  function          String   控制事件类型，取值："XControl_MulticastConfig"   Y

  deviceId          String   组网终端ID                                       Y

  seqId             String   会话ID：请求唯一标识                             Y

  data              Object   终端待解析数据包                                 Y

  MulticastEnable   Number   组播转单播开关控制；0: 关闭；1: 开启             Y
  ----------------- -------- ------------------------------------------------ -----------

示例：{\"function\":\"XControl_MulticastConfig\",\"deviceId\":\"\*\*\*\*\*\",\"seqId\":\"\*\*\*\*\*\",\"data\":{\"MulticastEnable\":1}}

## 日志上报 {#日志上报-1 .QB标题6}

接口描述：通过该消息控制组网终端进行日志上报；

表7.3-xxx 日志上报请求参数表

  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  参数名         类型      描述                                                                                                                                                        是否必须
  -------------- --------- ----------------------------------------------------------------------------------------------------------------------------------------------------------- ----------
  function       String    控制事件类型，取值"XControl_LogReport"                                                                                                                      Y

  deviceId       String    组网终端ID                                                                                                                                                  Y

  seqId          String    会话ID：请求唯一标识                                                                                                                                        Y

  data           Object    终端待解析数据包;                                                                                                                                           Y

  TimeOut        Number    收集日志的超时时间，单位秒。从起点日志收集开始，收集TimeOut时长日志信息，同时把生成的日志文件上传到平台；若下发TimeOut参数为"0"，则上报插件存储日志信息；   Y

  LogUrl         String    上报日志的HTTP URL地址，举例：https://server:port/rest/logreport/1.0?access_token=keisda73nc6hn234k5kj6j78k1j34n5n4n6n7l9f&mac=22-33-44-55-66-77;           Y

  LogLevel       Number    日志级别，0表示DEBUG，1表示INFO, 2表示ERROR；                                                                                                               Y
  -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

示例：{\"function\":\"XControl_LogReport\",\"deviceId\":\"\*\*\*\",\"seqId\":\"\*\*\*\",\"data\":{\"TimeOut\":100,\"LogUrl\":\"https://xxxxxx\",\"LogLevel\":1}}

## 响应 {#响应-60 .QB标题5}

成功：控制成功后使用"7.3.2.7数据上报接口"异步上报数据，eventType为XData\_{
function}，data值同7.3.2.7.2数据上报请求接口中的data值。

其中，TimerTask控制命令对应的异步7.3.2.7数据上报接口，需要上报所有的TimerTask，即数据上报eventType为XData_TimerTask的data内容如下：

表7.4-59 组网终端响应参数表

+-------------+-------------------+-----------------------------------+
| X           | Tasks             | 见上表                            |
| Data_TimerT |                   |                                   |
| ask的data体 |                   |                                   |
|             |                   |                                   |
| （当        |                   |                                   |
| 前所有Time  |                   |                                   |
| rTask内容） |                   |                                   |
+-------------+-------------------+-----------------------------------+
|             | TaskId            | 见上表                            |
+-------------+-------------------+-----------------------------------+
|             | TimeOffset        | 见上表                            |
+-------------+-------------------+-----------------------------------+
|             | Week              | 见上表                            |
+-------------+-------------------+-----------------------------------+
|             | Enable            | 见上表                            |
+-------------+-------------------+-----------------------------------+
|             | Action            | 见上表                            |
+-------------+-------------------+-----------------------------------+
|             | TimeOffset2       | 见上表                            |
+-------------+-------------------+-----------------------------------+
|             | Index             | 见上表                            |
+-------------+-------------------+-----------------------------------+

失败：异步方式，7.3.2.8出错上报接口eventType为Response\_{ function}

## 数据查询 {#数据查询 .QB标题4}

## 接口描述 {#接口描述-11 .QB标题5}

接口内容：触发组网终端上报当前数据

请求 topic：/device/{deviceId}/downward

请求类型：家开平台-\>组网终端

## 请求 {#请求-61 .QB标题5}

示例：

{

\"function\": \"XQuery\_\*\*\*\",

\"seqId\": \"\*\*\*\*\*\",

\"deviceId\": \"\*\*\*\*\*\"

}

## 配置信息查询 {#配置信息查询 .QB标题6}

表7.4-60 配置信息查询参数表

  -------------------------------------------------------------------------
  参数名         类型      描述                                  是否必须
  -------------- --------- ------------------------------------- ----------
  function       String    命令字，取值"XQuery_ApConfigInfo"     Y

  seqId          String    会话ID：请求唯一标识                  Y

  deviceId       String    组网终端ID                            Y
  -------------------------------------------------------------------------

示例：{\"function\":\"XQuery_ApConfigInfo\",\"seqId\":\"\*\*\*\*\*\",\"deviceId\":\"\*\*\*\*\*\"}

## 上联状态查询 {#上联状态查询 .QB标题6}

表7.4-61上联状态查询参数表

  -------------------------------------------------------------------------
  参数名         类型      描述                                  是否必须
  -------------- --------- ------------------------------------- ----------
  function       String    命令字，取值"XQuery_UplinkStatus"     Y

  seqId          String    会话ID：请求唯一标识                  Y

  deviceId       String    组网终端ID                            Y
  -------------------------------------------------------------------------

示例：{\"function\":\"XQuery_UplinkStatus\",\"seqId\":\"\*\*\*\*\*\",\"deviceId\":\"\*\*\*\*\*\"}

## 下挂设备信息查询 {#下挂设备信息查询 .QB标题6}

表7.4-62下挂设备信息查询参数表

  -------------------------------------------------------------------------
  参数名       类型          描述                                是否必须
  ------------ ------------- ----------------------------------- ----------
  function     String        命令字，取值"XQuery_STAInfo"        Y

  seqId        String        会话ID：请求唯一标识                Y

  deviceId     String        组网终端ID                          Y
  -------------------------------------------------------------------------

示例：{\"function\":\"XQuery_STAInfo\",\"seqId\":\"\*\*\*\*\*\",\"deviceId\":\"\*\*\*\*\*\"}

## 周边Wi-Fi信息查询 {#周边wi-fi信息查询 .QB标题6}

表7.4-63 周边Wi-Fi信息查询参数表

+-------------+----------+-----------------------------------+--------+
| 参数名      | 类型     | 描述                              | 是     |
|             |          |                                   | 否必须 |
+=============+==========+===================================+========+
| function    | String   | 命令字，取值"XQuery\_             | Y      |
|             |          | WlanNeighbor"                     |        |
+-------------+----------+-----------------------------------+--------+
| seqId       | String   | 会话ID：请求唯一标识              | Y      |
+-------------+----------+-----------------------------------+--------+
| deviceId    | String   | 组网终端ID                        | Y      |
+-------------+----------+-----------------------------------+--------+
| data        | Object   | 终端待解析数据包;                 | Y      |
+-------------+----------+-----------------------------------+--------+
| [Wl         | [Number  | [周边                             | N      |
| anNeighborT | ]{.mark} | Wi-Fi扫描类型；枚举取值；]{.mark} |        |
| ype]{.mark} |          |                                   |        |
|             |          | [取值为                           |        |
|             |          | 1（全信道扫描），0(工作信道监测)  |        |
|             |          | ；]{.mark}                        |        |
|             |          |                                   |        |
|             |          | 说明：                            |        |
|             |          | 该值缺失时，默认执行工作信道监测  |        |
+-------------+----------+-----------------------------------+--------+

示例：

{\"function\":\"XQuery_WlanNeighbor\",\"seqId\":\"\*\*\*\*\*\",\"deviceId\":\"\*\*\*\*\*\",\"data\":{\"[WlanNeighborType]{.mark}\":0}}

## 收发报文统计查询 {#收发报文统计查询 .QB标题6}

表7.4-64 收发报文统计参数表

  -------------------------------------------------------------------------
  参数名         类型      描述                                  是否必须
  -------------- --------- ------------------------------------- ----------
  function       String    命令字，取值"XQuery_WiFiStats"        Y

  seqId          String    会话ID：请求唯一标识                  Y

  deviceId       String    组网终端ID                            Y
  -------------------------------------------------------------------------

示例：{\"function\":\"XQuery_WiFiStats\",\"seqId\":\"\*\*\*\*\*\",\"deviceId\":\"\*\*\*\*\*\"}

## 端口参数查询 {#端口参数查询-1 .QB标题6}

表7.4-65 端口参数查询信息参数表

  -----------------------------------------------------------------------------
  参数名         类型      描述                                      是否必须
  -------------- --------- ----------------------------------------- ----------
  function       String    命令字，取值"XQuery_InternetAccessInfo"   Y

  seqId          String    会话ID：请求唯一标识                      Y

  deviceId       String    组网终端ID                                Y
  -----------------------------------------------------------------------------

示例：{\"function\":\"XQuery_InternetAccessInfo\",\"seqId\":\"\*\*\*\*\*\",\"deviceId\":\"\*\*\*\*\*\"}

## 网速分配查询 {#网速分配查询 .QB标题6}

表7.4-66 网速分配查询参数表

  -------------------------------------------------------------------------
  参数名         类型      描述                                  是否必须
  -------------- --------- ------------------------------------- ----------
  function       String    命令字，取值"XQuery_AllDeviceLimit"   Y

  seqId          String    会话ID：请求唯一标识                  Y

  deviceId       String    组网终端ID                            Y
  -------------------------------------------------------------------------

示例：{\"function\":\"XQuery_AllDeviceLimit\",\"seqId\":\"\*\*\*\*\*\",\"deviceId\":\"\*\*\*\*\*\"}

## 定时任务查询 {#定时任务查询 .QB标题6}

表7.4-67 定时查询任务参数表

  -------------------------------------------------------------------------
  参数名         类型      描述                                  是否必须
  -------------- --------- ------------------------------------- ----------
  function       String    命令字，取值"XQuery_AllTimerTask"     Y

  seqId          String    会话ID：请求唯一标识                  Y

  deviceId       String    组网终端ID                            Y
  -------------------------------------------------------------------------

示例：{\"function\":\"XQuery_AllTimerTask\",\"seqId\":\"\*\*\*\*\*\",\"deviceId\":\"\*\*\*\*\*\"}

## 周期上报配置查询 {#周期上报配置查询 .QB标题6}

表7.4-68 周期上报配置信息参数表

  -------------------------------------------------------------------------
  参数名         类型      描述                                  是否必须
  -------------- --------- ------------------------------------- ----------
  function       String    命令字，取值"XQuery\_ ApReportConfig" Y

  seqId          String    会话ID：请求唯一标识                  Y

  deviceId       String    组网终端ID                            Y
  -------------------------------------------------------------------------

示例：{\"function\":\"XQuery\_ ApReportConfig
\",\"seqId\":\"\*\*\*\*\*\",\"deviceId\":\"\*\*\*\*\*\"}

## 网络拓扑查询 {#网络拓扑查询-1 .QB标题6}

说明：拓扑网络查询接口仅对Controller或AC设备要求；

表7.4-69 拓扑网络信息参数表

  -------------------------------------------------------------------------
  参数名         类型      描述                                  是否必须
  -------------- --------- ------------------------------------- ----------
  function       String    命令字，取值"XQuery_MAPTopology"      Y

  seqId          String    会话ID：请求唯一标识                  Y

  deviceId       String    组网终端ID                            Y
  -------------------------------------------------------------------------

示例：{\"function\":\"XQuery_MAPTopology
\",\"seqId\":\"\*\*\*\*\*\",\"deviceId\":\"\*\*\*\*\*\"}

## 扩展信息查询 {#扩展信息查询-2 .QB标题6}

通过该消息查询组网终端的扩展配置信息，包含VLAN配置和QoS配置；

表7.4-69 拓扑网络信息参数表

  -------------------------------------------------------------------------
  参数名         类型      描述                                  是否必须
  -------------- --------- ------------------------------------- ----------
  function       String    命令字，取值"XQuery\_ ApConfigInfo2"  Y

  seqId          String    会话ID：请求唯一标识                  Y

  deviceId       String    组网终端ID                            Y
  -------------------------------------------------------------------------

示例：{\"function\":\"XQuery\_
ApConfigInfo2\",\"seqId\":\"\*\*\*\*\*\",\"deviceId\":\"\*\*\*\*\*\"}

## 内网加速信息查询 {#内网加速信息查询 .QB标题6}

通过该消息查询家庭内网加速通道信息；

表7.4-69 拓扑网络信息参数表

  -------------------------------------------------------------------------
  参数名         类型      描述                                  是否必须
  -------------- --------- ------------------------------------- ----------
  function       String    命令字，取值"XQuery\_ Accelerate"     Y

  seqId          String    会话ID：请求唯一标识                  Y

  deviceId       String    组网终端ID                            Y
  -------------------------------------------------------------------------

示例：{\"function\":\"XQuery_Accelerate
\",\"seqId\":\"\*\*\*\*\*\",\"deviceId\":\"\*\*\*\*\*\"}

## 响应 {#响应-61 .QB标题5}

成功：异步方式，7.4.2.6数据上报接口eventType为XData\_\*\*\*

失败：异步方式，7.4.2.7出错上报接口eventType为Response\_{ function}

## 组网终端解绑 {#组网终端解绑 .QB标题4}

## 接口描述 {#接口描述-12 .QB标题5}

接口内容：解除或新增组网终端在平台上的绑定关系，解绑组网终端时如组网终端不在线则平台单方面解绑设备信息，若组网终端在线则平台解除绑定信息的同时，组网终端收到Unbind后保持与平台的长连接，开启发现服务，即能响应应用发现组网终端。组网终端被解绑后，需关闭CMCC-GUIDE-LINK。

请求 topic：/device/{deviceId}/downward

请求类型：家开平台-\>组网终端

## 请求 {#请求-62 .QB标题5}

{

\"function\": \"Unbind\",

\"deviceId\": \"\*\*\*\*\*\"

}

## 响应 {#响应-62 .QB标题5}

成功：无回复

失败：异步方式，7.4.2.6出错上报接口eventType为Response_Unbind

## 文件操作 {#文件操作 .QB标题4}

## 接口描述 {#接口描述-13 .QB标题5}

接口内容：对组网终端上的文件进行操作

请求 topic：/device/{deviceId}/downward

请求类型：家开平台-\>组网终端

## 请求 {#请求-63 .QB标题5}

表7.4-70文件操作参数表

  ---------------------------------------------------------------------------------------------
  参数名                类型         描述                                           是否必须
  --------------------- ------------ ---------------------------------------------- -----------
  fileMode              String       DOWN下载文件,UP上传文件                        Y

  fileType              String       如FIRM固件/APP应用/LOG日志文件/CFG配置文件等   N

  fileUrl               String       组网终端文件访问/上传路径                      Y

  downMode              Number       若fileMode为DOWN,1立即升级,0下次重启升级       N
  ---------------------------------------------------------------------------------------------

示例：

{\"function\":\"XControl_File\",\"deviceId\":\"\*\*\*\*\*\",\"data\":{\"fileMode\":\"\*\*\*\*\*\",\"fileType\":\"\*\*\*\*\*\",\"fileUrl\":\"http://\*\*\*\*\",\"downMode\":1}}

缺省值约定：

fileMode=DOWN，则fileType默认为FIRM，downMode=1，

fileMode=UP没有默认值，忽略downMode

## 响应 {#响应-63 .QB标题5}

成功：异步方式，数据上报接口eventType为XData_File

File的data数据体：

表7.4-71文件操作参数表

  -------------------------------------------------------------------------
  参数名                类型         描述                        是否必须
  --------------------- ------------ --------------------------- ----------
  respCode              Number       见响应码表，如：2002        Y

  respCont              String       0-100表示文件操作当前进度   Y
  -------------------------------------------------------------------------

> 成功示例：
>
> {\"deviceId\":\"myDeviceId\",\"eventType\":\"XData_File\",\"timestamp\":1626948825804,\"data\":{\"respCode\":2002,\"respCont\":\"80\"}}

失败：异步方式，出错上报接口eventType为Response\_ XControl_File

失败示例：

> {\"eventType\":\"Response_XControl_File\",\"deviceId\":\"\*\*\*\*\*\",\"timestamp\":\"\*\*\*\*\*\",\"respCode\":X,\"respCont\":\"\*\*\*\*\*\"}

## 应用发现设备 {#应用发现设备 .QB标题4}

## 接口内容 {#接口内容 .QB标题5}

接口描述：提供广播服务待应用实现主动发现，[无论设备是否绑定，设备均需响应该接口。]{.mark}

请求url：coap://broadcastIP:5683/qlink/searchdevice

请求类型：POST-NON，应用-\>组网终端

## 请求 {#请求-64 .QB标题5}

表7.4-72应用发现设备请求参数表

  ---------------------------------------------------------------------------------------------------
  参数名                类型              描述                                           是否必须
  --------------------- ----------------- ---------------------------------------------- ------------
  searchKey             String            广播发现的key，约定为该值                      Y

  andlinkVersion        String            插件版本号                                     Y

  [AppVersion]{.mark}   [String]{.mark}   [和家亲版本，6.6.0及以上版本必须上报]{.mark}   [N]{.mark}
  ---------------------------------------------------------------------------------------------------

示例：

{\"searchKey\":\"ANDLINK-APP\",\"andlinkVersion\":\"V3\",[\"AppVersion\":\"6.6.0\"]{.mark}}

## 响应 {#响应-64 .QB标题5}

表7.4-73应用发现设备响应参数表

+------------------+-----------+----------------------------+---------+
| 参数名           | 类型      | 描述                       | 是      |
|                  |           |                            | 否必须  |
+==================+===========+============================+=========+
| searchAck        | String    | 广播发现的key，约定为该值  | Y       |
+------------------+-----------+----------------------------+---------+
| andlinkVersion   | String    | 插件版本号                 | Y       |
+------------------+-----------+----------------------------+---------+
| [Ap              | [Strin    | [和家亲版本，6.6.0         | [N]     |
| pVersion]{.mark} | g]{.mark} | 及以上版本必须上报]{.mark} | {.mark} |
+------------------+-----------+----------------------------+---------+
| deviceType       | String    | 组网终端类型码             | Y       |
+------------------+-----------+----------------------------+---------+
| deviceVendor     | String    | 组网终端厂商编码           | N       |
+------------------+-----------+----------------------------+---------+
| deviceModel      | String    | 组网终端的产品型号编码     | N       |
+------------------+-----------+----------------------------+---------+
| meshRole         | Number    | Mesh角色（枚举）：         | N       |
|                  |           |                            |         |
|                  |           | 0：非mesh终端；            |         |
|                  |           |                            |         |
|                  |           | 1：controller；            |         |
|                  |           |                            |         |
|                  |           | 2：agent；                 |         |
|                  |           |                            |         |
|                  |           | 3：AC；                    |         |
|                  |           |                            |         |
|                  |           | 4：AP                      |         |
+------------------+-----------+----------------------------+---------+
| [bi              | [Numbe    | [                          | [N]     |
| ndStatus]{.mark} | r]{.mark} | 绑定状态枚举取值：]{.mark} | {.mark} |
|                  |           |                            |         |
|                  |           | [0：未绑定；]{.mark}       |         |
|                  |           |                            |         |
|                  |           | [1：已绑定；]{.mark}       |         |
+------------------+-----------+----------------------------+---------+

> 若设备未绑定，则返回如下响应：
>
> {\"searchAck\":\"ANDLINK-DEVICE\",\"andlinkVersion\":\"V3\",[\"AppVersion\":\"6.6.0\"]{.mark},\"deviceType\":\"\*\*\*\*\*\*\",\"deviceVendor\":\"\*\*\*\*\*\*\",\"deviceModel\":\"\*\*\*\*\*\*\",\"meshRole\":1,
> [\"bindStatus\":0]{.mark}}

## 组网终端入网 {#组网终端入网 .QB标题4}

## 接口内容 {#接口内容-1 .QB标题5}

接口描述：经用户确认后，发送正式上网通道信息给组网终端，组网终端切换到上网通道，采用收到的入网配置接入用户Wi-Fi网络，并重新注册上线，并且保存该接口的userkey信息，在后续接口调用时使用。并开启CMCC-GUIDE-LINK。

请求url：coap://deviceIP:5683/qlink/netinfo

请求类型：CON-POST，APP-\>组网终端

注意：对Wi-Fi设备，后续热点密码变更时也会调用该接口通知设备变更

## 请求 {#请求-65 .QB标题5}

表7.4-74入网请求参数表

  -------------------------------------------------------------------------------------
  参数名          类型          描述                                         是否必须
  --------------- ------------- -------------------------------------------- ----------
  SSID            String        热点名称                                     Y

  password        String        热点密码                                     Y

  encrypt         String        加密模式，枚举值见下                         Y

  channel         String        热点信道，整形，若为0需要设备自动选择        Y

  CGW             object        APP配网信息                                  Y

  user_key        String        用户信息                                     Y

  gwAddress       String        预留地址，组网终端无关                       Y

  gwAddress2      String        组网终端连接地址，格式为https://\*\*\*\*\*   Y
  -------------------------------------------------------------------------------------

示例：

{\"SSID\":\"\*\*\*\*\*\*\",\"password\":\"\*\*\*\*\*\*\",\"encrypt\":\"\*\*\*\*\*\*\*\",\"channel\":\"\*\*\*\*\*\*\",\"CGW\":{\"user_key\":\"\*\*\*\*\*\*\*\",\"gwAddress\":\"\*\*\*\*\*\*\*\",\"gwAddress2\":\"\*\*\*\*\*\*\*\"}}

注：

Wi-Fi加密模式枚举值如下：

None

WEP-64

WEP-128

WPA-Personal

WPA2-Personal

MIXED-WPAPSK2

WPA3-SAE

MIXED-WPA2WPA3

## 响应 {#响应-65 .QB标题5}

{

"respCode":xxxx, //1表示成功,0表示参数错误,1000鉴权失败

"respCont": "XXXXXX"//respCode=1时忽略

}

注：该接口设置成功后设备应尝试切换网络或注册，参考流程5.6.1

## 设备注册结果广播 {#设备注册结果广播 .QB标题4}

接口内容：设备通过一级家开平台注册到平台后，设备将一级家开平台返回的注册结果简单转换后广播给局域网中的APP

请求url：coap:/broadcastIp:5683/qlink/regist

请求类型：POST-CON，组网终端网络

表7.4-75 组网终端注册结果广播参数表

  ------------------------------------------------------------------------
  参数名          类型          描述                            是否必须
  --------------- ------------- ------------------------------- ----------
  respCode        Number        热点名称                        Y

  respCont        String        描述信息                        Y

  deviceId        String        组网终端ID                      Y

  deviceType      String        组网终端类型码                  Y
  ------------------------------------------------------------------------

注册结果请求报文格式：

{\"respCode\":X,\"respCont\":\"XXXX\",\"deviceId\":\"XXXXX\",\"deviceType\":\"XXXXX\"}

响应报文：

{"result":1} 表示成功，{"result":0}表示其他异常

## 无感配网接口流程 {#无感配网接口流程 .QB标题4}

## 智能设备广播查找组网终端 {#智能设备广播查找组网终端 .QB标题5}

接口内容：Wi-Fi设备连接组网设备的快连热点CMCC-QLINK或引导热点CMCC-GUIDE-LINK之后，通过本接口确定该组网终端是否为具备无感配网功能的组网终端。

请求url: coap://broadcastIp:5683/qlink/searchRouter

请求类型：POST-NON;

请求方向：设备-\>网络，

表7.4-76 智能设备广播查找组网终端接口参数表

  ------------------------------------------------------------------------------
  参数名           类型     描述                                      是否必须
  ---------------- -------- ----------------------------------------- ----------
  searchKey        String   广播发现的key，约定为\"ANDLINK-DEVICE\"   Y

  andlinkVersion   String   版本号，当前值V4                          Y
  ------------------------------------------------------------------------------

## 请求 {#请求-66 .QB标题6}

{

> \"searchKey\":\"ANDLINK-DEVICE\",
>
> \"andlinkVersion\":\"V4\",

}

## 响应 {#响应-66 .QB标题6}

{

> "searchAck":"ANDLINK-ROUTER",
>
> "andlinkVersion":"V4"

}

## Wi-Fi设备上报设备信息 {#wi-fi设备上报设备信息 .QB标题5}

接口内容：Wi-Fi设备发现扫描并连接到组网终端常开热点CMCC-GUIDE-LINK，并通过查找组网终端广播收到响应后，向组网终端发送智能设备基本信息。

请求url: coap:// ROUTERIP:5683/qlink/guide

请求类型：POST-CON; 智能设备-\>组网终端

## 请求 {#请求-67 .QB标题6}

表7.4-77 Wi-Fi设备上报设备信息接口参数表

  ---------------------------------------------------------------------------
  参数名          类型          描述                               是否必须
  --------------- ------------- ---------------------------------- ----------
  iotDeviceMac    String        智能设备MAC                        Y

  iotDeviceType   String        设备在开发者门户注册的产品类型码   Y

  iotDeviceIP     String        智能设备IP地址                     Y

  timestamp       Number        时间戳                             Y

  RSSI            String        信号强度                           N
  ---------------------------------------------------------------------------

示例：

{\"iotDeviceMac\":\"\*\*\*\*\*\",\"iotDeviceType\":\"\*\*\*\*\*\",\"iotDeviceIP\":\"\*\*\*\*\*\",\"timestamp\":1626948825804,\"RSSI\":\"\*\*\*\*\*\"}

## 响应 {#响应-67 .QB标题6}

{\"respCode\":X,\"respCont\":\"\*\*\*\*\*\"}

若组网终端未被绑定，respCode为4001。

## 组网终端上报待入网设备信息接口 {#组网终端上报待入网设备信息接口 .QB标题5}

组网终端收到Wi-Fi设备上报的设备信息后发送给一级家开平台。

请求URL：[https://open.home.komect.com/espapi/platform/json/cloudgateway/devices/qlink]()request

请求方式：POST

请求头：Content-Type: application/json

> Accept-Charset: utf-8
>
> User-Key: \*\*\*\*\*

请求方向：组网终端-\>一级家开平台

## 请求 {#请求-68 .QB标题6}

表7.4-78 组网终端上报待入网设备信息接口参数表

  -------------------------------------------------------------------------------------------------
  参数名          类型          描述                                                     是否必须
  --------------- ------------- -------------------------------------------------------- ----------
  deviceId        String        组网终端ID                                               Y

  iotDeviceMac    String        智能设备MAC，从Wi-Fi设备上报设备信息至组网终端接口获取   Y

  iotDeviceType   String        设备在开发者门户注册的产品类型码                         Y

  timestamp       Number        时间戳                                                   Y
  -------------------------------------------------------------------------------------------------

示例：

{\"deviceId\":\"\*\*\*\*\*\",\"iotDeviceMac\":\"\*\*\*\*\",\"iotDeviceType\":\"\*\*\*\*\*\",\"timestamp\":1626948825804}

## 响应 {#响应-68 .QB标题6}

示例：

{\"resultCode\":6,\"resultCodeDesc\":\"Object cannot
find\",\"resultCodeMessage\":\"deviceId cannot find!\"}

##  Wi-Fi设备入网请求 {#wi-fi设备入网请求 .QB标题5}

接口描述：设备连接组网终端的CMCC-QLINK引导通道成功后请求获取入网配置信息，该接口仅在组网终端开启快连的4分钟窗口期内回复。

请求url：coap://ROUTERIP:5683/qlink/request

请求类型：CON-POST，设备-\>组网终端

## 请求 {#请求-69 .QB标题6}

表7.4-79 Wi-Fi 设备入网请求参数表

  -----------------------------------------------------------------------------------------
  参数名          类型        描述                                               是否必须
  --------------- ----------- -------------------------------------------------- ----------
  iotDeviceMac    String      智能设备标识，应与设备条码(二维码中)中的信息一致   Y

  iotDeviceType   String      智能设备类型码，在Andlink开发者门户中预先定义      Y
  -----------------------------------------------------------------------------------------

示例：{\"iotDeviceMac\":\"\*\*\*\*\*\*\*\",\"iotDeviceType\":\"\*\*\*\*\*\*\"}

## 响应 {#响应-69 .QB标题6}

示例：{\"respCode\":1,\"respCont\":\"\*\*\*\*\*\*\*\"}

## 通知设备入网信息 {#通知设备入网信息 .QB标题5}

接口描述：组网终端在收到Wi-Fi设备入网请求或收到开启组网终端"引导热点下发配网信息"接口请求后，发送正式上网通道信息（2.4G）给设备（如Wi-Fi设备入网请求则发送给请求设备，如收到引导热点下发配网信息请求，则发送给请求数组中所包含的所有设备），设备切换到上网通道；采用收到的入网配置接入组网终端Wi-Fi网络。

请求url：coap://deviceIP:5683/qlink/netinfo

请求类型：CON-POST，组网终端-\>设备

## 请求 {#请求-70 .QB标题6}

表7.4-80 通知设备入网信息请求参数表

+---------+-------+----------------------------------------+---------+
| 参数名  | 类型  | 描述                                   | 是      |
|         |       |                                        | 否必须  |
+=========+=======+========================================+=========+
| code    | N     | 设备入网码，                           | N       |
|         | umber |                                        |         |
|         |       | 0 表示允许入网，下发入网信息；         |         |
|         |       |                                        |         |
|         |       | 非 0                                   |         |
|         |       | 表示拒绝入网，后续字段不填充：其中，1  |         |
|         |       | 表示 rssi 值不在阈值范围内，2          |         |
|         |       | 表示组网终端获取阈值异常。             |         |
|         |       |                                        |         |
|         |       | Wi-Fi设备上报消息内若携带信号          |         |
|         |       | 强度rssi时，该字段必填，否则无该字段。 |         |
+---------+-------+----------------------------------------+---------+
| SSID    | S     | 热点名称，设备允许入网时必填           | N       |
|         | tring |                                        |         |
+---------+-------+----------------------------------------+---------+
| p       | S     | 热点密码，设备允许入网时必填           | N       |
| assword | tring |                                        |         |
+---------+-------+----------------------------------------+---------+
| encrypt | S     | 加密模式，设备允许入网时必填           | N       |
|         | tring |                                        |         |
+---------+-------+----------------------------------------+---------+
| channel | S     | 热点信道，整形，若为                   | N       |
|         | tring | 0需要设备自动选择，设备允许入网时必填  |         |
+---------+-------+----------------------------------------+---------+
| cip     | N     | 密文标记，0 表示 password 不加密，1    | N       |
| hertext | umber | 表示 p                                 |         |
|         |       |                                        |         |
|         |       | assword 加密，无此字段表示不加密       |         |
+---------+-------+----------------------------------------+---------+
| ro      | S     | 组网终                                 | N       |
| uterMac | tring | 端铭牌MAC地址，推荐使用WAN口MAC，格式  |         |
|         |       | 为不带冒号并且大写，设备允许入网时必填 |         |
+---------+-------+----------------------------------------+---------+
| CGW     | o     | 如路由器已被绑定且设备允许入网时必填   | N       |
|         | bject |                                        |         |
+---------+-------+----------------------------------------+---------+
| u       | S     | 用户信息，如路由器已被绑定必填         | N       |
| ser_key | tring |                                        |         |
+---------+-------+----------------------------------------+---------+
| gw      | S     | 若支持本地网关接入，填写本地网关地址   | N       |
| Address | tring |                                        |         |
|         |       | （路由器 IP），否则该字段内容为空      |         |
+---------+-------+----------------------------------------+---------+
| gwA     | S     | 组网终                                 | N       |
| ddress2 | tring | 端连接地址，格式为https://\*\*\*\*\*， |         |
|         |       |                                        |         |
|         |       | 如路由器已被绑定必填，否则不上报该字段 |         |
+---------+-------+----------------------------------------+---------+
| trans   | Array | Wi-Fi信息参数数组                      | N       |
| mission |       |                                        |         |
+---------+-------+----------------------------------------+---------+
| Radio   | S     | transmiss                              | N       |
|         | tring | ion数组之一，Wi-Fi频段信息，枚举取值： |         |
|         |       |                                        |         |
|         |       | 2.4G                                   |         |
|         |       |                                        |         |
|         |       | 5G                                     |         |
|         |       |                                        |         |
|         |       | 5G-2                                   |         |
|         |       |                                        |         |
|         |       | 注：对于三频设备，5G表示5.1G频段，5G   |         |
|         |       | -2表示5.8G频段；双频设备忽略5G-2频段； |         |
+---------+-------+----------------------------------------+---------+
| Index   | N     | SSID的索引                             | N       |
|         | umber |                                        |         |
+---------+-------+----------------------------------------+---------+
| Enable  | N     | 是否启用，1为启用，0为禁用             | N       |
|         | umber |                                        |         |
+---------+-------+----------------------------------------+---------+
| SSID    | S     | SSID名称                               | N       |
|         | tring |                                        |         |
+---------+-------+----------------------------------------+---------+
| Secur   | S     | 认证加密模式，枚举取值：               | N       |
| ityMode | tring |                                        |         |
|         |       | None                                   |         |
|         |       |                                        |         |
|         |       | WEP-64                                 |         |
|         |       |                                        |         |
|         |       | WEP-128                                |         |
|         |       |                                        |         |
|         |       | WPA-Personal                           |         |
|         |       |                                        |         |
|         |       | WPA2-Personal                          |         |
|         |       |                                        |         |
|         |       | MIXED-WPAPSK2                          |         |
|         |       |                                        |         |
|         |       | WPA3-SAE                               |         |
|         |       |                                        |         |
|         |       | MIXED-WPA2WPA3                         |         |
+---------+-------+----------------------------------------+---------+
| Pwd     | S     | Wi-Fi密钥                              | N       |
|         | tring |                                        |         |
+---------+-------+----------------------------------------+---------+

示例：

{\"code\":0,\"SSID\":\"\*\*\*\*\*\*\",\"password\":\"\*\*\*\*\*\*\",\"encrypt\":\"\*\*\*\*\*\*\*\",\"channel\":\"\*\*\*\*\*\*\",\"ciphertext\":1,\"routerMac\":\"\*\*\*\*\*\",\"CGW\":{\"user_key\":\"\*\*\*\*\*\*\*\",\"gwAddress\":\"\*\*\*\*\*\*\*\",\"gwAddress2\":\"\*\*\*\*\*\*\*\"},\"transmission\":\[{\"Radio\":\"2.4G\",\"Index\":1,\"Enable\":1,\"SSID\":\"CMCC-2341\",\"SecurityMode\":\"MIXED-WPAPSK2\",\"Pwd\":\"XXXXXX\"},{\"Radio\":\"5G\",\"Index\":5,\"Enable\":1,\"SSID\":\"CMCC-2341-5G\",\"SecurityMode\":\"MIXED-WPAPSK2\",\"Pwd\":\"XXXXXX\"}\]}

## 响应 {#响应-70 .QB标题6}

示例：{\"respCode\":1,\"respCont\":\"\*\*\*\*\*\*\*\"}

注：

1、Wi-Fi加密模式枚举值如下：

None

WEP-64

WEP-128

WPA-Personal

WPA2-Personal

MIXED-WPAPSK2

WPA3-SAE

MIXED-WPA2WPA3

2.  组网终端收到开启快连请求，可根据请求数组中的设备mac与收到WiFi设备上报设备信息时保存设备mac、IP信息匹配后，给相应IP发送信息。建议组网终端在收到Wi-Fi设备上报设备信息时保存设备mac、IP信息时间1分钟或以上。

## 组网终端密码变更同步 {#组网终端密码变更同步 .QB标题5}

接口描述：在组网终端SSID名称、密码、加密模式变更前，广播智能组网更新后的SSID名称、密码、加密模式和自身无线下挂设备的MAC地址列表。组网终端发送完毕后执行变更，设备在收到广播后将自身MAC地址与上述MAC地址列表匹配，若匹配成功则同步变更Wi-Fi配置。

请求url：coap:// broadcastIp:5683/qlink/wifisync

请求类型：NON-POST，组网终端-\>设备

## 请求 {#请求-71 .QB标题6}

表7.4-81 密码同步请求参数表

+--------------+----------+-----------------------------------+-------+
| 参数名       | 类型     | 描述                              | 是否  |
|              |          |                                   | 必须  |
+==============+==========+===================================+=======+
| SSID         | String   | 热点名称                          | Y     |
+--------------+----------+-----------------------------------+-------+
| password     | String   | 热点密码                          | Y     |
+--------------+----------+-----------------------------------+-------+
| encrypt      | String   | 加密模式                          | Y     |
+--------------+----------+-----------------------------------+-------+
| transmission | Array    | Wi-Fi信息参数数组                 | N     |
+--------------+----------+-----------------------------------+-------+
| Radio        | String   | transmission数                    | N     |
|              |          | 组之一，Wi-Fi频段信息，枚举取值： |       |
|              |          |                                   |       |
|              |          | 2.4G                              |       |
|              |          |                                   |       |
|              |          | 5G                                |       |
|              |          |                                   |       |
|              |          | 5G-2                              |       |
|              |          |                                   |       |
|              |          | 注：对于三                        |       |
|              |          | 频设备，5G表示5.1G频段，5G-2表示  |       |
|              |          | 5.8G频段；双频设备忽略5G-2频段；  |       |
+--------------+----------+-----------------------------------+-------+
| Index        | Number   | SSID的索引                        | N     |
+--------------+----------+-----------------------------------+-------+
| Enable       | Number   | 是否启用，1为启用，0为禁用        | N     |
+--------------+----------+-----------------------------------+-------+
| SSID         | String   | SSID名称                          | N     |
+--------------+----------+-----------------------------------+-------+
| SecurityMode | String   | 认证加密模式，枚举取值：          | N     |
|              |          |                                   |       |
|              |          | None                              |       |
|              |          |                                   |       |
|              |          | WEP-64                            |       |
|              |          |                                   |       |
|              |          | WEP-128                           |       |
|              |          |                                   |       |
|              |          | WPA-Personal                      |       |
|              |          |                                   |       |
|              |          | WPA2-Personal                     |       |
|              |          |                                   |       |
|              |          | MIXED-WPAPSK2                     |       |
|              |          |                                   |       |
|              |          | WPA3-SAE                          |       |
|              |          |                                   |       |
|              |          | MIXED-WPA2WPA3                    |       |
+--------------+----------+-----------------------------------+-------+
| Pwd          | String   | Wi-Fi密钥                         | N     |
+--------------+----------+-----------------------------------+-------+
| macList      | Array    | 无线下挂设备MAC列表，\[\"mac1\",  | Y     |
|              |          | \"mac2\"\]                        |       |
+--------------+----------+-----------------------------------+-------+

示例：{\"SSID\":\"\*\*\*\*\*\*\",\"password\":\"\*\*\*\*\*\*\",\"encrypt\":\"\*\*\*\*\*\*\*\",\"transmission\":\[{\"Radio\":\"2.4G\",\"Index\":1,\"Enable\":1,\"SSID\":\"CMCC-2341\",\"SecurityMode\":\"MIXED-WPAPSK2\",\"Pwd\":\"XXXXXX\"},{\"Radio\":\"5G\",\"Index\":5,\"Enable\":1,\"SSID\":\"CMCC-2341-5G\",\"SecurityMode\":\"MIXED-WPAPSK2\",\"Pwd\":\"XXXXXX\"}\],\"macList\":\[\"mac1\",\"mac2\"\]}

注：

1.  Wi-Fi加密模式枚举值如下：

None

WEP-64

WEP-128

WPA-Personal

WPA2-Personal

MIXED-WPAPSK2

WPA3-SAE

MIXED-WPA2WPA3

## 响应 {#响应-71 .QB标题6}

{"result":1} 表示成功，{"result":0}表示其他异常

## 配网信号强度阈值获取 {#配网信号强度阈值获取 .QB标题5}

## 接口描述 {#接口描述-14 .QB标题6}

IOT设备向组网终端发起配网请求后，组网终端通过如下接口从IOT平台获取对应的配网阈值参数。

请求url：http://cgw.komect.com:443/device/config/get

请求头：Content-Type: application/json

> Accept-Charset: utf-8

Sig*: \*\*\*\*\**

表7.4-84 HTTPS标准包头字段

  ---------------- -------- ----------------------------------- ------------
  参数名           类型     说明                                是否必须

  Sig              String   包头必须带有此参数                  Y

  Accept-Charset   String   客户端响应接收数据格式：utf-8       Y

  Content-Type     String   类型：application/json              Y
  ---------------- -------- ----------------------------------- ------------

请求类型：POST，组网终端-\>家开平台

说明：

1）HTTPS头Sig字段，作为合法性校验信息，Sig=AES（deviceId_productToken_时间戳）

2）时间戳采用当前系统时间（24小时制），格式"yyyyMMddHHmmssmmm"，时间戳单位毫秒，有效期10分钟。

3）deviceId字段为家开平台分配的组网终端ID

4）productToken字段为组网终端在开发者门户注册的产品类型 Token

## 请求 {#请求-72 .QB标题6}

表7.4-85 组网终端获取配网阈值接口请求参数表

  -----------------------------------------------------------------------
  参数名          类型        描述                            是否必须
  --------------- ----------- ------------------------------- -----------
  deviceType      String      组网终端类型码                  Y

  -----------------------------------------------------------------------

示例：

{\"deviceType\":\"30103\"}

## 响应 {#响应-72 .QB标题6}

表7.4-86 组网终端获取配网阈值接口响应

  --------------------------------------------------------------------------------------
  参数名                    类型       描述                                 是否必须
  ------------------------- ---------- ------------------------------------ ------------
  respCode                  Number     响应码，详见附录C-接口响应码         Y

  respCont                  String     响应的返回值                         N

  config                    Object     组网终端配置信息结构                 N

  signalStrengthThreshold   Number     IoT设备无感配网信号强度阈值          Y
  --------------------------------------------------------------------------------------

成功示例：{\"respCode\":0,\"config\":{\"signalStrengthThreshold\":\*\*\*\*}}

失败示例：{\"respCode\": X,\"respCont\": \"XXXXX\"}

## 终端管理数据上报 {#终端管理数据上报 .QB标题4}

## 接口描述 {#接口描述-15 .QB标题5}

组网终端完成设备上线后，依据本接口要求，启动终端管理数据首次上报。后续各上报间隔要求如下图所示；![](media/image43.emf)

## 请求 {#请求-73 .QB标题5}

请求url：[https://{gwIp:port}/device-manage/device/inform/cgwDmReport]()

请求头：Content-Type: application/json

> Accept-Charset: utf-8
>
> dmToken: \*\*\*\*\*

请求类型：POST，组网终端-\>家开平台

表7.4-82 终端管理数据上报请求参数表

+-----------------+----------+---------------------------------+-------+
| 参数名          | 类型     | 描述                            | 是否  |
|                 |          |                                 | 必须  |
+=================+==========+=================================+=======+
| deviceId        | String   | 设备ID                          | Y     |
+-----------------+----------+---------------------------------+-------+
| deviceType      | String   | 设                              | Y     |
|                 |          | 备在开发者门户注册的产品类型码  |       |
+-----------------+----------+---------------------------------+-------+
| timestamp       | Number   | 时间戳，单位毫秒                | Y     |
+-----------------+----------+---------------------------------+-------+
| dmToken         | String   | 终端管理数                      | Y     |
|                 |          | 据上报接口鉴权Token，由平台返回 |       |
+-----------------+----------+---------------------------------+-------+
| firmwareVersion | String   | 固件版本                        | Y     |
+-----------------+----------+---------------------------------+-------+
| softwareVersion | String   | 软件版本                        | Y     |
+-----------------+----------+---------------------------------+-------+
| cmei            | String   | 设备唯一标识                    | Y     |
+-----------------+----------+---------------------------------+-------+
| deviceMac       | String   | 设备WAN口MAC，全大写不带冒号    | Y     |
+-----------------+----------+---------------------------------+-------+
| deviceSn        | String   | 设备SN                          | Y     |
+-----------------+----------+---------------------------------+-------+
| OS              | String   | 操作系统，例如：Linux 2.6.18    | Y     |
+-----------------+----------+---------------------------------+-------+
| cmccVersion     | Object   | 中国移动                        | Y     |
|                 |          | 相关版本号，包含AHSVersion字段  |       |
+-----------------+----------+---------------------------------+-------+
| AHSVersion      | String   | AOS版本号；                     | Y     |
+-----------------+----------+---------------------------------+-------+
| cpuType         | String   | 应用处理器型号，如MT7621A       | Y     |
+-----------------+----------+---------------------------------+-------+
| FlashSize       | Number   | 设备                            | Y     |
|                 |          | 的存储总容量（ROM）大小，单位MB |       |
+-----------------+----------+---------------------------------+-------+
| RamSize         | Number   | 设备                            | Y     |
|                 |          | 的内存总容量（RAM）大小，单位MB |       |
+-----------------+----------+---------------------------------+-------+
| UplinkType      | String   | 当前的上行接入方式(枚举)：      | Y     |
|                 |          |                                 |       |
|                 |          | WLAN                            |       |
|                 |          | 、Ethernet、PLC、Cable、Optical |       |
|                 |          | Ethernet、GPON、XGPON、PoE      |       |
+-----------------+----------+---------------------------------+-------+
| deviceVendor    | String   | 设备制造商                      | Y     |
+-----------------+----------+---------------------------------+-------+
| deviceModel     | String   | 设备型号                        | Y     |
+-----------------+----------+---------------------------------+-------+
| powerSupplyMode | Number   | 供电方式(枚举)：                | Y     |
|                 |          |                                 |       |
|                 |          | 1：电池供电                     |       |
|                 |          |                                 |       |
|                 |          | 2：POE供电                      |       |
|                 |          |                                 |       |
|                 |          | 3：市电供电:                    |       |
|                 |          |                                 |       |
|                 |          | 4：USB供电:                     |       |
|                 |          |                                 |       |
|                 |          | 5：其他供电方式                 |       |
+-----------------+----------+---------------------------------+-------+
| ipAddress       | String   | 组网终端IP信息                  | Y     |
+-----------------+----------+---------------------------------+-------+
| ClientIP        | String   | 设备出口公网IP；                | N     |
+-----------------+----------+---------------------------------+-------+
| wlanMac         | String   | 设备的WLAN                      | N     |
|                 |          | MAC                             |       |
|                 |          | 地址，优先上报5GHz频段MAC地址； |       |
+-----------------+----------+---------------------------------+-------+
| devi            | Json     | 设备管理                        | Y     |
| ceManageExtInfo | object   | 扩展信息，用于后续新增字段扩展  |       |
+-----------------+----------+---------------------------------+-------+

示例：

{\"deviceId\":\"\*\*\*\*\*\",\"deviceType\":\"\*\*\*\*\*\*\",\"timestamp\":1590274859154,\"dmToken\":\"\*\*\*\*\*\*\",\"firmwareVersion\":\"\*\*\*\*\*\",\"softwareVersion\":\"\*\*\*\*\*\",\"cmei\":\"\*\*\*\*\*\",\"deviceMac\":\"\*\*\*\*\*\",\"deviceSn\":\"\*\*\*\*\*\",\"OS\":\"\*\*\*\*\*\",\"cmccVersion\":{\"AHSVersion\":\"\*\*\*\*\*\"},\"cpuType\":\"\*\*\*\",\"FlashSize\":128,\"RamSize\":128,\"UplinkType\":\"\*\*\*\",\"deviceVendor\":\"\*\*\*\",\"deviceModel\":\"\*\*\*\",\"powerSupplyMode\":3,\"ipAddress\":\"\*\*\*\",\"ClientIP\":\"\*\*\*\",\"wlanMac\":\"\*\*\*\",\"deviceManageExtInfo\":{}}

## 响应 {#响应-73 .QB标题5}

表7.4-83 终端管理数据响应参数表

  ------------------------------------------------------------------------
  参数名         类型       描述                               是否必须
  -------------- ---------- ---------------------------------- -----------
  respCode       Number     响应码，0表示成功 其他表示失败     Y

  respCont       String     响应描述                           Y
  ------------------------------------------------------------------------

成功示例：{\"respCode\": X}

失败示例：{\"respCode\": X,\"respCont\": \"XXXXX\"}

## 省份编码获取接口 {#省份编码获取接口 .QB标题4}

## 接口描述 {#接口描述-16 .QB标题5}

接口内容：流程图见5.6.10

请求主url：apconfig.networkorder.komect.com

请求备url：apconfigbak.networkorder.komect.com

HTTPS包头标准如下：

Accept:application/json;

Content-Type:application/json;charset=utf-8; Content-Length:256;

表7.4-84 HTTPS标准包头字段

  -------------- -------- ------------------------------------------ ------------
  参数名         类型     说明                                       是否必须

  Sig            String   包头必须带有此参数                         Y

  Accept         String   客户端响应接收数据格式：application/json   Y

  Content-Type   String   类型：application/json;charset=utf-8       Y

  AuthorToken    String   验证信息                                   Y
  -------------- -------- ------------------------------------------ ------------

请求类型：POST，组网终端 -\> 家开平台

说明：

1）HTTPS头Sig字段，作为合法性校验信息，Sig=MD5（authDevKey+secretkey+时间戳）

2）时间戳采用当前系统时间（24小时制），格式"yyyyMMddHHmmss"。时间戳有效时间为50分钟

3）AuthorToken字段，为包头验证信息，AuthorToken=Base64（authDevKey+冒号+时间戳），采用英文冒号，时间同Sig中时间戳保持一致，authDevKey由IF5平台与端侧设备约定，用于鉴权设备请求合法性。

## 请求 {#请求-74 .QB标题5}

表7.4-85 组网终端获取省份编码接口请求参数表

  -------------------------------------------------------------------------------------------------------
  参数名          类型        描述                                                            是否必须
  --------------- ----------- --------------------------------------------------------------- -----------
  deviceId        String      组网终端ID                                                      Y

  deviceMac       String      组网终端铭牌MAC地址，推荐使用WAN口MAC，格式为不带冒号并且大写   Y

  deviceType      String      产品类型；                                                      Y

  timestamp       Number      时间戳，单位：毫秒；                                            Y

  deviceVendor    String      厂商编码                                                        Y

  deviceModel     String      型号编码                                                        Y

  deviceSn        String      SN                                                              Y

  cmei            String      组网终端CMEI                                                    Y
  -------------------------------------------------------------------------------------------------------

示例：

{\"deviceId\":\"CMCC-30103-AABBCCDDEEFF\",\"deviceMac\":\"AABBCCDDEEFF\",\"deviceType\":\"30103\",\"timestamp\":1641523029678,\"deviceVendor\":\"01\",\"deviceModel\":\"1101\",\"deviceSn\":\"011101\*\*\*\*\*\*\*\*\*\",\"cmei\":\"111\*\*\*\*\*\*\*\*\*\*\*\*\"}

## 响应 {#响应-74 .QB标题5}

表7.4-86 组网终端获取省份编码接口响应

  ---------------------------------------------------------------------------
  参数名         类型       描述                                 是否必须
  -------------- ---------- ------------------------------------ ------------
  respCode       Number     响应码，详见附录C-接口响应码         Y

  respCont       String     响应的返回值                         N

  provinceCode   String     组网终端省份信息，成功响应时必选     N
  ---------------------------------------------------------------------------

成功示例：

{\"respCode\":1, \"provinceCode\":\"ZHJ\"}

失败示例：

{\"respCode\":5000,\"respCont\":\"Parameter Error\"}

当设备未在家开平台完成入库调拨流程时，家开平台无对应省码数据，返回如下响应

{\"respCode\":5001,\"respCont\":\"No Data\"}

##  {#section .QB标题5}

##  {#section-1 .QB标题5}

## 组网终端与家宽优选业务平台交互接口定义 {#组网终端与家宽优选业务平台交互接口定义 .QB标题2}

## 接口描述 {#接口描述-17 .QB标题3}

表7.5-1 组网终端与家宽优选业务平台交互接口汇总

  ---------- ---------------------------------------------- ---------------
  接口ID     接口说明                                       接口方向

  7.5.2.1    管理插件获取订购信息接口                       设备\>平台

  7.5.2.2    基础通信模块上报设备信息接口                   设备\>平台

  7.5.2.3    基础通信模块心跳接口                           设备\>平台

  7.5.2.4    基础通信模块日志文件上传接口                   设备\>平台

  7.5.2.5    MQTT消息开启和关闭电竞/教育加速                平台\>设备

  7.5.2.6    MQTT消息获取电竞加速设备列表                   平台\>设备

  7.5.2.7    MQTT消息设置路由器路由模式                     平台\>设备

  7.5.2.8    MQTT消息获取路由器路由、桥接模式               平台\>设备

  7.5.2.9    MQTT消息获取电竞、教育加速状态                 平台\>设备

  7.5.2.10   MQTT消息教育加速更新配置                       平台\>设备

  7.5.2.11   MQTT消息通知绿色上网更新管控策略               平台\>设备

  7.5.2.12   MQTT消息返回用户业务订购状态                   平台\>设备

  7.5.2.13   MQTT消息设备重启                               平台\>设备

  7.5.2.14   绿色上网服务配置更新                           平台\>设备

  7.5.2.15   绿色上网服务管控策略更新                       平台\>设备

  7.5.2.16   绿色上网服务数据上报                           设备\>平台

  7.5.2.17   教育加速插件获取配置轮询间隔请求               设备\>平台

  7.5.2.18   教育加速更新国内流量卸载IP库请求               设备\>平台

  7.5.2.19   教育加速获取平台侧设备加速状态信息请求         设备\>平台

  7.5.2.20   教育加速获取教育加速默认配置default.conf请求   设备\>平台

  7.5.2.21   教育加速获取教育加速自定义配置self.conf        设备\>平台

  7.5.2.22   教育加速开启教育加速请求                       平台\>设备

  7.5.2.23   教育加速停止教育加速请求                       平台\>设备

  7.5.2.24   教育加速插件从平台拉取加速状态请求             平台\>设备
  ---------- ---------------------------------------------- ---------------

## 接口详细定义 {#接口详细定义-2 .QB标题3}

## 管理插件获取订购信息接口 {#管理插件获取订购信息接口 .QB标题4}

## 接口描述 {#接口描述-18 .QB标题5}

接口内容：通过轮循的方式获取插件的下载包地址，轮循时间通过接口返回值获取。

请求url：http://sp.aifast.komect.com:80/portal/acc/getOwnPkg

请求头：Content-Type: application/x-www-form-urlencoded

> Accept-Charset: utf-8

请求类型：HTTP、POST

## 请求 {#请求-75 .QB标题5}

表7.5-2组网终端家宽优选管理插件获取订购信息更新请求参数表

  ---------- -------- ----------------------------------------------------------------------- -----------
  参数名     类型     描述                                                                    是否必须

  g          String   组网终端铭牌MAC地址，推荐使用WAN口MAC，格式为不带冒号且大写；（下同）   Y

  f          String   设备剩余内存，单位KB                                                    Y

  t          String   设备型号编码，使用中国移动分配的设备型号编码；                          Y

  s          String   设备SN；                                                                Y

  p          String   省份编码；                                                              Y

  va         String   基础插件版本号                                                          N

  ve         String   教育插件版本号                                                          N

  vg         String   电竞插件版本号                                                          N

  vs         String   绿色上网版本号                                                          N

  voa        String   预留                                                                    N

  vob        String   预留                                                                    N

  i          String   首次轮循标志，1：首次，0：非首次；                                      Y

  sw         String   组网终端软件版本                                                        N
  ---------- -------- ----------------------------------------------------------------------- -----------

请求示例：

{\"g\":\"3010B39AF717\",\"f\":\"32\",\"t\":\"1101\",\"s\":\"011101\*\*\*\*\*\*\*\*\*\",\"p\":\"ZHJ\",\"va\":\"1.3.5\",\"ve\":\"1.3.5\",\"vg\":\"1.3.5\",\"vs\":\"1.3.5\",\"voa\":\"1.3.5\",\"vob\":\"1.3.5\",\"i\":\"0\",\"sw\":\"V3.2\"}

## 响应 {#响应-75 .QB标题5}

表7.5-3 组网终端家宽优选管理插件获取订购信息更新请求参数表

+------+-------+-------------------------------------------+----------+
| 参   | 类型  | 描述                                      | 是否必须 |
| 数名 |       |                                           |          |
+------+-------+-------------------------------------------+----------+
| rs   | N     | 请求结果；0：请求成功，非0：请求失败；    | Y        |
|      | umber |                                           |          |
+------+-------+-------------------------------------------+----------+
| p    | S     | 下次轮循时间，单位秒；                    | Y        |
|      | tring |                                           |          |
+------+-------+-------------------------------------------+----------+
| s    | S     | 休眠时间，单位秒，首次有值，后续为0       | Y        |
|      | tring | 。轮询时间+休眠时间为每次请求的间隔时间。 |          |
+------+-------+-------------------------------------------+----------+
| m    | Array | 用户订购业务                              | Y        |
|      |       | 的插件包下载信息数组；包含订购标志位、下  |          |
|      |       | 载路径、单个插件包下载信息、插件包名称、  |          |
|      |       | 插件包MD5值、插件包版本、插件包大小信息； |          |
+------+-------+-------------------------------------------+----------+
| c    | S     | 插件对应状态                              | Y        |
|      | tring | 码；4001：基础管理插件；4003：教育插件；4 |          |
|      |       | 005：电竞插件；4007：绿色上网插件；4009： |          |
|      |       | 预留插件1（voa）；4011：预留插件2（vob）  |          |
+------+-------+-------------------------------------------+----------+
| h    | S     | 订购                                      | Y        |
|      | tring | 标志位，枚举取值；1：订购，0：未订购/退订 |          |
+------+-------+-------------------------------------------+----------+
| d    | O     | 单个插件包的下载信息，包含插件            | N        |
|      | bject | 包名称、插件包MD5值、插件包版本、插件包大 |          |
|      |       | 小信息；如果用户没有订购，则没有此字段。  |          |
+------+-------+-------------------------------------------+----------+
| r    | S     | 下载路径：http://xxxx:xxx/c               | N        |
|      | tring | mhy-JKYX_1.0.9_2.2.tar.gz：正常情况，返回 |          |
|      |       | 下载路径；PKGSIZE_OUT_OF_MAX_USEFUL_MEMOR |          |
|      |       | Y：设备剩余内存过小，不够下载解压插件包； |          |
|      |       |                                           |          |
|      |       | null：管理平台上未上传插件包              |          |
+------+-------+-------------------------------------------+----------+
| n    | S     | 插件包名称                                | N        |
|      | tring |                                           |          |
+------+-------+-------------------------------------------+----------+
| m    | S     | 插件包MD5值                               | N        |
|      | tring |                                           |          |
+------+-------+-------------------------------------------+----------+
| p    | S     | 插件包版本                                | N        |
|      | tring |                                           |          |
+------+-------+-------------------------------------------+----------+
| ts   | S     | 插件包大小，单位KB                        | N        |
|      | tring |                                           |          |
+------+-------+-------------------------------------------+----------+

响应示例：

{\"rs\":0,\"p\":\"100\",\"s\":\"409\",\"m\":\[{\"c\":\"4003\",\"h\":\"0\"},{\"c\":\"4005\",\"h\":\"0\"},{\"c\":\"4007\",\"h\":\"0\"},{\"c\":\"4009\",\"h\":\"0\"},{\"c\":\"4011\",\"h\":\"0\"},{\"c\":\"4001\",\"h\":\"1\",\"d\":{\"r\":\"http://xxxx:xxx/cmhy-JKYX_1.0.9_2.2.tar.gz\",\"n\":\"cmhy-JKYX_1.0.9_2.2.tar.gz\",\"m\":\"15565bd33edad59cad20c69bb342c965\",\"p\":\"1.0.9\",\"fs\":\"2728\"}}\]}

## 基础通信模块上报设备信息接口 {#基础通信模块上报设备信息接口 .QB标题4}

## 接口描述 {#接口描述-19 .QB标题5}

接口描述：以轮循的方式上报设备信息给家宽优选管理平台。轮循时间通过接口的返回值获取，上报的设备信息主要包括设备MAC、运行的业务插件版本和业务模块的运行状态。

请求url：http://sp.aifast.komect.com:80/portal/acc/gatewayInfo

请求头：Content-Type: application/x-www-form-urlencoded

Accept-Charset: utf-8

请求类型：HTTPS、POST

## 请求 {#请求-76 .QB标题5}

表7.5-4组网终端家宽优选上报设备信息接口更新请求参数表

+-----------+-------+--------------------------------------+----------+
| 参数名    | 类型  | 描述                                 | 是否必须 |
+-----------+-------+--------------------------------------+----------+
| g         | S     | 设备背签MAC                          | Y        |
| atewayMac | tring |                                      |          |
+-----------+-------+--------------------------------------+----------+
| d         | S     | 设备类型                             | Y        |
| eviceType | tring |                                      |          |
+-----------+-------+--------------------------------------+----------+
| sn        | S     | 设备SN                               | Y        |
|           | tring |                                      |          |
+-----------+-------+--------------------------------------+----------+
| firmVer   | S     | 组网终端软件版本                     | Y        |
|           | tring |                                      |          |
+-----------+-------+--------------------------------------+----------+
| resMem    | S     | 剩余内存，单位KB                     | Y        |
|           | tring |                                      |          |
+-----------+-------+--------------------------------------+----------+
| majorVer  | S     | 家宽优选插件版本号，读取文件accctr   | Y        |
|           | tring | lPkginfo.list中的version字段。业务插 |          |
|           |       | 件下载后，文件默认解压在/tmp文件夹下 |          |
+-----------+-------+--------------------------------------+----------+
| c         | S     | 通信模                               | Y        |
| trlStatus | tring | 块状态，枚举取值；1：运行，0：未运行 |          |
+-----------+-------+--------------------------------------+----------+
| qmStatus  | S     | 电竞模                               | Y        |
|           | tring | 块状态，枚举取值；1：运行，0：未运行 |          |
+-----------+-------+--------------------------------------+----------+
| eduStatus | S     | 教育模                               | Y        |
|           | tring | 块状态，枚举取值；1：运行，0：未运行 |          |
+-----------+-------+--------------------------------------+----------+
| gr        | S     | 绿色上                               | Y        |
| eenStatus | tring | 网状态，枚举取值；1：运行，0：未运行 |          |
+-----------+-------+--------------------------------------+----------+
| mode      | S     | 设备模式，枚举取值；                 | Y        |
|           | tring |                                      |          |
|           |       | router：路由模式；                   |          |
|           |       |                                      |          |
|           |       | bridge：桥接模式                     |          |
+-----------+-------+--------------------------------------+----------+
| i         | S     | 当前是否有电竞流量，枚举取值；       | Y        |
| dleStatus | tring |                                      |          |
|           |       | IDLE：无电竞流量；                   |          |
|           |       |                                      |          |
|           |       | BUSY：有电竞流量；                   |          |
|           |       |                                      |          |
|           |       | 空：不确定                           |          |
+-----------+-------+--------------------------------------+----------+

请求示例：

{\"extraInfo\":{\"deviceType\":\"H2-3\",\"sn\":\"011101\*\*\*\*\*\*\*\*\*\",\"firmVer\":\"V3.2\",\"resMem\":\"32768\",\"majorVer\":\"1.0.0\",\"ctrlStatus\":\"1\",\"qmStatus\":\"1\",\"eduStatus\":\"1\",\"greenStatus\":\"1\",\"mode\":\"router\",\"idleStatus\":\"\"}}

## 响应 {#响应-76 .QB标题5}

表7.5-5 组网终端家宽优选上报设备信息接口更新响应参数表

  ----------- -------- ---------------------------------------- -----------
  参数名      类型     描述                                     是否必须

  无字段      Number   非JSON格式，下次上报轮循时间，单位为秒   Y
  ----------- -------- ---------------------------------------- -----------

响应示例：

  -----------------------------------------------------------------------
  1800

  -----------------------------------------------------------------------

## 基础通信模块心跳接口 {#基础通信模块心跳接口 .QB标题4}

## 接口描述 {#接口描述-20 .QB标题5}

接口描述：心跳接口，通过轮循方式获取是否需要回传日志文件的标志位，轮循时间从接口的返回值内获取。

请求url：http://sp.aifast.komect.com:80/integration/heart

请求头：Content-Type: application/json

> Accept-Charset: utf-8

请求类型：HTTPS、POST

## 请求 {#请求-77 .QB标题5}

表7.5-6 组网终端家宽优选业务心跳接口更新请求参数表

  ----------- -------- -------------------------------------- -----------
  参数名      类型     描述                                   是否必须

  mac         String   设备背签MAC                            Y

  type        Number   类型：固定为1；                        Y

  ts          Number   时间戳，采用毫秒时间戳                 Y

  source      Number   标志位，默认为"1"，代表基础通信        Y
  ----------- -------- -------------------------------------- -----------

请求示例：{\"mac\":\"8C53D2FA1729\",\"type\":1,\"ts\":1640072486763,\"source\":1}

## 响应 {#响应-77 .QB标题5}

表7.5-7 组网终端家宽优选业务心跳接口更新响应参数表

+---------+------+----------------------------------------+----------+
| 参数名  | 类型 | 描述                                   | 是否必须 |
+---------+------+----------------------------------------+----------+
| status  | Nu   | 返回状态码，枚举取值：                 | Y        |
|         | mber |                                        |          |
|         |      | 100：成功；非100：失败；               |          |
+---------+------+----------------------------------------+----------+
| message | St   | 返回状态，枚举取值：                   | Y        |
|         | ring |                                        |          |
|         |      | success：成功；非success：失败；       |          |
+---------+------+----------------------------------------+----------+
| result  | Ob   | 日志上报标志及下次轮                   | Y        |
|         | ject | 询时间，内容包含cycle、reportType字段  |          |
+---------+------+----------------------------------------+----------+
| cycle   | Nu   | 下次请求时间，单位秒                   | Y        |
|         | mber |                                        |          |
+---------+------+----------------------------------------+----------+
| rep     | St   | 日志上                                 | Y        |
| ortType | ring | 报标志位，枚举取值；1：上报；0：不上报 |          |
+---------+------+----------------------------------------+----------+

返回示例：{\"status\":100,\"message\":\"success\",\"result\":{\"cycle\":900,\"reportType\":\"1
\"}}

## 基础通信模块日志文件上传接口 {#基础通信模块日志文件上传接口 .QB标题4}

## 接口描述 {#接口描述-21 .QB标题5}

接口描述：将设备里业务插件运行生成的日志文件，上传到云服务器。

请求url：[http://sp.aifast.komect.com:80/portal/acc/plugin/logUpload/\${mac}](http://sp.aifast.komect.com:80/portal/acc/plugin/logUpload/$%7bmac%7d)

请求头：Content-Type: application/json

> Accept-Charset: utf-8

请求类型：HTTPS、POST

## 请求 {#请求-78 .QB标题5}

请求示例：

  -----------------------------------------------------------------------
  ./bp_2021-12-20_11-56-53.log

  -----------------------------------------------------------------------

## 响应 {#响应-78 .QB标题5}

返回示例：

  -----------------------------------------------------------------------
  group1/M00/00/D9/rBUrz2HBk_WAengaABABsC0T19k768.log

  -----------------------------------------------------------------------

说明：平台返回的是字符串，为平台存储上传日志的路径位置加文件名

## MQTT消息开启和关闭电竞/教育加速 {#mqtt消息开启和关闭电竞教育加速 .QB标题4}

> 连接MQTT服务器的时候，keepAliveTime
> 默认设置为60秒。MQTT连接地址为ssl://aifastlink.komect.com:1883。无连接账号，使用证书验证，证书由智家中心提供。重连机制为断网后重连，重连间隔时间1秒。下同。

## 接口描述 {#接口描述-22 .QB标题5}

接口描述：开启/关闭 电竞/教育加速

订阅/发布url：ssl://aifastlink.komect.com:1883

消息类型：mqtt

## 订阅 {#订阅 .QB标题5}

表7.5-8组网终端家宽优选业务开启、关闭电竞、教育加速更新订阅参数表

+----------------+--------+--------------------------------+----------+
| 参数名         | 类型   | 描述                           | 是否必须 |
+----------------+--------+--------------------------------+----------+
| MsgList        | Array  | 已订阅MQTT消息体。             | Y        |
+----------------+--------+--------------------------------+----------+
| data           | Object | 解析数据包                     | Y        |
+----------------+--------+--------------------------------+----------+
| gameid         | String | 加速的电竞id；默认为空         | Y        |
|                |        | 字符串：默认加速支持的所有游戏 |          |
+----------------+--------+--------------------------------+----------+
| node           | String | 电竞加速节点，枚举取值；       | Y        |
|                |        |                                |          |
|                |        | HongKong：香港，               |          |
|                |        |                                |          |
|                |        | Japan，日本，                  |          |
|                |        |                                |          |
|                |        | Europe，欧洲，                 |          |
|                |        |                                |          |
|                |        | Australia，澳洲，              |          |
|                |        |                                |          |
|                |        | Korea：韩国，                  |          |
|                |        |                                |          |
|                |        | Guofu，国服                    |          |
+----------------+--------+--------------------------------+----------+
| mac_address    | String | 电竞加速设备MAC                | Y        |
+----------------+--------+--------------------------------+----------+
| netInfo        | String | 教育加速节                     | Y        |
|                |        | 点信息，由北办加速网络平台提供 |          |
+----------------+--------+--------------------------------+----------+
| ip             | String | 电竞加速设备IP                 | Y        |
+----------------+--------+--------------------------------+----------+
| action         | String | 操作说明，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | control:加速/停止加速，        |          |
|                |        |                                |          |
|                |        | getDevice                      |          |
|                |        | sList：获取下挂设备列表，getSt |          |
|                |        | atus：获取教育/电竞加速状态，u |          |
|                |        | pdateConfig:教育加速更新配置， |          |
|                |        |                                |          |
|                |        | gnConfig:通知绿色              |          |
|                |        | 上网更新管控策略，serviceStat  |          |
|                |        | us：通知平台返回用户订购状态， |          |
|                |        |                                |          |
|                |        | reboot:重启设备                |          |
+----------------+--------+--------------------------------+----------+
| accType        | String | 业务类型，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | 0：电竞加速，                  |          |
|                |        |                                |          |
|                |        | 1：教育加速，                  |          |
|                |        |                                |          |
|                |        | 2：绿色上网                    |          |
+----------------+--------+--------------------------------+----------+
| userid         | String | 用                             | Y        |
|                |        | 户id，家宽优选平台生成的用户id |          |
+----------------+--------+--------------------------------+----------+
| accStatus      | String | 加速/停止加速，枚举取值；      | Y        |
|                |        |                                |          |
|                |        | acc：加速，                    |          |
|                |        |                                |          |
|                |        | stop：停止加速                 |          |
+----------------+--------+--------------------------------+----------+
| reqid          | String | 请求                           | Y        |
|                |        | id，平台为每条消息生成的id标志 |          |
+----------------+--------+--------------------------------+----------+
| msgtype        | String | 消息类型，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | 3001：加速/停止加速，          |          |
|                |        |                                |          |
|                |        | 3005：获取电竞加速设备列表，   |          |
|                |        |                                |          |
|                |        | 3011：设置路由器为路由模式，   |          |
|                |        |                                |          |
|                |        | 301                            |          |
|                |        | 3：获取路由器的路由/桥接模式， |          |
|                |        |                                |          |
|                |        | 3015：获取电竞/教育加速状态，  |          |
|                |        |                                |          |
|                |        | 3017：教育加速更新配置，       |          |
|                |        |                                |          |
|                |        | 30                             |          |
|                |        | 19：通知绿色上网更新管控策略， |          |
|                |        |                                |          |
|                |        | 3021：                         |          |
|                |        | 通知平台返回用户业务订购状态， |          |
|                |        |                                |          |
|                |        | 3023：重启设备                 |          |
+----------------+--------+--------------------------------+----------+
| Result         | Number | 结果，枚举取值；               | Y        |
|                |        |                                |          |
|                |        | 0：成功，                      |          |
|                |        |                                |          |
|                |        | 非0：失败                      |          |
+----------------+--------+--------------------------------+----------+

订阅消息示例：

{\"MsgList\":\[{\"data\":{\"gameid\":\"\",\"node\":\"HongKong\",\"mac_address\":\"AABBCCDDEEFF\",\"netInfo\":\"xxxxxxxxxxxxxxxxxxxxx\",\"ip\":\"192.168.1.3\",\"action\":\"control\",\"accType\":\"1\",\"userid\":\"1143987197297299518\",\"accStatus\":\"acc\",\"reqid\":\"880239564\"},\"msgtype\":\"3001\"}\],\"Result\":0}

## 发布 {#发布 .QB标题5}

表7.5-9 组网终端家宽优选业务开启、关闭电竞、教育加速更新发布参数表

+----------------+--------+--------------------------------+----------+
| 参数名         | 类型   | 描述                           | 是否必须 |
+----------------+--------+--------------------------------+----------+
| do             | String | 加速/停止加速，枚举取值；      | Y        |
|                |        |                                |          |
|                |        | acc：开启加速；stop：停止加速  |          |
+----------------+--------+--------------------------------+----------+
| reqid          | Number | 请求id                         | Y        |
+----------------+--------+--------------------------------+----------+
| ret_msg        | String | 执行结果，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | success：成功；非success：失败 |          |
+----------------+--------+--------------------------------+----------+
| result         | String | 执行结果，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | success：成功；非success：失败 |          |
+----------------+--------+--------------------------------+----------+
| accType        | String | 业务类型，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | 0：电竞加速，                  |          |
|                |        |                                |          |
|                |        | 1：教育加速，                  |          |
|                |        |                                |          |
|                |        | 2：绿色上网                    |          |
+----------------+--------+--------------------------------+----------+
| ret_code       | Number | 返回码，枚举取值；             | Y        |
|                |        |                                |          |
|                |        | 0：成功；非0：失败             |          |
+----------------+--------+--------------------------------+----------+
| action         | String | 操作说明，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | control:加速/停止加速，        |          |
|                |        |                                |          |
|                |        | getDevice                      |          |
|                |        | sList：获取下挂设备列表，getSt |          |
|                |        | atus：获取教育/电竞加速状态，u |          |
|                |        | pdateConfig:教育加速更新配置， |          |
|                |        |                                |          |
|                |        | gnConfig:通知绿色              |          |
|                |        | 上网更新管控策略，serviceStat  |          |
|                |        | us：通知平台返回用户订购状态， |          |
|                |        |                                |          |
|                |        | reboot:重启设备                |          |
+----------------+--------+--------------------------------+----------+

发布消息示例：

{\"do\":\"acc\",\"reqid\":880239564,\"ret_msg\":\"success\",\"result\":\"success\",\"accType\":\"1\",\"ret_code\":0,\"action\":\"control\"}

## MQTT消息获取电竞加速设备列表 {#mqtt消息获取电竞加速设备列表 .QB标题4}

## 接口描述 {#接口描述-23 .QB标题5}

接口描述：获取电竞加速设备列表

订阅/发布url：ssl://aifastlink.komect.com:1883

消息类型：mqtt

## 订阅 {#订阅-1 .QB标题5}

表7.5-10 组网终端家宽优选业务获取电竞加速设备列表订阅参数表

+----------------+--------+--------------------------------+----------+
| 参数名         | 类型   | 描述                           | 是否必须 |
+----------------+--------+--------------------------------+----------+
| MsgList        | Array  | 已订阅MQTT消息体。             | Y        |
+----------------+--------+--------------------------------+----------+
| data           | Object | 解析数据包                     | Y        |
+----------------+--------+--------------------------------+----------+
| action         | String | 操作说明，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | control:加速/停止加速，        |          |
|                |        |                                |          |
|                |        | getDevice                      |          |
|                |        | sList：获取下挂设备列表，getSt |          |
|                |        | atus：获取教育/电竞加速状态，u |          |
|                |        | pdateConfig:教育加速更新配置， |          |
|                |        |                                |          |
|                |        | gnCon                          |          |
|                |        | fig:通知绿色上网更新管控策略， |          |
|                |        |                                |          |
|                |        | serviceStatus：通知平台        |          |
+----------------+--------+--------------------------------+----------+
| accType        | String | 业务类型，枚举取值；           |          |
|                |        |                                |          |
|                |        | 0：电竞加速，                  |          |
|                |        |                                |          |
|                |        | 1：教育加速，                  |          |
|                |        |                                |          |
|                |        | 2：绿色上网                    |          |
+----------------+--------+--------------------------------+----------+
| userid         | String | 用                             | Y        |
|                |        | 户id，家宽优选平台生成的用户id |          |
+----------------+--------+--------------------------------+----------+
| reqid          | String | 请求                           | Y        |
|                |        | id，平台为每条消息生成的id标志 |          |
+----------------+--------+--------------------------------+----------+
| msgtype        | String | 消息类型，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | 3001：加速/停止加速，          |          |
|                |        |                                |          |
|                |        | 3005：获取电竞加速设备列表，   |          |
|                |        |                                |          |
|                |        | 3011：设置路由器为路由模式，   |          |
|                |        |                                |          |
|                |        | 301                            |          |
|                |        | 3：获取路由器的路由/桥接模式， |          |
|                |        |                                |          |
|                |        | 3015：获取电竞/教育加速状态，  |          |
|                |        |                                |          |
|                |        | 3017：教育加速更新配置，       |          |
|                |        |                                |          |
|                |        | 30                             |          |
|                |        | 19：通知绿色上网更新管控策略， |          |
|                |        |                                |          |
|                |        | 3021：                         |          |
|                |        | 通知平台返回用户业务订购状态， |          |
|                |        |                                |          |
|                |        | 3023：重启设备                 |          |
+----------------+--------+--------------------------------+----------+
| Result         | Number | 结果，枚举取值；               | Y        |
|                |        |                                |          |
|                |        | 0：成功； 非0：失败            |          |
+----------------+--------+--------------------------------+----------+

订阅消息示例：

{\"MsgList\":\[{\"data\":{\"action\":\"getDevicesList\",\"accType\":\"0\",\"userid\":\"1143987197297299518\",\"reqid\":\"510481777\"},\"msgtype\":\"3005\"}\],\"Result\":0}

## 发布 {#发布-1 .QB标题5}

表7.5-11 组网终端家宽优选业务获取电竞加速设备列表发布参数表

+----------------+--------+--------------------------------+----------+
| 参数名         | 类型   | 描述                           | 是否必须 |
+----------------+--------+--------------------------------+----------+
| action         | String | 操作说明，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | control:加速/停止加速，        |          |
|                |        |                                |          |
|                |        | getD                           |          |
|                |        | evicesList：获取下挂设备列表， |          |
|                |        |                                |          |
|                |        | getS                           |          |
|                |        | tatus：获取教育/电竞加速状态， |          |
|                |        |                                |          |
|                |        | u                              |          |
|                |        | pdateConfig:教育加速更新配置， |          |
|                |        |                                |          |
|                |        | gnCon                          |          |
|                |        | fig:通知绿色上网更新管控策略， |          |
|                |        |                                |          |
|                |        | serviceStat                    |          |
|                |        | us：通知平台返回用户订购状态， |          |
|                |        |                                |          |
|                |        | reboot:重启设备                |          |
+----------------+--------+--------------------------------+----------+
| device         | Array  | 下挂设备信息                   | Y        |
+----------------+--------+--------------------------------+----------+
| name           | String | 下挂设备名称                   | Y        |
+----------------+--------+--------------------------------+----------+
| ip             | String | 下挂设备ip                     | Y        |
+----------------+--------+--------------------------------+----------+
| mac            | String | 下挂设备MAC                    | Y        |
+----------------+--------+--------------------------------+----------+
| status         | String | 下                             | Y        |
|                |        | 挂设备电竞加速状态，枚举取值； |          |
|                |        |                                |          |
|                |        | start：加速状态，              |          |
|                |        |                                |          |
|                |        | stop：未加速状态               |          |
+----------------+--------+--------------------------------+----------+
| time           | String | 开启加速时间点，时间戳         |          |
+----------------+--------+--------------------------------+----------+
| userid         | String | 用                             | Y        |
|                |        | 户id，家宽优选平台生成的用户id |          |
+----------------+--------+--------------------------------+----------+
| region         | String | 电竞加速节点，枚举取值；       | Y        |
|                |        |                                |          |
|                |        | HongKong：香港，               |          |
|                |        |                                |          |
|                |        | Japan，日本，                  |          |
|                |        |                                |          |
|                |        | Europe，欧洲，                 |          |
|                |        |                                |          |
|                |        | Australia，澳洲，              |          |
|                |        |                                |          |
|                |        | Korea：韩国，                  |          |
|                |        |                                |          |
|                |        | Guofu，国服                    |          |
+----------------+--------+--------------------------------+----------+
| online         | String | 是否在线，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | onion：在线；离线：offline     |          |
+----------------+--------+--------------------------------+----------+
| vendor         | String | 供应商，目前为空               | Y        |
+----------------+--------+--------------------------------+----------+
| type           | Number | 设备类型，目前默认为0          | Y        |
+----------------+--------+--------------------------------+----------+
| idle           | Number | 是否有电竞加速流量，枚举取值； | Y        |
|                |        |                                |          |
|                |        | 0：当前有电竞加速流量，        |          |
|                |        |                                |          |
|                |        | 1：当前无电竞加速流量          |          |
+----------------+--------+--------------------------------+----------+
| region         | String | 电竞加速节点，枚举取值；       | Y        |
|                |        |                                |          |
|                |        | HongKong：香港，               |          |
|                |        |                                |          |
|                |        | Japan，日本，                  |          |
|                |        |                                |          |
|                |        | Europe，欧洲，                 |          |
|                |        |                                |          |
|                |        | Australia，澳洲，              |          |
|                |        |                                |          |
|                |        | Korea：韩国，                  |          |
|                |        |                                |          |
|                |        | Guofu，国服                    |          |
+----------------+--------+--------------------------------+----------+
| ret_code       | Number | 返回码，枚举取值；             | Y        |
|                |        |                                |          |
|                |        | 0：执行成功；非0：执行失败     |          |
+----------------+--------+--------------------------------+----------+
| reqid          | Number | 请求id                         | Y        |
+----------------+--------+--------------------------------+----------+

发布消息示例：

{\"action\":\"getDevicesList\",\"device\":\[{\"name\":\"\",\"ip\":\"192.168.1.2\",\"mac\":\"1062E552B9E9\",\"status\":\"start\",\"gameid\":\"\",\"time\":\"1640137824\",\"userid\":\"8c53d2fa1729\",\"region\":\"American\",\"online\":\"online\",\"vendor\":\"\",\"type\":0}\],\"idle\":1,\"region\":\"American\",\"ret_code\":0,\"reqid\":510481777}

## MQTT消息设置路由器路由模式 {#mqtt消息设置路由器路由模式 .QB标题4}

## 接口描述 {#接口描述-24 .QB标题5}

接口描述：设置路由器路由模式

订阅/发布url：ssl://aifastlink.komect.com:1883

消息类型：mqtt

## 订阅 {#订阅-2 .QB标题5}

表7.5-12 组网终端家宽优选业务设置路由器路由模式订阅参数表

+----------------+--------+--------------------------------+----------+
| 参数名         | 类型   | 描述                           | 是否必须 |
+----------------+--------+--------------------------------+----------+
| MsgList        | Array  | 已订阅MQTT消息体。             | Y        |
+----------------+--------+--------------------------------+----------+
| data           | Object | 解析数据包                     | Y        |
+----------------+--------+--------------------------------+----------+
| reqid          | String | 请求                           | Y        |
|                |        | id，平台为每条消息生成的id标志 |          |
+----------------+--------+--------------------------------+----------+
| workMode       | String | 路由器模式；                   | Y        |
|                |        |                                |          |
|                |        | router：路由模式               |          |
+----------------+--------+--------------------------------+----------+
| msgtype        | String | 消息类型，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | 3001：加速/停止加速，          |          |
|                |        |                                |          |
|                |        | 3005：获取电竞加速设备列表，   |          |
|                |        |                                |          |
|                |        | 3011：设置路由器为路由模式，   |          |
|                |        |                                |          |
|                |        | 301                            |          |
|                |        | 3：获取路由器的路由/桥接模式， |          |
|                |        |                                |          |
|                |        | 3015：获取电竞/教育加速状态，  |          |
|                |        |                                |          |
|                |        | 3017：教育加速更新配置，       |          |
|                |        |                                |          |
|                |        | 30                             |          |
|                |        | 19：通知绿色上网更新管控策略， |          |
|                |        |                                |          |
|                |        | 3021：                         |          |
|                |        | 通知平台返回用户业务订购状态， |          |
|                |        |                                |          |
|                |        | 3023：重启设备                 |          |
+----------------+--------+--------------------------------+----------+
| Result         | Number | 结果，枚举取值；               | Y        |
|                |        |                                |          |
|                |        | 0：成功，                      |          |
|                |        |                                |          |
|                |        | 非0：失败                      |          |
+----------------+--------+--------------------------------+----------+

发布消息参数：无消息返回

订阅消息示例：

{\"MsgList\":\[{\"data\":{\"reqid\":\"340939171\",\"workMode\":\"router\"},\"msgtype\":\"3011\"}\],\"Result\":0}

## MQTT消息获取路由器路由、桥接模式 {#mqtt消息获取路由器路由桥接模式 .QB标题4}

## 接口描述 {#接口描述-25 .QB标题5}

接口描述：获取路由器路由、桥接模式

订阅/发布url：ssl://aifastlink.komect.com:1883

消息类型：mqtt

## 订阅 {#订阅-3 .QB标题5}

表7.5-13 组网终端家宽优选业务获取路由器路由、桥接模式订阅参数表

+----------------+--------+--------------------------------+----------+
| 参数名         | 类型   | 描述                           | 是否必须 |
+----------------+--------+--------------------------------+----------+
| MsgList        | Array  | 已订阅MQTT消息体。             | Y        |
+----------------+--------+--------------------------------+----------+
| data           | Object | 解析数据包                     | Y        |
+----------------+--------+--------------------------------+----------+
| reqid          | String | 请求                           | Y        |
|                |        | id，平台为每条消息生成的id标志 |          |
+----------------+--------+--------------------------------+----------+
| msgtype        | String | 消息类型，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | 3001：加速/停止加速，          |          |
|                |        |                                |          |
|                |        | 3005：获取电竞加速设备列表，   |          |
|                |        |                                |          |
|                |        | 3011：设置路由器为路由模式，   |          |
|                |        |                                |          |
|                |        | 301                            |          |
|                |        | 3：获取路由器的路由/桥接模式， |          |
|                |        |                                |          |
|                |        | 3015：获取电竞/教育加速状态，  |          |
|                |        |                                |          |
|                |        | 3017：教育加速更新配置，       |          |
|                |        |                                |          |
|                |        | 30                             |          |
|                |        | 19：通知绿色上网更新管控策略， |          |
|                |        |                                |          |
|                |        | 3021：                         |          |
|                |        | 通知平台返回用户业务订购状态， |          |
|                |        |                                |          |
|                |        | 3023：重启设备                 |          |
+----------------+--------+--------------------------------+----------+
| Result         | Number | 结果，枚举取值；               | Y        |
|                |        |                                |          |
|                |        | 0：成功，                      |          |
|                |        |                                |          |
|                |        | 非0：失败                      |          |
+----------------+--------+--------------------------------+----------+

订阅消息示例：

{\"MsgList\":\[{\"data\":{\"reqid\":\"340939171\"},\"msgtype\":\"3013\"}\],\"Result\":0}

## 发布 {#发布-2 .QB标题5}

表7.5-14 组网终端家宽优选业务获取路由器路由、桥接模式发布参数表

+----------------+--------+--------------------------------+----------+
| 参数名         | 类型   | 描述                           | 是否必须 |
+----------------+--------+--------------------------------+----------+
| 非json格式     | String | mode=router                    | Y        |
|                |        |                                |          |
|                |        | router:路由模式                |          |
|                |        |                                |          |
|                |        | bridge:桥接模式                |          |
+----------------+--------+--------------------------------+----------+

发布消息示例：

  -----------------------------------------------------------------------
  mode=router

  -----------------------------------------------------------------------

## MQTT消息获取电竞、教育加速状态 {#mqtt消息获取电竞教育加速状态 .QB标题4}

## 接口描述 {#接口描述-26 .QB标题5}

接口描述：获取电竞、教育加速状态

订阅/发布url：ssl://aifastlink.komect.com:1883

消息类型：mqtt

## 订阅 {#订阅-4 .QB标题5}

表7.5-15组网终端家宽优选业务获取电竞、教育加速状态订阅参数表

+----------------+--------+--------------------------------+----------+
| 参数名         | 类型   | 描述                           | 是否必须 |
+----------------+--------+--------------------------------+----------+
| MsgList        | Array  | 已订阅MQTT消息体。             | Y        |
+----------------+--------+--------------------------------+----------+
| data           | Object | 解析数据包                     | Y        |
+----------------+--------+--------------------------------+----------+
| action         | String | 操作说明，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | control:加速/停止加速，        |          |
|                |        |                                |          |
|                |        | getD                           |          |
|                |        | evicesList：获取下挂设备列表， |          |
|                |        |                                |          |
|                |        | getS                           |          |
|                |        | tatus：获取教育/电竞加速状态， |          |
|                |        |                                |          |
|                |        | u                              |          |
|                |        | pdateConfig:教育加速更新配置， |          |
|                |        |                                |          |
|                |        | gnCon                          |          |
|                |        | fig:通知绿色上网更新管控策略， |          |
|                |        |                                |          |
|                |        | serviceStat                    |          |
|                |        | us：通知平台返回用户订购状态， |          |
|                |        |                                |          |
|                |        | reboot:重启设备                |          |
+----------------+--------+--------------------------------+----------+
| accType        | String | 业务类型，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | 0：电竞加速，                  |          |
|                |        |                                |          |
|                |        | 1：教育加速，                  |          |
|                |        |                                |          |
|                |        | 2：绿色上网                    |          |
+----------------+--------+--------------------------------+----------+
| userid         | String | 用                             | Y        |
|                |        | 户id，家宽优选平台生成的用户id |          |
+----------------+--------+--------------------------------+----------+
| reqid          | String | 请求                           | Y        |
|                |        | id，平台为每条消息生成的id标志 |          |
+----------------+--------+--------------------------------+----------+
| msgtype        | String | 消息类型，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | 3001：加速/停止加速，          |          |
|                |        |                                |          |
|                |        | 3005：获取电竞加速设备列表，   |          |
|                |        |                                |          |
|                |        | 3011：设置路由器为路由模式，   |          |
|                |        |                                |          |
|                |        | 301                            |          |
|                |        | 3：获取路由器的路由/桥接模式， |          |
|                |        |                                |          |
|                |        | 3015：获取电竞/教育加速状态，  |          |
|                |        |                                |          |
|                |        | 3017：教育加速更新配置，       |          |
|                |        |                                |          |
|                |        | 30                             |          |
|                |        | 19：通知绿色上网更新管控策略， |          |
|                |        |                                |          |
|                |        | 3021：                         |          |
|                |        | 通知平台返回用户业务订购状态， |          |
|                |        |                                |          |
|                |        | 3023：重启设备                 |          |
+----------------+--------+--------------------------------+----------+
| Result         | Number | 结果，枚举取值；               | Y        |
|                |        |                                |          |
|                |        | 0：成功，                      |          |
|                |        |                                |          |
|                |        | 非0：失败                      |          |
+----------------+--------+--------------------------------+----------+

订阅消息示例：

{\"MsgList\":\[{\"data\":{\"action\":\"getStatus\",\"accType\":\"1\",\"userid\":\"999999\",\"reqid\":\"999999999\"},\"msgtype\":\"3015\"}\],\"Result\":0}

## 发布 {#发布-3 .QB标题5}

表7.5-16 组网终端家宽优选业务获取电竞、教育加速状态发布参数表

+----------------+--------+--------------------------------+----------+
| 参数名         | 类型   | 描述                           | 是否必须 |
+----------------+--------+--------------------------------+----------+
| action         | String | 操作说明，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | control:加速/停止加速，        |          |
|                |        |                                |          |
|                |        | getD                           |          |
|                |        | evicesList：获取下挂设备列表， |          |
|                |        |                                |          |
|                |        | getS                           |          |
|                |        | tatus：获取教育/电竞加速状态， |          |
|                |        |                                |          |
|                |        | u                              |          |
|                |        | pdateConfig:教育加速更新配置， |          |
|                |        |                                |          |
|                |        | gnCon                          |          |
|                |        | fig:通知绿色上网更新管控策略， |          |
|                |        |                                |          |
|                |        | serviceStat                    |          |
|                |        | us：通知平台返回用户订购状态， |          |
|                |        |                                |          |
|                |        | reboot:重启设备                |          |
+----------------+--------+--------------------------------+----------+
| status         | String | 加速状态，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | start：加速状态，              |          |
|                |        |                                |          |
|                |        | stop：未加速状态               |          |
+----------------+--------+--------------------------------+----------+
| reqid          | Number | 请求                           | Y        |
|                |        | id，平台为每条消息生成的id标志 |          |
+----------------+--------+--------------------------------+----------+
| ret_code       | Number | 执行结果，枚举取值；           |          |
|                |        |                                |          |
|                |        | 0：成功，                      |          |
|                |        |                                |          |
|                |        | 非0：失败                      |          |
+----------------+--------+--------------------------------+----------+
| accType        | String | 业务类型，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | 0：电竞加速，                  |          |
|                |        |                                |          |
|                |        | 1：教育加速，                  |          |
|                |        |                                |          |
|                |        | 2：绿色上网                    |          |
+----------------+--------+--------------------------------+----------+

发布消息示例：

{\"action\":\"getStatus\",\"status\":\"stop\",\"reqid\":999999999,\"ret_code\":0,\"accType\":\"1\"}

## MQTT消息教育加速更新配置 {#mqtt消息教育加速更新配置 .QB标题4}

## 接口描述 {#接口描述-27 .QB标题5}

接口描述：教育加速更新配置

订阅/发布url：ssl://aifastlink.komect.com:1883

消息类型：mqtt

## 订阅 {#订阅-5 .QB标题5}

表7.5-17 组网终端家宽优选业务教育技术更新配置订阅参数表

+----------------+--------+--------------------------------+----------+
| 参数名         | 类型   | 描述                           | 是否必须 |
+----------------+--------+--------------------------------+----------+
| MsgList        | Array  | 已订阅MQTT消息体。             | Y        |
+----------------+--------+--------------------------------+----------+
| data           | Object | 解析数据包                     | Y        |
+----------------+--------+--------------------------------+----------+
| action         | String | 操作说明，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | control:加速/停止加速，        |          |
|                |        |                                |          |
|                |        | getD                           |          |
|                |        | evicesList：获取下挂设备列表， |          |
|                |        |                                |          |
|                |        | getS                           |          |
|                |        | tatus：获取教育/电竞加速状态， |          |
|                |        |                                |          |
|                |        | u                              |          |
|                |        | pdateConfig:教育加速更新配置， |          |
|                |        |                                |          |
|                |        | gnCon                          |          |
|                |        | fig:通知绿色上网更新管控策略， |          |
|                |        |                                |          |
|                |        | serviceStat                    |          |
|                |        | us：通知平台返回用户订购状态， |          |
|                |        |                                |          |
|                |        | reboot:重启设备                |          |
+----------------+--------+--------------------------------+----------+
| accType        | String | 业务类型，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | 0：电竞加速，                  |          |
|                |        |                                |          |
|                |        | 1：教育加速，                  |          |
|                |        |                                |          |
|                |        | 2：绿色上网                    |          |
+----------------+--------+--------------------------------+----------+
| confType       | String | 配置类型，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | 0：零配置更新，                |          |
|                |        |                                |          |
|                |        | 1：基础top，                   |          |
|                |        |                                |          |
|                |        | 2：自定义，                    |          |
|                |        |                                |          |
|                |        | 3：同时更新所有                |          |
+----------------+--------+--------------------------------+----------+
| reqid          | String | 请求                           | Y        |
|                |        | id，平台为每条消息生成的id标志 |          |
+----------------+--------+--------------------------------+----------+
| msgtype        | String | 消息类型，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | 3001：加速/停止加速，          |          |
|                |        |                                |          |
|                |        | 3005：获取电竞加速设备列表，   |          |
|                |        |                                |          |
|                |        | 3011：设置路由器为路由模式，   |          |
|                |        |                                |          |
|                |        | 301                            |          |
|                |        | 3：获取路由器的路由/桥接模式， |          |
|                |        |                                |          |
|                |        | 3015：获取电竞/教育加速状态，  |          |
|                |        |                                |          |
|                |        | 3017：教育加速更新配置，       |          |
|                |        |                                |          |
|                |        | 30                             |          |
|                |        | 19：通知绿色上网更新管控策略， |          |
|                |        |                                |          |
|                |        | 3021：                         |          |
|                |        | 通知平台返回用户业务订购状态， |          |
|                |        |                                |          |
|                |        | 3023：重启设备                 |          |
+----------------+--------+--------------------------------+----------+
| Result         | Number | 结果，枚举取值；               | Y        |
|                |        |                                |          |
|                |        | 0：成功，                      |          |
|                |        |                                |          |
|                |        | 非0：失败                      |          |
+----------------+--------+--------------------------------+----------+

订阅消息示例：

{\"MsgList\":\[{\"data\":{\"action\":\"updateConfig\",\"accType\":\"1\",\"confType\":\"3\",\"reqid\":\"862633421\"},\"msgtype\":\"3017\"}\],\"Result\":0}

## 发布 {#发布-4 .QB标题5}

表7.5-18 组网终端家宽优选业务教育加速更新配置发布参数表

+----------------+--------+--------------------------------+----------+
| 参数名         | 类型   | 描述                           | 是否必须 |
+----------------+--------+--------------------------------+----------+
| action         | String | 操作说明，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | control:加速/停止加速，        |          |
|                |        |                                |          |
|                |        | getD                           |          |
|                |        | evicesList：获取下挂设备列表， |          |
|                |        |                                |          |
|                |        | getS                           |          |
|                |        | tatus：获取教育/电竞加速状态， |          |
|                |        |                                |          |
|                |        | u                              |          |
|                |        | pdateConfig:教育加速更新配置， |          |
|                |        |                                |          |
|                |        | gnCon                          |          |
|                |        | fig:通知绿色上网更新管控策略， |          |
|                |        |                                |          |
|                |        | serviceStat                    |          |
|                |        | us：通知平台返回用户订购状态， |          |
|                |        |                                |          |
|                |        | reboot:重启设备                |          |
+----------------+--------+--------------------------------+----------+
| ret_code       | Number | 执行结果，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | 0：执行成功，                  |          |
|                |        |                                |          |
|                |        | 非0：执行失败                  |          |
+----------------+--------+--------------------------------+----------+
| reqid          | String | 请求                           | Y        |
|                |        | id，平台为每条消息生成的id标志 |          |
+----------------+--------+--------------------------------+----------+
| accType        | String | 业务类型，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | 0：电竞加速，                  |          |
|                |        |                                |          |
|                |        | 1：教育加速，                  |          |
|                |        |                                |          |
|                |        | 2：绿色上网                    |          |
+----------------+--------+--------------------------------+----------+
| confType       | String | 配置类型，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | 0：零配置更新，                |          |
|                |        |                                |          |
|                |        | 1：基础top，                   |          |
|                |        |                                |          |
|                |        | 2：自定义，                    |          |
|                |        |                                |          |
|                |        | 3：同时更新所有                |          |
+----------------+--------+--------------------------------+----------+

发布消息示例：

{\"action\":\"updateConfig\",\"ret_code\":0,\"reqid\":862633421,\"accType\":\"1\",\"confType\":\"3\"}

## MQTT消息通知绿色上网更新管控策略 {#mqtt消息通知绿色上网更新管控策略 .QB标题4}

## 接口描述 {#接口描述-28 .QB标题5}

接口描述：通知绿色上网更新管控策略

订阅/发布url：ssl://aifastlink.komect.com:1883

消息类型：mqtt

## 订阅 {#订阅-6 .QB标题5}

表7.5-19 组网终端家宽优选业务通知绿色上网更新管控策略订阅参数表

+----------------+--------+--------------------------------+----------+
| 参数名         | 类型   | 描述                           | 是否必须 |
+----------------+--------+--------------------------------+----------+
| MsgList        | Array  | 已订阅MQTT消息体。             | Y        |
+----------------+--------+--------------------------------+----------+
| data           | Object | 解析数据包                     | Y        |
+----------------+--------+--------------------------------+----------+
| action         | String | 操作说明，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | control:加速/停止加速，        |          |
|                |        |                                |          |
|                |        | getD                           |          |
|                |        | evicesList：获取下挂设备列表， |          |
|                |        |                                |          |
|                |        | getS                           |          |
|                |        | tatus：获取教育/电竞加速状态， |          |
|                |        |                                |          |
|                |        | u                              |          |
|                |        | pdateConfig:教育加速更新配置， |          |
|                |        |                                |          |
|                |        | gnCon                          |          |
|                |        | fig:通知绿色上网更新管控策略， |          |
|                |        |                                |          |
|                |        | serviceStat                    |          |
|                |        | us：通知平台返回用户订购状态， |          |
|                |        |                                |          |
|                |        | reboot:重启设备                |          |
+----------------+--------+--------------------------------+----------+
| reqid          | String | 请求                           | Y        |
|                |        | id，平台为每条消息生成的id标志 |          |
+----------------+--------+--------------------------------+----------+
| msgtype        | String | 消息类型，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | 3001：加速/停止加速，          |          |
|                |        |                                |          |
|                |        | 3005：获取电竞加速设备列表，   |          |
|                |        |                                |          |
|                |        | 3011：设置路由器为路由模式，   |          |
|                |        |                                |          |
|                |        | 301                            |          |
|                |        | 3：获取路由器的路由/桥接模式， |          |
|                |        |                                |          |
|                |        | 3015：获取电竞/教育加速状态，  |          |
|                |        |                                |          |
|                |        | 3017：教育加速更新配置，       |          |
|                |        |                                |          |
|                |        | 30                             |          |
|                |        | 19：通知绿色上网更新管控策略， |          |
|                |        |                                |          |
|                |        | 3021：                         |          |
|                |        | 通知平台返回用户业务订购状态， |          |
|                |        |                                |          |
|                |        | 3023：重启设备                 |          |
+----------------+--------+--------------------------------+----------+
| Result         | Number | 结果，枚举取值；               | Y        |
|                |        |                                |          |
|                |        | 0：成功，                      |          |
|                |        |                                |          |
|                |        | 非0：失败                      |          |
+----------------+--------+--------------------------------+----------+

订阅消息示例：

{\"MsgList\":\[{\"data\":{\"action\":\"gnConfig\",\"reqid\":\"986483361\"},\"msgtype\":\"3019\"}\],\"Result\":0}

## 发布 {#发布-5 .QB标题5}

表7.5-20 组网终端家宽优选业务通知绿色上网更新管控策略发布参数表

+----------------+--------+--------------------------------+----------+
| 参数名         | 类型   | 描述                           | 是否必须 |
+----------------+--------+--------------------------------+----------+
| action         | String | 操作说明，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | control:加速/停止加速，        |          |
|                |        |                                |          |
|                |        | getD                           |          |
|                |        | evicesList：获取下挂设备列表， |          |
|                |        |                                |          |
|                |        | getS                           |          |
|                |        | tatus：获取教育/电竞加速状态， |          |
|                |        |                                |          |
|                |        | u                              |          |
|                |        | pdateConfig:教育加速更新配置， |          |
|                |        |                                |          |
|                |        | gnCon                          |          |
|                |        | fig:通知绿色上网更新管控策略， |          |
|                |        |                                |          |
|                |        | serviceStat                    |          |
|                |        | us：通知平台返回用户订购状态， |          |
|                |        |                                |          |
|                |        | reboot:重启设备                |          |
+----------------+--------+--------------------------------+----------+
| reqid          | String | 请求                           | Y        |
|                |        | id，平台为每条消息生成的id标志 |          |
+----------------+--------+--------------------------------+----------+

发布消息示例：

{\"action\":\"gnConfig\",\"reqid\":\"548650982\"}

## MQTT消息返回用户业务订购状态 {#mqtt消息返回用户业务订购状态 .QB标题4}

## 接口描述 {#接口描述-29 .QB标题5}

接口描述：返回用户业务订购状态

订阅/发布url：ssl://aifastlink.komect.com:1883

消息类型：mqtt

## 订阅 {#订阅-7 .QB标题5}

表7.5-21组网终端家宽优选业务返回用户业务订购状态订阅参数表

+----------------+--------+--------------------------------+----------+
| 参数名         | 类型   | 描述                           | 是否必须 |
+----------------+--------+--------------------------------+----------+
| MsgList        | Array  | 已订阅MQTT消息体。             | Y        |
+----------------+--------+--------------------------------+----------+
| data           | Object | 解析数据包                     | Y        |
+----------------+--------+--------------------------------+----------+
| sgame          | String | 电竞加速订购状态，枚举取值；   | Y        |
|                |        |                                |          |
|                |        | ON：订购；OFF：未订购          |          |
+----------------+--------+--------------------------------+----------+
| sedu           | String | 教育加速订购状态，枚举取值；   | Y        |
|                |        |                                |          |
|                |        | ON：订购；OFF：未订购          |          |
+----------------+--------+--------------------------------+----------+
| sgreen         | String | 绿色上网订购状态，枚举取值；   | Y        |
|                |        |                                |          |
|                |        | ON：订购；OFF：未订购          |          |
+----------------+--------+--------------------------------+----------+
| action         | String | 操作说明，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | control:加速/停止加速，        |          |
|                |        |                                |          |
|                |        | getDevicesList：获取下挂设备   |          |
|                |        | 列表，getStatus：获取教育/电竞 |          |
|                |        | 加速状态，updateConfig:教育加  |          |
|                |        | 速更新配置，gnConfig:通知绿色  |          |
|                |        | 上网更新管控策略，serviceStat  |          |
|                |        | us：通知平台返回用户订购状态， |          |
|                |        |                                |          |
|                |        | reboot:重启设备                |          |
+----------------+--------+--------------------------------+----------+
| msgtype        | String | 消息类型，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | 3001：加速/停止加速，          |          |
|                |        |                                |          |
|                |        | 3005：获取电竞加速设备列表，   |          |
|                |        |                                |          |
|                |        | 3011：设置路由器为路由模式，   |          |
|                |        |                                |          |
|                |        | 301                            |          |
|                |        | 3：获取路由器的路由/桥接模式， |          |
|                |        |                                |          |
|                |        | 3015：获取电竞/教育加速状态，  |          |
|                |        |                                |          |
|                |        | 3017：教育加速更新配置，       |          |
|                |        |                                |          |
|                |        | 30                             |          |
|                |        | 19：通知绿色上网更新管控策略， |          |
|                |        |                                |          |
|                |        | 3021：                         |          |
|                |        | 通知平台返回用户业务订购状态， |          |
|                |        |                                |          |
|                |        | 3023：重启设备                 |          |
+----------------+--------+--------------------------------+----------+
| reqid          | String | 用                             | Y        |
|                |        | 户id，家宽优选平台生成的用户id |          |
+----------------+--------+--------------------------------+----------+
| Result         | Number | 结果，枚举取值；               | Y        |
|                |        |                                |          |
|                |        | 0：成功；非0：失败             |          |
+----------------+--------+--------------------------------+----------+

订阅消息示例：

{\"MsgList\":\[{\"data\":{\"sgame\":\"ON\",\"sedu\":\"ON\",\"sgreen\":\"ON\"},\"action\":\"serviceStatus\",\"msgtype\":\"3021\",\"reqid\":\"278139466\"}\],\"Result\":0}

## 发布 {#发布-6 .QB标题5}

表7.5-22 组网终端家宽优选业务返回用户业务订购状态发布参数表

+----------------+--------+--------------------------------+----------+
| 参数名         | 类型   | 描述                           | 是否必须 |
+----------------+--------+--------------------------------+----------+
| action         | String | 操作说明，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | control:加速/停止加速，        |          |
|                |        |                                |          |
|                |        | getD                           |          |
|                |        | evicesList：获取下挂设备列表， |          |
|                |        |                                |          |
|                |        | getS                           |          |
|                |        | tatus：获取教育/电竞加速状态， |          |
|                |        |                                |          |
|                |        | u                              |          |
|                |        | pdateConfig:教育加速更新配置， |          |
|                |        |                                |          |
|                |        | gnCon                          |          |
|                |        | fig:通知绿色上网更新管控策略， |          |
|                |        |                                |          |
|                |        | serviceStat                    |          |
|                |        | us：通知平台返回用户订购状态， |          |
|                |        |                                |          |
|                |        | reboot:重启设备                |          |
+----------------+--------+--------------------------------+----------+
| reqid          | String | 请求                           | Y        |
|                |        | id，平台为每条消息生成的id标志 |          |
+----------------+--------+--------------------------------+----------+

发布消息示例：

{\"action\":\"serviceStatus\",\"reqid\":\"834672395\"}

## MQTT消息设备重启 {#mqtt消息设备重启 .QB标题4}

## 接口描述 {#接口描述-30 .QB标题5}

接口描述：设备重启

订阅/发布url：ssl://aifastlink.komect.com:1883

消息类型：mqtt

## 订阅 {#订阅-8 .QB标题5}

表7.5-23 组网终端家宽优选业务设备重启订阅参数表

+----------------+--------+--------------------------------+----------+
| 参数名         | 类型   | 描述                           | 是否必须 |
+----------------+--------+--------------------------------+----------+
| MsgList        | Array  | 已订阅MQTT消息体。             | Y        |
+----------------+--------+--------------------------------+----------+
| data           | Object | 解析数据包                     | Y        |
+----------------+--------+--------------------------------+----------+
| action         | String | 操作说明，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | control:加速/停止加速，        |          |
|                |        |                                |          |
|                |        | getD                           |          |
|                |        | evicesList：获取下挂设备列表， |          |
|                |        |                                |          |
|                |        | getS                           |          |
|                |        | tatus：获取教育/电竞加速状态， |          |
|                |        |                                |          |
|                |        | u                              |          |
|                |        | pdateConfig:教育加速更新配置， |          |
|                |        |                                |          |
|                |        | gnCon                          |          |
|                |        | fig:通知绿色上网更新管控策略， |          |
|                |        |                                |          |
|                |        | serviceStat                    |          |
|                |        | us：通知平台返回用户订购状态， |          |
|                |        |                                |          |
|                |        | reboot:重启设备                |          |
+----------------+--------+--------------------------------+----------+
| reqid          | String | 请求                           | Y        |
|                |        | id，平台为每条消息生成的id标志 |          |
+----------------+--------+--------------------------------+----------+
| msgtype        | String | 消息类型，枚举取值；           | Y        |
|                |        |                                |          |
|                |        | 3001：加速/停止加速，          |          |
|                |        |                                |          |
|                |        | 3005：获取电竞加速设备列表，   |          |
|                |        |                                |          |
|                |        | 3011：设置路由器为路由模式，   |          |
|                |        |                                |          |
|                |        | 301                            |          |
|                |        | 3：获取路由器的路由/桥接模式， |          |
|                |        |                                |          |
|                |        | 3015：获取电竞/教育加速状态，  |          |
|                |        |                                |          |
|                |        | 3017：教育加速更新配置，       |          |
|                |        |                                |          |
|                |        | 30                             |          |
|                |        | 19：通知绿色上网更新管控策略， |          |
|                |        |                                |          |
|                |        | 3021：                         |          |
|                |        | 通知平台返回用户业务订购状态， |          |
|                |        |                                |          |
|                |        | 3023：重启设备                 |          |
+----------------+--------+--------------------------------+----------+
| Result         | Number | 结果，枚举取值；               | Y        |
|                |        |                                |          |
|                |        | 0：成功，                      |          |
|                |        |                                |          |
|                |        | 非0：失败                      |          |
+----------------+--------+--------------------------------+----------+

订阅消息示例：

{\"MsgList\":\[{\"data\":{\"action\":\"reboot\",\"reqid\":\"495439959\"},\"msgtype\":\"3023\"}\],\"Result\":0}

发布消息参数：无

## 绿色上网服务配置更新 {#绿色上网服务配置更新 .QB标题4}

## 接口描述 {#接口描述-31 .QB标题5}

接口内容：当收到绿色上网更新管控策略更新后（7.5.2.11）、或到达设定的配置平台访问周期时，组网终端向家开平台发起请求，双向验签成功后，组网终端记录最新的配置参数，本地记录RSA公钥data内容，用于绿色上网管控策略更新接口的验签。

请求url：https://open.home.komect.com/greennet/co/get

请求头：Content-Type: application/json

> Accept-Charset: utf-8

请求类型：POST，组网终端-\>家开平台

## 请求 {#请求-79 .QB标题5}

表7.5-24绿色上网服务配置更新请求参数表

+--------------+--------+------------------------------------+--------+
| 参数名       | 类型   | 描述                               | 是     |
|              |        |                                    | 否必须 |
+==============+========+====================================+========+
| deviceMac    | String | 设备MAC大写不带冒号（LAN口MAC）    | Y      |
+--------------+--------+------------------------------------+--------+
| wanMac       | String | 设备MAC大写不带冒号（WAN口MAC）    | Y      |
+--------------+--------+------------------------------------+--------+
| deviceModel  | String | 型号编码                           | Y      |
+--------------+--------+------------------------------------+--------+
| deviceVendor | String | 厂商编码                           | Y      |
+--------------+--------+------------------------------------+--------+
| fir          | String | 终端设备固件版本                   | Y      |
| mwareVersion |        |                                    |        |
+--------------+--------+------------------------------------+--------+
| cmei         | String | 设备唯一标识                       | Y      |
+--------------+--------+------------------------------------+--------+
| deviceSn     | String | 组网终端SN                         | Y      |
+--------------+--------+------------------------------------+--------+
| develo       | String | 绿色上网服务软件版本号：           | Y      |
| pmentVersion |        |                                    |        |
|              |        | 设备厂商编码_开发版本号            |        |
+--------------+--------+------------------------------------+--------+
| interfaceVer | String | 组网终端接口规范版本号（2.0.0）    | Y      |
+--------------+--------+------------------------------------+--------+
| timestamp    | Number | 0                                  | Y      |
|              |        | 或13位毫秒级时间戳（仅重启时传零） |        |
+--------------+--------+------------------------------------+--------+
| sign         | String | 签                                 | Y      |
|              |        | 名：HMAC-Sha256(deviceMac\|\|devi  |        |
|              |        | ceModel\|\|deviceVendor\|\|firmwar |        |
|              |        | eVersion\|\|developmentVersion\|\| |        |
|              |        | interfaceVer\|\|timestamp，AES预置 |        |
|              |        | 密钥\|\|cmei)，\|\|表示字符串拼接  |        |
+--------------+--------+------------------------------------+--------+

示例：

{\"deviceMac\":\"54E1ADA85804\",\"wanMac\":\"54E1ADA85805\",\"deviceVendor\":\"xxxxx\",\"cmei\":\"111004365007791\",\"deviceModel\":\"xxxxx\",\"developmentVersion\":\"xxxx\",\"firmwareVersion\":\"xxxx\",\"deviceSn\":\"xxxx\",\"interfaceVer\":\"2.0.0\",\"timestamp\":1626948825804,\"sign\":\"xx\"}

## 响应 {#响应-79 .QB标题5}

表7.5-25 绿色上网服务配置更新响应参数表

+--------------+--------+---------------------------------+------------+
| 参数名       | 类型   | 描述                            | 是否必须   |
+==============+========+=================================+============+
| status       | Number | 平台返回的状态码，见附录E       | Y          |
+--------------+--------+---------------------------------+------------+
| message      | String | 平台返回的消息                  | Y          |
+--------------+--------+---------------------------------+------------+
| result       | String | 平台返回的结果                  | Y          |
+--------------+--------+---------------------------------+------------+
| midKey       | String | AES中间密钥                     | Y(成       |
|              |        |                                 | 功时必选)  |
+--------------+--------+---------------------------------+------------+
| cf           | String | 配置平台访问URL和端口           | Y(成       |
| gPlatformUrl |        |                                 | 功时必选)  |
+--------------+--------+---------------------------------+------------+
| cf           | String | 配置平台访问周期                | Y(成       |
| gAccessCycle |        |                                 | 功时必选)  |
+--------------+--------+---------------------------------+------------+
| ct           | String | 管控平台访问URL和端口           | Y(成       |
| lPlatformUrl |        |                                 | 功时必选)  |
+--------------+--------+---------------------------------+------------+
| ct           | Number | 管控平台访问周期                | Y(成       |
| lAccessCycle |        |                                 | 功时必选)  |
+--------------+--------+---------------------------------+------------+
| flo          | String | 数据上报平台访问URL和端口       | Y(成       |
| wPlatformUrl |        |                                 | 功时必选)  |
+--------------+--------+---------------------------------+------------+
| infoRule     | String | 上报信息过滤规则（符合BPF规则） | N          |
+--------------+--------+---------------------------------+------------+
| flowSwitch   | Number | 数据上报开关状态：0             | N          |
|              |        | 表示关闭，1表示开启，忽略其它值 |            |
+--------------+--------+---------------------------------+------------+
| envThreshold | String | 环境阈值，上下限范围            | N          |
|              |        | 为：10%-80%，上限需大于等于下限 |            |
|              |        | 值，否则沿用上次的值，例：10-80 |            |
+--------------+--------+---------------------------------+------------+
| timestamp    | Number | 13位毫秒级时间戳                | Y(成       |
|              |        |                                 | 功时必选)  |
+--------------+--------+---------------------------------+------------+
| data         | String | RSA公钥                         | Y(成       |
|              |        |                                 | 功时必选)  |
+--------------+--------+---------------------------------+------------+
| val          | String | 签名：                          | Y(成       |
|              |        | RSA（md5(midKey\|\|cfgPlatform  | 功时必选)  |
|              |        |                                 |            |
|              |        | Url\|\|cfgAccessC               |            |
|              |        | ycle\|\|timestamp\|\|len\|\|dat |            |
|              |        | a)，平台私钥）,\|\|字符串连接符 |            |
+--------------+--------+---------------------------------+------------+

> 备注：
>
> 服务使用预置RSA公钥验证平台合法性。
>
> 服务基于预置RSA公钥验签val字段。

len = midkey\|\|cfgPlatformUrl\|\|cfgAccessCycle\|\|timestamp的长度。

> 示例：
>
> a、 平台返回的正常应答消息：
>
> {\"status\":100,\"message\":\"success\",\"result\":{\"midkey\":\"O2KCeMuWTsO+KA==\",\"cfgPlatformUrl\":\"open.home.komect.com:443\",\"cfgAccessCycle\":1800,\"ctlPlatformUrl\":\"open.home.komect.com:443\",\"ctlAccessCycle\":1800,\"flowPlatformUrl\":\"wuyou.komect.com:443\",\"infoRule\":\"(dst
> port 80) or(src port
> 53)\",\"flowSwitch\":0,\"envThreshold\":\"10-80\",\"data\":\"MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAKssUwQD0vfDzhPnntzjoGayBr/UlnB3Gyukf/mCOrrgdfLGHzHPufv0DH60IQ+dQXytHDAK2DM92Y6UXn;M9t/8CAwEAAQ==\",\"val\":\"fCw0n4FZbxCWpQAS\",\"timestamp\":1626948825804}}
>
> b、平台返回的错误应答消息：
>
> {\"status\":211,\"message\":\"参数错误\",\"result\":{}}

## 绿色上网服务管控策略更新 {#绿色上网服务管控策略更新 .QB标题4}

## 接口描述 {#接口描述-32 .QB标题5}

接口内容：当收到绿色上网更新管控策略更新后（7.5.2.11）或到达设定的管控平台访问周期，组网终端向家开平台发起请求，双向验签成功后，组网终端执行策略更新。

请求url：https://open.home.komect.com/greennet/ro/gc

请求头：Content-Type: application/json

> Accept-Charset: utf-8

请求类型：POST，组网终端-\>家开平台

## 请求 {#请求-80 .QB标题5}

表7.5-26绿色上网服务控制策略更新请求参数表

+--------------+--------+------------------------------------+--------+
| 参数名       | 类型   | 描述                               | 是     |
|              |        |                                    | 否必须 |
+==============+========+====================================+========+
| deviceMac    | String | 设备MAC大写不带冒号（LAN口MAC）    | Y      |
+--------------+--------+------------------------------------+--------+
| workingMode  | Number | 终端设备工作模式，                 | Y      |
|              |        | 0:路由模式，1：桥接模式，2：中继模 |        |
|              |        | 式，-1：其它（该值有可能获取不到） |        |
+--------------+--------+------------------------------------+--------+
| bindStatus   | Number | 终                                 | Y      |
|              |        | 端设备记录的绑定状态，0:未绑定，1  |        |
|              |        | ：绑定，-1：其它（该值有可能获取不 |        |
|              |        | 到）。路由器本地记录的帐号绑定状态 |        |
+--------------+--------+------------------------------------+--------+
| brFireWall   | Number | 终端设备本地网桥防火墙状态，0：    | N      |
|              |        | 无网桥防火墙，1：关闭，2：开启，-1 |        |
|              |        | ：未获取。未传递时默认无网桥防火墙 |        |
+--------------+--------+------------------------------------+--------+
| t2m          | String | 系统时间，格式：yyyyMMddHHmm       | Y      |
+--------------+--------+------------------------------------+--------+
| develo       | String | 绿色上网服务软件版本号：           | Y      |
| pmentVersion |        |                                    |        |
|              |        | 设备厂商编码_开发版本号            |        |
+--------------+--------+------------------------------------+--------+
| interfaceVer | String | 组网终端接口规范版本号（2.0.0）    | Y      |
+--------------+--------+------------------------------------+--------+
| cnonce       | String | 随机数，32位二进制位随机数         | Y      |
+--------------+--------+------------------------------------+--------+
| timestamp    | Number | 0或13                              | Y      |
|              |        | 位毫秒级时间戳（（仅重启时传零）） |        |
+--------------+--------+------------------------------------+--------+
| sign         | String | 签                                 | Y      |
|              |        | 名：HMACSha256（interfaceVer\|\|la |        |
|              |        | nMac\|\|(t2m+cnonce)\|\|timestamp, |        |
|              |        | AES预置                            |        |
|              |        | 密钥\|\|cmei），\|\|表示字符串拼接 |        |
+--------------+--------+------------------------------------+--------+

示例：

{\"deviceMac\":\"54E1ADA85804\",\"workingMode\":1,\"bindStatus\":0,\"brFireWall\":0,\"t2m\":\"201911191026\",\"developmentVersion\":\"xxxx\",\"interfaceVer\":\"2.0.0\",\"cnonce\":\"xx\",\"timestamp\":1626948825804,\"sign\":\"xx\"}

## 响应 {#响应-80 .QB标题5}

表7.5-27绿色上网服务控制策略更新响应参数表

  ---------------------------------------------------------------------------------------------------------------------------------
  参数名         类型      描述                                                                                     是否必须
  -------------- --------- ---------------------------------------------------------------------------------------- ---------------
  status         Number    平台返回状态码                                                                           Y

  message        String    平台返回的消息                                                                           Y

  result         String    平台返回的结果，具体的内容包括本表格4、5、6项和MsgList，ExtCmdList子集，详情见下表说明   Y

  bindMode       Number    平台下发用户绑定路由器状态                                                               N

  workingMode    Number    用户主动切换路由器工作模式                                                               N

  brFireWall     Number    网桥防火墙开关                                                                           N

  val            String    签名：RSA（明文connce，平台私钥），用于终端做验签，connce是请求该接口时终端带的参数      Y(成功时必选)

  timestamp      String    13位毫秒级时间戳                                                                         Y(成功时必选)
  ---------------------------------------------------------------------------------------------------------------------------------

> 备注：服务使用配置接口下发的RSA公钥data验证平台合法性。
>
> 服务基于配置接口中平台下发的公钥data验签val字段。

表7.5-28 绿色上网服务控制策略更新MsgList子集参数

+---------+-------+--------------------------------+------------------+
| 参数名  | 类型  | 描述                           | 是否必须         |
+=========+=======+================================+==================+
| msgtype | S     | 策略类型（详见下表参数字典）   | 除APP管控策略    |
|         | tring |                                | 外的所有策略必选 |
+---------+-------+--------------------------------+------------------+
| f       | N     | 策略状态（根                   | 对指定下挂设     |
| wStatus | umber | 据msgtype字段的不同则相应的定  | 备下发或解除一键 |
|         |       | 义不同，详情请见下表参数字典） | 禁网、周期禁网、 |
|         |       |                                | 域名拦截、APP管  |
|         |       |                                | 控策略或者对所有 |
|         |       |                                | 设备下发或解除域 |
|         |       |                                | 名拦截策略时必选 |
+---------+-------+--------------------------------+------------------+
| malic   | S     | 恶意域名                       | 下发或解除域     |
| iousUrl | tring | （仅在对指定下挂设备和所有设备 | 名管控策略时必选 |
|         |       | 下发或解除域名拦截策略时有效） |                  |
+---------+-------+--------------------------------+------------------+
| mac     | S     | 下挂设备Mac（本字              | 对               |
| Address | tring | 段仅在以下情况有效：1、对指定  | 指定下挂设备下发 |
|         |       | 下挂设备下发或解除域名拦截、周 | 或解除策略时必选 |
|         |       | 期禁网、一键禁网和APP管控策略  |                  |
|         |       | ；2、解除指定下挂设备所有周期  |                  |
|         |       | 禁网、域名拦截、app管控策略）  |                  |
+---------+-------+--------------------------------+------------------+
| ti      | S     | 周期禁网起始时间（表           | 对指定下         |
| meStart | tring | 示形式：21:00（时/分），仅在指 | 挂设备进行周期禁 |
|         |       | 定下挂设备进行周期禁网时有效） | 网管控策略时必选 |
+---------+-------+--------------------------------+------------------+
| t       | S     | 周期禁网终止时间（表           | 对指定下         |
| imeStop | tring | 示形式：19:00（时/分），仅在指 | 挂设备进行周期禁 |
|         |       | 定下挂设备进行周期禁网时有效） | 网管控策略时必选 |
+---------+-------+--------------------------------+------------------+
| w       | S     | 周期禁网星期                   | 对指定下         |
| eekdays | tring |                                | 挂设备进行周期禁 |
|         |       | （表示形式为星期               | 网管控策略时必选 |
|         |       | 英文缩写，比如Mon,Tue，仅在指  |                  |
|         |       | 定下挂设备进行周期禁网时有效） |                  |
+---------+-------+--------------------------------+------------------+

ExtCmdList子集参数说明（APP管控）：

表7.5-29 绿色上网服务控制策略更新ExtCmdList子集参数

  ---------------------------------------------------------------------------------------------------------------------------------------------------------------
  参数名       类型     描述                                                                                                是否必须
  ------------ -------- --------------------------------------------------------------------------------------------------- -------------------------------------
  macAddress   String   下挂设备Mac（同MsgList子集参数表格中该字段的备注；在APP管控时macAddress可为空，为空表示全局有效）   同MsgList子集参数表格中该字段的说明

  cmdString    String   APP应用流量特征值（16进制字符串，示例：7a756f796562616e672e6363）                                   APP策略管控时必选

  appName      String   APP应用名                                                                                           APP策略管控时必选
  ---------------------------------------------------------------------------------------------------------------------------------------------------------------

**msgtype和fw_status参数字典：**

+------+-----+--------------------------+------+---------------------+
| 字段 | 字  | 值说明                   | 字段 | 值说明              |
| 名称 | 段  |                          | 名称 |                     |
|      | 值  |                          |      |                     |
+======+=====+==========================+======+=====================+
| msg  | 3   | 对指定                   | fwSt | 0:放行，1:阻止      |
| type | 011 | 下挂设备进行一键禁网管控 | atus |                     |
+------+-----+--------------------------+------+---------------------+
|      | 3   | 对所有                   |      | 0:放行，1:阻止      |
|      | 005 | 下挂设备进行域名拦截管控 |      |                     |
+------+-----+--------------------------+------+---------------------+
|      | 3   | 对指定                   |      | 0:放行，1:阻止      |
|      | 009 | 下挂设备进行域名拦截管控 |      |                     |
+------+-----+--------------------------+------+---------------------+
|      | 3   | 对指定                   |      | 0:                  |
|      | 013 | 下挂设备进行周期禁网管控 |      | 删                  |
|      |     |                          |      | 除策略（解除禁网）  |
|      |     |                          |      |                     |
|      |     |                          |      | 1: 加入策略（禁网） |
+------+-----+--------------------------+------+---------------------+
|      | 3   | 解除指定                 |      | 不涉                |
|      | 015 | 下挂设备所有周期禁网策略 |      | 及fwStatus字段，只  |
|      |     |                          |      | 涉及macAddress字段  |
+------+-----+--------------------------+------+---------------------+
|      | 3   | 解除指定下挂             |      | 不涉                |
|      | 017 | 设备所有域名拦截管控策略 |      | 及fwStatus字段，只  |
|      |     |                          |      | 涉及macAddress字段  |
+------+-----+--------------------------+------+---------------------+
|      | 3   | 解除指定下挂设备所有     |      | 不涉                |
|      | 021 | app禁止访问网络管控策略  |      | 及fwStatus字段，只  |
|      |     |                          |      | 涉及macAddress字段  |
+------+-----+--------------------------+------+---------------------+

示例：

a、正常应答消息：

{\"status\":100,\"message\":\"success\",\"result\":{\"bindMode\":0,\"workingMode\":-1,\"brFireWall\":-1,\"timestamp\":1577995255353,\"val\":\"xxx\",\"MsgList\":\[{\"msgtype\":3005,\"data\":{\"fwStatus\":0,\"maliciousUrl\":\"baidu.com\"}},{\"msgtype\":3009,\"data\":{\"fwStatus\":0,\"macAddress\":\"AABBCCDDEEFF\",\"maliciousUrl\":\"baidu.com\"}},{\"msgtype\":3011,\"data\":{\"fwStatus\":0,\"macAddress\":\"AABBCCDDEEFF\"}},{\"msgtype\":3013,\"data\":{\"fwStatus\":0,\"macAddress\":\"AABBCCDDEEFF\",\"timeStart\":\"18:00\",\"timeStop\":\"21:00\",\"weekdays\":\"Mon,Tue\"}},{\"msgtype\":3015,\"data\":{\"macAddress\":\"AABBCCDDEEFF\"}},{\"msgtype\":3017,\"data\":{\"macAddress\":\"AABBCCDDEEFF\"}},{\"msgtype\":3021,\"data\":{\"macAddress\":\"AABBCCDDEEFF\"}}\],\"ExtCmdList\":\[{\"appName\":\"zuoyebang\",\"macAddress\":\"AABBCCDDEEFF\",\"cmdString\":\"7a756f796562616e672e6363\",\"fwStatus\":\"0\"},{\"appName\":\"aiqiyi\",\"macAddress\":\"AABBCCDDEEFF\",\"cmdString\":\"69716979692e636f6d\",\"fwStatus\":\"0\"}\]}}

b、错误应答消息：

{\"status\":211,\"message\":\"参数错误\",\"result\":{}}

## 绿色上网服务数据上报 {#绿色上网服务数据上报 .QB标题4}

## 接口描述 {#接口描述-33 .QB标题5}

接口内容：按照配置的参数的上报规则，开启或关闭数据上报，数据发送至家开平台。

请求url：访问平台的地址和端口从7.4.2.17绿色上网服务配置更新接口参数的flowPlatformUrl字段中获取。

请求头 ：无

请求类型：UDP，组网终端-\>家开平台

说明：

1.  绿色上网服务配置更新参数"数据上报"关闭时，关闭数据上报

2.  绿色上网服务配置更新参数"数据上报"开启时，当终端设备整体CPU使用率超过绿色上网服务配置更新（7.4.2.17）响应中环境阈值的上限阈值时，关闭数据上报

## 传输字段定义 {#传输字段定义 .QB标题5}

表7.5-30绿色上网服务数据上报传输字段参数表

  -----------------------------------------------------------------------------
  参数名      类型     描述                                        是否必须
  ----------- -------- ------------------------------------------- ------------
  deviceMac   String   终端设备LAN口MAC（Eg 54E1ADA85805）         Y

  crc32       String   由cipher解密后的前32个字节生成的CRC校验码   Y

  cipher      String   AES(Http信息数据体或Dns信息数据体)          Y
  -----------------------------------------------------------------------------

最终上报报文的UDP载荷内容由mac、crc32、cipher组成，

即deviceMac+crc32+\|\|+AES(Http信息数据体或Dns信息数据体)，此处的\|\|表示实际的字符串分隔符，+
表示字符串拼接。

cipher解密后的内容如下：

表7.5-31 HTTP信息数据体

  ----------------------------------------------------------------------------------------------------
  参数名       类型     描述                                                                是否必须
  ------------ -------- ------------------------------------------------------------------- ----------
  type         String   报文类型（0：HTTP、1：DNS）                                         Y

  srcIPv4      String   组网终端外网IPv4地址                                                N

  srcIPv6      String   组网终端外网IPv6地址                                                N

  deviceMac    String   组网终端MAC大写带冒号                                               Y

  subDevMac    String   下挂设备MAC大写带冒号                                               Y

  subDevIPv6   String   下挂设备IPv6地址                                                    N

  url          String   获取GET、POST、PUT、DELET的请求内容，例如："GET /flash/210853.htm   N
                        HTTP/1.1"                                                           

  userAgent    String   HTTP头域"User-Agent"字段                                            N

  host         String   HTTP头域"Host"字段                                                  Y

  referer      String   HTTP头域"Referer"字段                                               N

  timestamp    String   13位毫秒级时间戳（1970年1月1日作为起始时间计算，例如："2020/01/01   Y
                        1:00:00.000"对应时间戳为"1577811600000"）                           
  ----------------------------------------------------------------------------------------------------

表7.5-32 DNS信息数据体

  ---------------------------------------------------------------------------------------------------------------------------------
  参数名       类型     描述                                                                                             是否必须
  ------------ -------- ------------------------------------------------------------------------------------------------ ----------
  type         String   报文类型（0：HTTP、1：DNS）                                                                      Y

  srcIPv4      String   组网终端外网IPv4地址                                                                             N

  srcIPv6      String   组网终端外网IPv6地址                                                                             N

  deviceMac    String   组网终端MAC大写带英文冒号                                                                        Y

  subDevMac    String   下挂设备MAC大写带英文冒号                                                                        Y

  subDevIPv6   String   下挂设备IPv6地址                                                                                 N

  dnsIPv4      String   DNS服务器IPv4地址                                                                                N

  dnsIPv6      String   DNS服务器IPv6地址                                                                                N

  dnsPort      String   DNS服务器端口                                                                                    Y

  dnsType      String   DNS类型（A或AAAA）                                                                               Y

  domain       String   访问域名                                                                                         Y

  domainIPv4   String   域名对应的IPv4（如存在多个，可用英文逗号","分隔，例如："211.136.27.3,211.136.27.4"）             N

  domainIPv6   String   域名对应的IPv6（如存在多个，可用英文逗号","分隔，例如："2001:DA8:1000::F1,2001:DA8:1000::F2"）   N

  timestamp    String   13位毫秒级时间戳（1970年1月1日作为起始时间计算，例如："2020/01/01                                Y
                        1:00:00.000"对应时间戳为"1577811600000"）                                                        
  ---------------------------------------------------------------------------------------------------------------------------------

## 教育加速插件获取配置轮询间隔请求 {#教育加速插件获取配置轮询间隔请求 .QB标题4}

## 接口描述 {#接口描述-34 .QB标题5}

接口内容：教育插件会每隔一段时间从平台拉取最新的配置，以便能够实时更新最新的配置。该接口为拉取的时间间隔。

请求url：https://aifast.komect.com/portal/acc/dc/eduAcc/time/getPeriod/{mac}/{period}

请求头：Content-Type: application/x-www-form-urlencoded

> Accept-Charset: utf-8

请求类型：HTTP、POST

## 请求 {#请求-81 .QB标题5}

表7.5-33组网终端家宽优选业务教育加速插件获取配置轮询间隔请求参数表

  ---------- -------- -------------------------------------------------------- -------------
  参数名称   类型     描述                                                     是否必填

  mac        String   设备mac，参数拼接在path中                                Y

  period     String   当前轮询时间间隔，单位为分钟，大于10，参数拼接在path中   Y
  ---------- -------- -------------------------------------------------------- -------------

示例：

\"https://aifast.komect.com/portal/acc/dc/eduAcc/time/getPeriod/AABBCCDDEEFF/10\"

## 响应 {#响应-81 .QB标题5}

表7.5-34组网终端家宽优选业务教育加速插件获取配置轮询间隔响应参数表

  ---------- -------- ---------------------------------------------- -------------
  参数名称   类型     描述                                           是否必填

  period     String   轮询间隔时间，直接返回间隔的数值，单位为分钟   Y
  ---------- -------- ---------------------------------------------- -------------

示例："20"

说明：直接响应String，20为调整轮询间隔为20分钟

## 教育加速更新国内流量卸载IP库请求 {#教育加速更新国内流量卸载ip库请求 .QB标题4}

## 接口描述 {#接口描述-35 .QB标题5}

接口内容：教育插件在加速流量之前，通过该IP库，先将国内的流量排除，禁止目的ip为国内的流量进入加速通道，以减少加速pop点的流量压力，避免出口带宽被浪费。

请求url：https://aifast.komect.com/portal/acc/dc/eduAcc/ip/china_ip.txt

请求头：Content-Type: application/x-www-form-urlencoded

> Accept-Charset: utf-8

请求类型：HTTP、POST

## 请求 {#请求-82 .QB标题5}

表7.5-35 组网终端家宽优选业务更新国内流量卸载IP库请求参数表

  ---------- ----------- ---------------------------- ----------------------
  参数名称   类型        描述                         是否必填

  无         String      此接口不需要填充参数         N
  ---------- ----------- ---------------------------- ----------------------

示例：https://aifast.komect.com/portal/acc/dc/eduAcc/ip/china_ip.txt

## 响应 {#响应-82 .QB标题5}

表7.5-36组网终端家宽优选业务更新国内流量卸载IP库响应参数表

  -------------- -------- ------------------------------ ----------------------
  参数名称       类型     描述                           是否必填

  china_ip.txt   String   返回最新的国内IP地址库字符串   Y
  -------------- -------- ------------------------------ ----------------------

示例：为最新的国内IP地址库

## 教育加速获取平台侧设备加速状态信息请求 {#教育加速获取平台侧设备加速状态信息请求 .QB标题4}

## 接口描述 {#接口描述-36 .QB标题5}

接口内容：获取当前设备的加速状态，是否开启了教育加速，只有打开小程序的时候才会调用此接口。

请求url：https://aifast.komect.com/portal/acc/dc/eduAcc/status/getStatus/{mac}

请求头：Content-Type: application/x-www-form-urlencoded

> Accept-Charset: utf-8

请求类型：HTTP、POST

## 请求 {#请求-83 .QB标题5}

表7.5-37 组网终端家宽优选业务获取平台侧设备加速状态信息请求参数表

  ---------------- -------- --------------------------- ----------------------
  参数名称         类型     说明                        是否必填

  mac              String   设备mac，参数拼接在path中   Y
  ---------------- -------- --------------------------- ----------------------

示例：\"https://aifast.komect.com/portal/acc/dc/eduAcc/status/getStatus/AABBCCDDEEFF\"

## 响应 {#响应-83 .QB标题5}

表7.5-38组网终端家宽优选业务获取平台侧设备加速状态信息响应参数表

  -------------- -------- ------------------------------------------------- -------------
  参数名称       类型     说明                                              是否必填

  mac_address    String   组网终端mac地址                                   Y

  netInfo        String   加速网络信息                                      Y

  accType        String   加速网络类型，0为l2tp,1为socks5。目前仅为socks5   Y

  do             String   加速动作。"stop"为停止，"acc"为启动加速           Y
  -------------- -------- ------------------------------------------------- -------------

示例：

\"mac_address\":\"AA:BB:CC:DD:EE:FF\",  \"netInfo\":\"aDi4awx2w4nU+yZSU2BfYCozKc8hyNa01FYeKYT+010u=\",  \"accType\":\"1\",  \"do\":\"stop\",//加速为acc,停止为stop

## 教育加速获取教育加速默认配置default.conf请求 {#教育加速获取教育加速默认配置default.conf请求 .QB标题4}

## 接口描述 {#接口描述-37 .QB标题5}

接口内容：在订购教育加速之后，获取默认加速的教育网站域名列表，该列表中的网站默认会进入加速通道进行加速。该配置会定期更新，以便教育插件能够及时对教育网站进行加速。

请求url：https://aifast.komect.com/protal/acc/dc/eduAcc/domain/https/{mac}/{version}

请求头：Content-Type: application/x-www-form-urlencoded

> Accept-Charset: utf-8

请求类型：HTTP、POST

## 请求 {#请求-84 .QB标题5}

表7.5-39 组网终端家宽优选业务获取教育加速默认配置default.conf请求参数表

  ---------------- -------- ------------------------- ----------------------
  参数名称         类型     描述                      是否必填

  mac              String   组网终端的mac地址         Y

  version          String   插件当前配置版本号        Y
  ---------------- -------- ------------------------- ----------------------

示例：https://aifast.komect.com/portal/acc/dc/eduAcc/domain/https/AABBCCDDEEFF/0000

## 响应 {#响应-84 .QB标题5}

表7.5-40 组网终端家宽优选业务获取教育加速默认配置default.conf响应参数表

  -------------- -------- --------------------------- ----------------------
  参数名称       类型     描述                        是否必填

  default.conf   String   文本形式返回配置文件        Y
  -------------- -------- --------------------------- ----------------------

示例：

#123456 //版本号，平台生成规则为最近一次内容修改的时间戳

ipset=/www.baidu.com/edu_list

server=/cloudfront.net/8.8.8.8 //指定dns配置格式

address=/facebook.com/192.168.1.1 //快速失败配置格式

## 教育加速获取教育加速自定义配置self.conf {#教育加速获取教育加速自定义配置self.conf .QB标题4}

## 接口描述 {#接口描述-38 .QB标题5}

接口内容：在订购教育加速之后，除了默认的域名列表，用户也可以根据自身需求，添加想要加速的网站，该配置即为获取用户自行添加的域名列表。

请求url：https://aifast.komect.com/protal/acc/dc/eduAcc/domain/getCustom/https/{mac}/{version}

请求头：Content-Type: application/x-www-form-urlencoded

> Accept-Charset: utf-8

请求类型：HTTP、POST

## 请求 {#请求-85 .QB标题5}

表7. 5-41 组网终端家宽优选业务获取教育加速自定义配置self.conf请求参数表

  ---------------- -------- ------------------------ -----------------------
  参数名称         类型     描述                     是否必填

  mac              String   设备Mac                  Y

  version          String   设备本地配置文件版本号   Y
  ---------------- -------- ------------------------ -----------------------

示例：

\"https://aifast.komect.com/portal/acc/dc/eduAcc/domain/getCustom/https/AABBCCDDEEFF/0000\"

## 响应 {#响应-85 .QB标题5}

表7.5-42 组网终端家宽优选业务获取教育加速自定义配置self.conf响应参数表

  -------------- -------- ------------------------- -----------------------
  参数名称       类型     描述                      是否必填

  self.conf      String   文本形式返回配置文件      Y
  -------------- -------- ------------------------- -----------------------

示例：

#123456 //版本号，平台生成规则为最近一次内容修改的时间戳

ipset=/www.baidu.com/edu_list

## 教育加速开启教育加速请求 {#教育加速开启教育加速请求 .QB标题4}

## 接口描述 {#接口描述-39 .QB标题5}

接口内容：在小程序上开启教育加速时，会触发该接口，用于在设备上开启教育加速。

请求url：ssl:aifastlink.komect.com:1883

请求头：Content-Type: application/x-www-form-urlencoded

> Accept-Charset: utf-8

请求类型：mqtt

## 请求 {#请求-86 .QB标题5}

表7.5-43 组网终端家宽优选业务开启教育加速请求参数表

  ---------------- -------- ----------------------------------------- ---------------
  参数名称         String   描述                                      是否必填

  node             String   可忽略                                    N

  mac_address      String   被加速设备Mac，可忽略                     N

  ip               String   被加速设备ip，可忽略                      N

  action           String   填充为control                             Y

  do               String   加速动作。"stop"为停止，"acc"为启动加速   Y

  accType          String   指令类型标记位，0为L2TP，1为SOCKS5        Y

  netInfo          String   加速网络加密信息，平台透传                Y

  reqid            Int      请求id，用于关联响应                      Y
  ---------------- -------- ----------------------------------------- ---------------

示例：

{\"node\":\"HongKong\",\"mac_address\":\"7C7635C4B332\",\"ip\":\"10.10.1.156\",\"action\":\"control\",\"do\":\"acc\",\"accType\":\"1\",\"netInfo\":\"AAAKASHDANSSNFIASUHF\",\"reqid\":\"100657885\"}

## 响应 {#响应-86 .QB标题5}

表7.5-44 组网终端家宽优选业务开启教育加速响应参数表

  -------------- -------- --------------------------------------------- -------------
  参数名称       类型     描述                                          是否必填

  action         String   填充control                                   Y

  do             String   加速动作，"acc"为正在加速，"stop"为停止加速   Y

  ret_code       String   成功0失败-1                                   Y

  reqid          Int      请求里面的reqid                               Y

  ret_msg        String   成功success失败fail                           Y

  result         String   成功success失败fail                           Y

  accType        String   标记位，0为L2TP，1为SOCKS5                    Y
  -------------- -------- --------------------------------------------- -------------

示例

{\"action\":\"control\",\"do\":\"acc\",\"ret_code\":0,\"reqid\":100657885,\"ret_msg\":\"success\",\"result\":\"success\",\"accType\":\"1\"}

## 教育加速停止教育加速请求 {#教育加速停止教育加速请求 .QB标题4}

## 接口描述 {#接口描述-40 .QB标题5}

接口内容：在小程序上停止教育加速时，会触发该接口，用于在设备上关闭教育加速。

请求url：ssl:aifastlink.komect.com:1883

请求头：Content-Type: application/x-www-form-urlencoded

> Accept-Charset: utf-8

请求类型：mqtt

## 请求 {#请求-87 .QB标题5}

停止教育加速插件

接口内容：在小程序上停止教育加速时，会触发该接口，用于在设备上关闭教育加速。

表7.5-45 组网终端家宽优选业务停止教育加速请求参数表

  ------------- -------- ----------------------------------------- ------------------
  参数名称      类型     描述                                      是否必填

  node          String   可忽略                                    N

  mac_address   String   被加速设备Mac，可忽略                     N

  ip            String   被加速设备ip，可忽略                      N

  do            String   加速动作。"stop"为停止，"acc"为启动加速   Y

  userid        String   平台定义的数字串                          Y

  accStatus     String   固定为control                             Y

  accType       String   指令类型标记位，0为L2TP，1为SOCKS5        Y

  netInfo       String   加速网络加密信息，平台透传                Y

  reqid         Int      请求id，用于关联响应                      Y
  ------------- -------- ----------------------------------------- ------------------

> 示例：

{\"node\":\"HongKong\",\"mac_address\":\"60F81D2163E5\",\"ip\":\"10.10.1.133\",\"action\":\"control\",\"userid\":\"984639336387448832\",\"do\":\"stop\",\"netInfo\":\"AAAKASHDANSKNUFAKSNFIASUHF\",\"reqid\":\"100657885\"}

## 响应 {#响应-87 .QB标题5}

表7.5-46 组网终端家宽优选业务停止教育加速响应参数表

  ----------- -------- --------------------------------------------- ------------------
  参数名称    类型     描述                                          是否必填

  action      String   填充control                                   Y

  do          String   加速动作，"acc"为正在加速，"stop"为停止加速   Y

  ret_code    String   成功0失败-1                                   Y

  reqid       Int      请求里面的reqid                               Y

  ret_msg     String   成功success失败fail                           Y

  result      String   成功success失败fail                           Y

  accType     String   指令类型标记位，0为L2TP，1为SOCKS5            Y
  ----------- -------- --------------------------------------------- ------------------

示例：

{\"action\":\"control\",\"do\":\"stop\",\"ret_code\":0,\"reqid\":239220067,\"ret_msg\":\"success\",\"result\":\"success\",\"accType\":\"1\"}

## 教育加速插件从平台拉取加速状态请求 {#教育加速插件从平台拉取加速状态请求 .QB标题4}

## 接口描述 {#接口描述-41 .QB标题5}

接口内容：教育插件在初始化的时候，会去平台同步拉取之前教育插件的状态（开启/关闭），并将当前状态设置为与平台的状态一致。

请求url：https://aifast.komect.com/protal/acc/dc/eduAcc/status/getStatus/{mac}

请求头：Content-Type: application/x-www-form-urlencoded

> Accept-Charset: utf-8

请求类型：HTTP、POST

## 请求 {#请求-88 .QB标题5}

表7.5-47组网终端家宽优选业务教育加速插件从平台拉取加速状态请求参数表

  -------------- --------- --------------------------- ----------------------
  参数名称       类型      描述                        是否必填

  mac            String    设备mac，参数拼接在path中   Y
  -------------- --------- --------------------------- ----------------------

示例：\"https://aifast.komect.com/portal/acc/dc/eduAcc/status/getStatus/000102030405\"

## 响应 {#响应-88 .QB标题5}

表7.5-48 组网终端家宽优选业务教育加速插件从平台拉取加速状态响应参数表

  ------------- -------- ----------------------------------------- ---------------
  参数名称      String   描述                                      是否必填

  node          String   可忽略                                    N

  mac_address   String   被加速设备Mac，可忽略                     N

  ip            String   被加速设备ip，可忽略                      N

  action        String   填充为control                             Y

  do            String   加速动作。"stop"为停止，"acc"为启动加速   Y

  accType       String   指令类型标记位，0为L2TP，1为SOCKS5        Y

  netInfo       String   加速网络加密信息，平台透传                Y

  reqid         Int      请求id，用于关联响应                      Y
  ------------- -------- ----------------------------------------- ---------------

示例：

{\"node\":\"HongKong\",\"mac_address\":\"000102030405\",\"ip\":\"192.168.1.3\",\"netInfo\":\"\",\"action\":\"control\",\"do\":\"stop\",\"accType\":\"1\",\"reqid\":\"882932713\"}

# 编制历史 {#编制历史 .QB标题1}

+--------+----------+-------------------+-------+----------+----------+
| 版本号 | 更新时间 | 主                | 编    | 技       | 部       |
|        |          | 要内容或重大修改  | 制人  | 术审核人 | 门审核人 |
+--------+----------+-------------------+-------+----------+----------+
| 1.0.0  | 20       | 规定了家庭网关    | 胡    | 王磊     | 李晗     |
|        | 17-06-09 | 家庭组网终端管理  | 新天  |          |          |
|        |          | 接口的接口流程、  |       |          |          |
|        |          | 接口协议和接口定  |       |          |          |
|        |          | 义等方面的内容。  |       |          |          |
+--------+----------+-------------------+-------+----------+----------+
| 2.0.0  | 20       | 增加家庭组        | 胡    | 张德朝   | 李晗     |
|        | 18-06-24 | 网终端配网流程，  | 新天  |          |          |
|        |          | 增加家庭组网终端  |       |          |          |
|        |          | 与省级数字家庭管  |       |          |          |
|        |          | 理平台接口协议、  |       |          |          |
|        |          | 流程和功能要求。  |       |          |          |
+--------+----------+-------------------+-------+----------+----------+
| 4.0.0  | 20       | 增加              | 田    |          |          |
|        | 20-04-05 | IF5/IF8接口要求， | 明昊  |          |          |
|        |          | 调整IF3接口功能； |       |          |          |
+--------+----------+-------------------+-------+----------+----------+
| 4.1.0  | 20       | 增加全光组        | 赵    | 位恒曦   |          |
|        | 21-04-27 | 网终端接口要求；  | 航斌  |          |          |
+--------+----------+-------------------+-------+----------+----------+
| 4.2.1  | 20       | 优化IF8           | 赵    | 位恒曦   |          |
|        | 22-04-20 | 接口架构，增加IF5 | 航斌  |          |          |
|        |          | /IF6相关接口功能; |       |          |          |
|        |          |                   |       |          |          |
|        |          | 新增家宽优选功能  |       |          |          |
+--------+----------+-------------------+-------+----------+----------+

# 附录A 参考文献 {#附录a-参考文献 .QB标题1 .unnumbered}

无

# 附录B（标准性附录） 响应码表 {#附录b标准性附录-响应码表 .QB标题1 .unnumbered}

表B-1 IF3接口响应码表

  ------------------ ----------------------------- ----------------------
  响应码             描述                          描述

  1                  Success                       命令已成功处理

  0                  Received Success              命令已正确接收

  1000               Authorization failed          注册或鉴权失败

  1001               Invalid argument              存在不支持的输入参数

  1002               Lack of argument              缺少某输入参数

  1003               Invalid value                 输入参数的值不合法

  1004               Invalid command               该操作不被允许

  9999               Unknow Error                  未知异常
  ------------------ ----------------------------- ----------------------

表B-2 IF6接口响应码表

  ------------------------- ---------------------------------------------
  返回值                    解释

  1                         新DevRND接收成功

  2                         设备身份验证成功

  0                         一般成功

  -1                        一般失败

  -2                        设备身份验证失败

  -3                        设备需重新向平台注册

  -5                        设备重新连接其它服务器，用于服务器负载均衡
  ------------------------- ---------------------------------------------

# 附录C（标准性附录） 消息上报接口应支持事件 {#附录c标准性附录-消息上报接口应支持事件 .QB标题1 .unnumbered}

1)  FILE

适用于IF6，该事件来自于组网终端，在终端进行文件操作后触发(通常是固件升级)，至少上报文件传输完成、版本升级完成。

数据区格式：

data: {

\"respCode\": X，

\"restCont\":\"XXXXX\"

}

表C-1 文件传输消息响应码表

  --------------------------------------------------------------------------
  响应码         描述                            描述
  -------------- ------------------------------- ---------------------------
  2000           File Transfer Complete          文件传输完成

  2001           File Upgrade Success            版本升级完成

  2002           0-100中的数字，表示传输百分比   文件传输中

  2003           File Transfer interrupt         文件传输中断
  --------------------------------------------------------------------------

表C-2 IF5接口响应码表

+--------------+-------------------+----------------------------------+
| **响应码     | *                 | **说明**                         |
| (RespCode)** | *描述(RespCont)** |                                  |
+--------------+-------------------+----------------------------------+
| 0            | Success           | 成功/命令已正确接收              |
+--------------+-------------------+----------------------------------+
| 1            | Success           | 命令已成功处理                   |
+--------------+-------------------+----------------------------------+
| 1000         | Authorization     | 注册或鉴权失败                   |
|              | failed            |                                  |
+--------------+-------------------+----------------------------------+
| 1001         | Invalid argument  | 存在不支持的输入参数             |
+--------------+-------------------+----------------------------------+
| 1002         | Lack of argument  | 缺少某输入参数                   |
+--------------+-------------------+----------------------------------+
| 1003         | Invalid value     | 输入参数的值不合法               |
+--------------+-------------------+----------------------------------+
| 1004         | Invalid command   | 该操作不被允许                   |
+--------------+-------------------+----------------------------------+
| 1005         | Command failed    | 配置操作失败                     |
+--------------+-------------------+----------------------------------+
| 1006         | Device removal    | 设备已下架                       |
+--------------+-------------------+----------------------------------+
| 1007         | Device not        | 设备未注册                       |
|              | register          |                                  |
+--------------+-------------------+----------------------------------+
| 1008         | Device not found  | 数据库无此设备                   |
+--------------+-------------------+----------------------------------+
| 2000         | 1/100             | \[1,100\] 升级进度信息           |
|              |                   |                                  |
|              |                   | 1版本下载完成,开始升级           |
|              |                   |                                  |
|              |                   | 100,升级完成                     |
+--------------+-------------------+----------------------------------+
| 2002         | 1/100             | \[1,100\] 下载进度信息：         |
|              |                   |                                  |
|              |                   | 1:开始下载;100完成下载           |
+--------------+-------------------+----------------------------------+
| 2003         | File Transfer     | \[0,1,2,X\] 过程异常信息：       |
|              | interrupt         |                                  |
|              |                   | 0:URL非法或设备忙;1升级          |
|              |                   | 中断;2版本下载完成,校验异常取消  |
|              |                   | 升级,X其他异常信息(可为具体描述) |
+--------------+-------------------+----------------------------------+
| 9999         | Unknow Error      | 未知错误                         |
+--------------+-------------------+----------------------------------+
| 3001         | No User           | 无用户关系                       |
+--------------+-------------------+----------------------------------+
| 4002         | Device bound      | 设备已绑定                       |
+--------------+-------------------+----------------------------------+
| 5000         | Parameter Error   | 设备信息不匹配                   |
+--------------+-------------------+----------------------------------+
| 5001         | No Data           | 数据未报备                       |
+--------------+-------------------+----------------------------------+

# 附录D 家宽优选响应码表 {#附录d-家宽优选响应码表 .QB标题1 .unnumbered}

表D-1 家宽优选响应码表

  ------------------------- ---------------------------------------------
  返回值                    解释

  100                       成功

  211                       参数错误

  500                       系统错误

  200                       无需处理（如无需更新配置）
  ------------------------- ---------------------------------------------
